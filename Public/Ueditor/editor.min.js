UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor={};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE.version="1.2.4.0";var dom=UE.dom={};var browser=UE.browser=function(){var d=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:!!window.ActiveXObject,opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera);var a=0;if(c.ie){a=parseFloat(d.match(/msie (\d+)/)[1]);c.ie9Compat=document.documentMode==9;c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=((a==7&&!document.documentMode)||document.documentMode==7);c.ie6Compat=(a<7||c.quirks)}if(c.gecko){var e=d.match(/rv:([\d\.]+)/);if(e){e=e[1].split(".");a=e[0]*10000+(e[1]||0)*100+(e[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(d)){c.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(d)&&!/chrome/i.test(d)){c.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(c.opera){a=parseFloat(b.version())}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;c.isCompatible=!c.mobile&&((c.ie&&a>=6)||(c.gecko&&a>=10801)||(c.opera&&a>=9.5)||(c.air&&a>=1)||(c.webkit&&a>=522)||false);return c}();var ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;var utils=UE.utils={each:function(f,e,d){if(f==null){return}if(Array.prototype.forEach&&f.forEach===Array.prototype.forEach){f.forEach(e,d)}else{if(f.length===+f.length){for(var c=0,a=f.length;c<a;c++){if(e.call(d,f[c],c,f)===false){return}}}else{for(var b in f){if(f.hasOwnProperty(b)){if(e.call(d,f[b],b,f)===false){return}}}}}},makeInstance:function(b){var a=new Function();a.prototype=b;b=new a;a.prototype=null;return b},extend:function(d,e,a){if(e){for(var c in e){if(!a||!d.hasOwnProperty(c)){d[c]=e[c]}}}return d},inherits:function(d,b){var a=d.prototype,c=utils.makeInstance(b.prototype);utils.extend(c,a,true);d.prototype=c;return(c.constructor=d)},bind:function(b,a){return function(){return b.apply(a,arguments)}},defer:function(b,a,c){var d;return function(){if(c){clearTimeout(d)}d=setTimeout(b,a)}},indexOf:function(d,b,c){var a=-1;c=this.isNumber(c)?c:0;this.each(d,function(e,f){if(f>=c&&e===b){a=f;return false}});return a},removeItem:function(d,c){for(var b=0,a=d.length;b<a;b++){if(d[b]===c){d.splice(b,1);b--}}},trim:function(a){return a.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(c){if(!c){return{}}c=utils.isArray(c)?c:c.split(",");for(var b=0,a,d={};a=c[b++];){d[a.toUpperCase()]=d[a]=1}return d},unhtml:function(b,a){return b?b.replace(a||/[&<">]/g,function(c){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;"}[c]}):""},html:function(a){return a?a.replace(/&((g|l|quo)t|amp);/g,function(b){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">"}[b]}):""},cssStyleToDomStyle:function(){var b=document.createElement("div").style,a={"float":b.cssFloat!=undefined?"cssFloat":b.styleFloat!=undefined?"styleFloat":"float"};return function(c){return a[c]||(a[c]=c.toLowerCase().replace(/-./g,function(d){return d.charAt(1).toUpperCase()}))}}(),loadFile:function(){var a=[];function b(h,g){for(var d=0,c;c=a[d++];){try{if(c.doc===h&&c.url==(g.src||g.href)){return c}}catch(f){continue}}}return function(i,h,e){var f=b(i,h);if(f){if(f.ready){e&&e()}else{f.funs.push(e)}return}a.push({doc:i,url:h.src||h.href,funs:[e]});if(!i.body){var d=[];for(var g in h){if(g=="tag"){continue}d.push(g+'="'+h[g]+'"')}i.write("<"+h.tag+" "+d.join(" ")+" ></"+h.tag+">");return}if(h.id&&i.getElementById(h.id)){return}var c=i.createElement(h.tag);delete h.tag;for(var g in h){c.setAttribute(g,h[g])}c.onload=c.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){f=b(i,h);if(f.funs.length>0){f.ready=1;for(var j;j=f.funs.pop();){j()}}c.onload=c.onreadystatechange=null}};i.getElementsByTagName("head")[0].appendChild(c)}}(),isEmptyObject:function(b){if(b==null){return true}if(this.isArray(b)||this.isString(b)){return b.length===0}for(var a in b){if(b.hasOwnProperty(a)){return false}}return true},fixColor:function(b,d){if(/color/i.test(b)&&/rgba?/.test(d)){var e=d.split(",");if(e.length>3){return""}d="#";for(var c=0,a;a=e[c++];){a=parseInt(a.replace(/[^\d]/gi,""),10).toString(16);d+=a.length==1?"0"+a:a}d=d.toUpperCase()}return d},optCss:function(e){var d,c,a;e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(i,g,f,h){if(h.split(" ").length==1){switch(g){case"padding":!d&&(d={});d[f]=h;return"";case"margin":!c&&(c={});c[f]=h;return"";case"border":return h=="initial"?"":i}}return i});function b(m,h){if(!m){return""}var i=m.top,f=m.bottom,g=m.left,j=m.right,n="";if(!i||!g||!f||!j){for(var k in m){n+=";"+h+"-"+k+":"+m[k]+";"}}else{n+=";"+h+":"+(i==f&&f==g&&g==j?i:i==f&&g==j?(i+" "+g):g==j?(i+" "+g+" "+f):(i+" "+j+" "+f+" "+g))+";"}return n}e+=b(d,"padding")+b(c,"margin");return e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(g,f){return f?f+";;":";"})},clone:function(c,d){var b;d=d||{};for(var a in c){if(c.hasOwnProperty(a)){b=c[a];if(typeof b=="object"){d[a]=utils.isArray(b)?[]:{};utils.clone(c[a],d[a])}else{d[a]=b}}}return d},transUnitToPx:function(b){if(!/(pt|cm)/.test(b)){return b}var a;b.replace(/([\d.]+)(\w+)/,function(e,c,d){b=c;a=d});switch(a){case"cm":b=parseFloat(b)*25;break;case"pt":b=Math.round(parseFloat(b)*96/72)}return b+(b?"px":"")},domReady:function(){var a=[];function b(d){d.isReady=true;for(var c;c=a.pop();c()){}}return function(c,e){e=e||window;var d=e.document;c&&a.push(c);if(d.readyState==="complete"){b(d)}else{d.isReady&&b(d);if(browser.ie){(function(){if(d.isReady){return}try{d.documentElement.doScroll("left")}catch(f){setTimeout(arguments.callee,0);return}b(d)})();e.attachEvent("onload",function(){b(d)})}else{d.addEventListener("DOMContentLoaded",function(){d.removeEventListener("DOMContentLoaded",arguments.callee,false);b(d)},false);e.addEventListener("load",function(){b(d)},false)}}}}(),cssRule:browser.ie?function(d,e,f){var a,c;f=f||document;if(f.indexList){a=f.indexList}else{a=f.indexList={}}var b;if(!a[d]){if(e===undefined){return""}b=f.createStyleSheet("",c=f.styleSheets.length);a[d]=c}else{b=f.styleSheets[a[d]]}if(e===undefined){return b.cssText}b.cssText=e||""}:function(b,c,e){e=e||document;var a=e.getElementsByTagName("head")[0],d;if(!(d=e.getElementById(b))){if(c===undefined){return""}d=e.createElement("style");d.id=b;a.appendChild(d)}if(c===undefined){return d.innerHTML}if(c!==""){d.innerHTML=c}else{a.removeChild(d)}}};utils.each(["String","Function","Array","Number"],function(a){UE.utils["is"+a]=function(b){return Object.prototype.toString.apply(b)=="[object "+a+"]"}});var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(b,d){b=utils.trim(b).split(" ");for(var a=0,c;c=b[a++];){getListener(this,c,true).push(d)}},removeListener:function(b,d){b=utils.trim(b).split(" ");for(var a=0,c;c=b[a++];){utils.removeItem(getListener(this,c)||[],d)}},fireEvent:function(d){d=utils.trim(d).split(" ");for(var c=0,f;f=d[c++];){var e=getListener(this,f),g,b,a;if(e){a=e.length;while(a--){b=e[a].apply(this,arguments);if(b!==undefined){g=b}}}if(b=this["on"+f.toLowerCase()]){g=b.apply(this,arguments)}}return g}};function getListener(d,b,c){var a;b=b.toLowerCase();return((a=(d.__allListeners||c&&(d.__allListeners={})))&&(a[b]||c&&(a[b]=[])))}var dtd=dom.dtd=(function(){function W(B){for(var A in B){B[A.toUpperCase()]=B[A]}return B}function a(E){var B=arguments;for(var D=1;D<B.length;D++){var A=B[D];for(var C in A){if(!E.hasOwnProperty(C)){E[C]=A[C]}}}return E}var z=W({isindex:1,fieldset:1}),y=W({input:1,button:1,select:1,textarea:1,label:1}),x=a(W({a:1}),y),w=a({iframe:1},x),v=W({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),u=W({ins:1,del:1,script:1,style:1}),t=a(W({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),u),s=a(W({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),t),r=a(W({p:1}),s),q=a(W({iframe:1}),s,y),n=W({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=a(W({a:0}),q),k=W({tr:1}),j=W({"#":1}),i=a(W({param:1}),n),h=a(W({form:1}),z,w,v,r),g=W({li:1}),f=W({style:1,script:1}),e=W({base:1,link:1,meta:1,title:1}),d=a(e,f),c=W({head:1,body:1}),b=W({html:1});var l=W({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),o=W({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return W({$nonBodyContent:a(b,c,e),$block:l,$inline:m,$body:a(W({script:1,style:1}),l),$cdata:W({script:1,style:1}),$empty:o,$nonChild:W({iframe:1,textarea:1}),$listItem:W({dd:1,dt:1,li:1}),$list:W({ul:1,ol:1,dl:1}),$isNotEmpty:W({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$removeEmpty:W({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:W({p:1,div:1}),$tableContent:W({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:W({pre:1,script:1,style:1,textarea:1}),html:c,head:d,style:j,script:j,body:h,base:{},link:{},meta:{},title:j,col:{},tr:W({td:1,th:1}),img:{},embed:{},colgroup:W({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:h,td:h,br:{},th:h,center:h,kbd:m,button:a(r,v),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:g,h1:m,h3:m,option:j,h2:m,form:a(z,w,v,r),select:W({optgroup:1,option:1}),font:m,ins:m,menu:g,abbr:m,label:m,table:W({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:k,cite:m,li:h,input:{},iframe:h,strong:m,textarea:j,noframes:h,big:m,small:m,span:W({"#":1,br:1}),hr:m,dt:m,sub:m,optgroup:W({option:1}),param:{},bdo:m,"var":m,div:h,object:i,sup:m,dd:h,strike:m,area:{},dir:g,map:a(W({area:1,form:1,p:1}),z,u,v),applet:i,dl:W({dt:1,dd:1}),del:m,isindex:{},fieldset:a(W({legend:1}),n),thead:k,ul:g,acronym:m,b:m,a:a(W({a:1}),q),blockquote:a(W({td:1,tr:1,tbody:1,li:1}),h),caption:m,i:m,u:m,tbody:k,s:m,address:a(w,r),tt:m,legend:m,q:m,pre:a(t,x),p:a(W({a:1}),m),em:m,dfn:m})})();function getDomNode(g,h,b,a,e,f){var d=a&&g[h],c;!d&&(d=g[b]);while(!d&&(c=(c||g).parentNode)){if(c.tagName=="BODY"||f&&!f(c)){return null}d=c[b]}if(d&&e&&!e(d)){return getDomNode(d,h,b,false,e)}return d}var attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);var domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(f,d){if(f===d){return 0}var b,e=[f],c=[d];b=f;while(b=b.parentNode){if(b===d){return 10}e.push(b)}b=d;while(b=b.parentNode){if(b===f){return 20}c.push(b)}e.reverse();c.reverse();if(e[0]!==c[0]){return 1}var a=-1;while(a++,e[a]===c[a]){}f=e[a];d=c[a];while(f=f.nextSibling){if(f===d){return 4}}return 2},getNodeIndex:function(c,b){var d=c,a=0;while(d=d.previousSibling){if(b&&d.nodeType==3){continue}a++}return a},inDoc:function(a,b){return domUtils.getPosition(a,b)==10},findParent:function(b,c,a){if(b&&!domUtils.isBody(b)){b=a?b:b.parentNode;while(b){if(!c||c(b)||domUtils.isBody(b)){return c&&!c(b)&&domUtils.isBody(b)?null:b}b=b.parentNode}}return null},findParentByTagName:function(c,a,b,d){a=utils.listToMap(utils.isArray(a)?a:[a]);return domUtils.findParent(c,function(e){return a[e.tagName]&&!(d&&d(e))},b)},findParents:function(d,c,e,b){var a=c&&(e&&e(d)||!e)?[d]:[];while(d=domUtils.findParent(d,e)){a.push(d)}return b?a:a.reverse()},insertAfter:function(b,a){return b.parentNode.insertBefore(a,b.nextSibling)},remove:function(b,c){var a=b.parentNode,d;if(a){if(c&&b.hasChildNodes()){while(d=b.firstChild){a.insertBefore(d,b)}}a.removeChild(b)}return b},getNextDomNode:function(c,a,d,b){return getDomNode(c,"firstChild","nextSibling",a,d,b)},isBookmarkNode:function(a){return a.nodeType==1&&a.id&&/^_baidu_bookmark_/i.test(a.id)},getWindow:function(a){var b=a.ownerDocument||a;return b.defaultView||b.parentWindow},getCommonAncestor:function(f,d){if(f===d){return f}var e=[f],c=[d],b=f,a=-1;while(b=b.parentNode){if(b===d){return b}e.push(b)}b=d;while(b=b.parentNode){if(b===f){return b}c.push(b)}e.reverse();c.reverse();while(a++,e[a]===c[a]){}return a==0?null:e[a-1]},clearEmptySibling:function(d,b,c){function a(g,e){var f;while(g&&!domUtils.isBookmarkNode(g)&&(domUtils.isEmptyInlineElement(g)||!new RegExp("[^\t\n\r"+domUtils.fillChar+"]").test(g.nodeValue))){f=g[e];domUtils.remove(g);g=f}}!b&&a(d.nextSibling,"nextSibling");!c&&a(d.previousSibling,"previousSibling")},split:function(d,f){var e=d.ownerDocument;if(browser.ie&&f==d.nodeValue.length){var c=e.createTextNode("");return domUtils.insertAfter(d,c)}var a=d.splitText(f);if(browser.ie8){var b=e.createTextNode("");domUtils.insertAfter(a,b);domUtils.remove(b)}return a},isWhitespace:function(a){return !new RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(a.nodeValue)},getXY:function(b){var a=0,c=0;while(b.offsetParent){c+=b.offsetTop;a+=b.offsetLeft;b=b.offsetParent}return{x:a,y:c}},on:function(e,g,f){var d=utils.isArray(g)?g:[g],a=d.length;if(a){while(a--){g=d[a];if(e.addEventListener){e.addEventListener(g,f,false)}else{if(!f._d){f._d={els:[]}}var c=g+f.toString(),b=utils.indexOf(f._d.els,e);if(!f._d[c]||b==-1){if(b==-1){f._d.els.push(e)}if(!f._d[c]){f._d[c]=function(h){return f.call(h.srcElement,h||window.event)}}e.attachEvent("on"+g,f._d[c])}}}}e=null},un:function(f,h,g){var d=utils.isArray(h)?h:[h],a=d.length;if(a){while(a--){h=d[a];if(f.removeEventListener){f.removeEventListener(h,g,false)}else{var c=h+g.toString();try{f.detachEvent("on"+h,g._d?g._d[c]:g)}catch(i){}if(g._d&&g._d[c]){var b=utils.indexOf(g._d.els,f);if(b!=-1){g._d.els.splice(b,1)}g._d.els.length==0&&delete g._d[c]}}}}},isSameElement:function(d,c){if(d.tagName!=c.tagName){return false}var e=d.attributes,g=c.attributes;if(!ie&&e.length!=g.length){return false}var a,j,h=0,b=0;for(var f=0;a=e[f++];){if(a.nodeName=="style"){if(a.specified){h++}if(domUtils.isSameStyle(d,c)){continue}else{return false}}if(ie){if(a.specified){h++;j=g.getNamedItem(a.nodeName)}else{continue}}else{j=c.attributes[a.nodeName]}if(!j.specified||a.nodeValue!=j.nodeValue){return false}}if(ie){for(f=0;j=g[f++];){if(j.specified){b++}}if(h!=b){return false}}return true},isSameStyle:function(g,e){var b=g.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),a=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){b=g.style;a=e.style;if(b.length!=a.length){return false}for(var f in b){if(/^(\d+|csstext)$/i.test(f)){continue}if(b[f]!=a[f]){return false}}return true}if(!b||!a){return b==a}b=b.split(";");a=a.split(";");if(b.length!=a.length){return false}for(var d=0,c;c=b[d++];){if(utils.indexOf(a,c)==-1){return false}}return true},isBlockElm:function(a){return a.nodeType==1&&(dtd.$block[a.tagName]||styleBlock[domUtils.getComputedStyle(a,"display")])&&!dtd.$nonChild[a.tagName]},isBody:function(a){return a&&a.nodeType==1&&a.tagName.toLowerCase()=="body"},breakParent:function(e,c){var b,g=e,f=e,a,d;do{g=g.parentNode;if(a){b=g.cloneNode(false);b.appendChild(a);a=b;b=g.cloneNode(false);b.appendChild(d);d=b}else{a=g.cloneNode(false);d=a.cloneNode(false)}while(b=f.previousSibling){a.insertBefore(b,a.firstChild)}while(b=f.nextSibling){d.appendChild(b)}f=g}while(c!==g);b=c.parentNode;b.insertBefore(a,c);b.insertBefore(d,c);b.insertBefore(e,d);domUtils.remove(c);return e},isEmptyInlineElement:function(a){if(a.nodeType!=1||!dtd.$removeEmpty[a.tagName]){return 0}a=a.firstChild;while(a){if(domUtils.isBookmarkNode(a)){return 0}if(a.nodeType==1&&!domUtils.isEmptyInlineElement(a)||a.nodeType==3&&!domUtils.isWhitespace(a)){return 0}a=a.nextSibling}return 1},trimWhiteTextNode:function(b){function a(c){var d;while((d=b[c])&&d.nodeType==3&&domUtils.isWhitespace(d)){b.removeChild(d)}}a("firstChild");a("lastChild")},mergeChild:function(c,b,g){var f=domUtils.getElementsByTagName(c,c.tagName.toLowerCase());for(var e=0,k;k=f[e++];){if(!k.parentNode||domUtils.isBookmarkNode(k)){continue}if(k.tagName.toLowerCase()=="span"){if(c===k.parentNode){domUtils.trimWhiteTextNode(c);if(c.childNodes.length==1){c.style.cssText=k.style.cssText+";"+c.style.cssText;domUtils.remove(k,true);continue}}k.style.cssText=c.style.cssText+";"+k.style.cssText;if(g){var a=g.style;if(a){a=a.split(";");for(var d=0,h;h=a[d++];){k.style[utils.cssStyleToDomStyle(h.split(":")[0])]=h.split(":")[1]}}}if(domUtils.isSameStyle(k,c)){domUtils.remove(k,true)}continue}if(domUtils.isSameElement(c,k)){domUtils.remove(k,true)}}},getElementsByTagName:function(e,b){var f=e.getElementsByTagName(b),a=[];for(var d=0,c;c=f[d++];){a.push(c)}return a},mergeToParent:function(b){var a=b.parentNode;while(a&&dtd.$removeEmpty[a.tagName]){if(a.tagName==b.tagName||a.tagName=="A"){domUtils.trimWhiteTextNode(a);if(a.tagName=="SPAN"&&!domUtils.isSameStyle(a,b)||(a.tagName=="A"&&b.tagName=="SPAN")){if(a.childNodes.length>1||a!==b.parentNode){b.style.cssText=a.style.cssText+";"+b.style.cssText;a=a.parentNode;continue}else{a.style.cssText+=";"+b.style.cssText;if(a.tagName=="A"){a.style.textDecoration="underline"}}}if(a.tagName!="A"){a===b.parentNode&&domUtils.remove(b,true);break}}a=a.parentNode}},mergeSibling:function(c,b,a){function d(g,h,f){var e;if((e=f[g])&&!domUtils.isBookmarkNode(e)&&e.nodeType==1&&domUtils.isSameElement(f,e)){while(e.firstChild){if(h=="firstChild"){f.insertBefore(e.lastChild,f.firstChild)}else{f.appendChild(e.firstChild)}}domUtils.remove(e)}}!b&&d("previousSibling","firstChild",c);!a&&d("nextSibling","lastChild",c)},unSelectable:ie||browser.opera?function(c){c.onselectstart=function(){return false};c.onclick=c.onkeyup=c.onkeydown=function(){return false};c.unselectable="on";c.setAttribute("unselectable","on");for(var b=0,a;a=c.all[b++];){switch(a.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:a.unselectable="on";c.setAttribute("unselectable","on")}}}:function(a){a.style.MozUserSelect=a.style.webkitUserSelect=a.style.KhtmlUserSelect="none"},removeAttributes:function(c,d){for(var b=0,a;a=d[b++];){a=attrFix[a]||a;switch(a){case"className":c[a]="";break;case"style":c.style.cssText="";!browser.ie&&c.removeAttributeNode(c.getAttributeNode("style"))}c.removeAttribute(a)}},createElement:function(c,a,b){return domUtils.setAttributes(c.createElement(a),b)},setAttributes:function(c,b){for(var a in b){if(b.hasOwnProperty(a)){var d=b[a];switch(a){case"class":c.className=d;break;case"style":c.style.cssText=c.style.cssText+";"+d;break;case"innerHTML":c[a]=d;break;case"value":c.value=d;break;default:c.setAttribute(attrFix[a]||a,d)}}}return c},getComputedStyle:function(c,b){var g="width height top left";if(g.indexOf(b)>-1){return c["offset"+b.replace(/^\w/,function(e){return e.toUpperCase()})]+"px"}if(c.nodeType==3){c=c.parentNode}if(browser.ie&&browser.version<9&&b=="font-size"&&!c.style.fontSize&&!dtd.$empty[c.tagName]&&!dtd.$nonChild[c.tagName]){var d=c.ownerDocument.createElement("span");d.style.cssText="padding:0;border:0;font-family:simsun;";d.innerHTML=".";c.appendChild(d);var a=d.offsetHeight;c.removeChild(d);d=null;return a+"px"}try{var f=domUtils.getStyle(c,b)||(window.getComputedStyle?domUtils.getWindow(c).getComputedStyle(c,"").getPropertyValue(b):(c.currentStyle||c.style)[utils.cssStyleToDomStyle(b)])}catch(h){return""}return utils.transUnitToPx(utils.fixColor(b,f))},removeClasses:function(e,d){d=utils.isArray(d)?d:utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=e.className;b=d[c++];){a=a.replace(new RegExp("\\b"+b+"\\b"),"")}a=utils.trim(a).replace(/[ ]{2,}/g," ");if(a){e.className=a}else{domUtils.removeAttributes(e,["class"])}},addClass:function(e,d){if(!e){return}d=utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=e.className;b=d[c++];){if(!new RegExp("\\b"+b+"\\b").test(a)){e.className+=" "+b}}},hasClass:function(d,e){e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=d.className;b=e[c++];){if(!new RegExp("\\b"+b+"\\b").test(a)){return false}}return c-1==e.length},preventDefault:function(a){a.preventDefault?a.preventDefault():(a.returnValue=false)},removeStyle:function(b,a){if(b.style.removeProperty){b.style.removeProperty(a)}else{b.style.removeAttribute(utils.cssStyleToDomStyle(a))}if(!b.style.cssText){domUtils.removeAttributes(b,["style"])}},getStyle:function(b,a){var c=b.style[utils.cssStyleToDomStyle(a)];return utils.fixColor(a,c)},setStyle:function(b,a,c){b.style[utils.cssStyleToDomStyle(a)]=c},setStyles:function(b,c){for(var a in c){if(c.hasOwnProperty(a)){domUtils.setStyle(b,a,c[a])}}},removeDirtyAttr:function(d){for(var c=0,b,a=d.getElementsByTagName("*");b=a[c++];){b.removeAttribute("_moz_dirty")}d.removeAttribute("_moz_dirty")},getChildCount:function(c,a){var b=0,d=c.firstChild;a=a||function(){return 1};while(d){if(a(d)){b++}d=d.nextSibling}return b},isEmptyNode:function(a){return !a.firstChild||domUtils.getChildCount(a,function(b){return !domUtils.isBr(b)&&!domUtils.isBookmarkNode(b)&&!domUtils.isWhitespace(b)})==0},clearSelectedArr:function(a){var b;while(b=a.pop()){domUtils.removeAttributes(b,["class"])}},scrollToView:function(c,i,a){var b=function(){var j=i.document,k=j.compatMode=="CSS1Compat";return{width:(k?j.documentElement.clientWidth:j.body.clientWidth)||0,height:(k?j.documentElement.clientHeight:j.body.clientHeight)||0}},h=function(k){if("pageXOffset" in k){return{x:k.pageXOffset||0,y:k.pageYOffset||0}}else{var j=k.document;return{x:j.documentElement.scrollLeft||j.body.scrollLeft||0,y:j.documentElement.scrollTop||j.body.scrollTop||0}}};var f=b().height,g=f*-1+a;g+=(c.offsetHeight||0);var d=domUtils.getXY(c);g+=d.y;var e=h(i).y;if(g>e||g<e-f){i.scrollTo(0,g+(g<0?-20:20))}},isBr:function(a){return a.nodeType==1&&a.tagName=="BR"},isFillChar:function(a){return a.nodeType==3&&!a.nodeValue.replace(new RegExp(domUtils.fillChar),"").length},isStartInblock:function(b){var f=b.cloneRange(),a=0,g=f.startContainer,c;while(g&&domUtils.isFillChar(g)){c=g;g=g.previousSibling}if(c){f.setStartBefore(c);g=f.startContainer}if(g.nodeType==1&&domUtils.isEmptyNode(g)&&f.startOffset==1){f.setStart(g,0).collapse(true)}while(!f.startOffset){g=f.startContainer;if(domUtils.isBlockElm(g)||domUtils.isBody(g)){a=1;break}var e=f.startContainer.previousSibling,d;if(!e){f.setStartBefore(f.startContainer)}else{while(e&&domUtils.isFillChar(e)){d=e;e=e.previousSibling}if(d){f.setStartBefore(d)}else{f.setStartBefore(f.startContainer)}}}return a&&!domUtils.isBody(f.startContainer)?1:0},isEmptyBlock:function(b){var a=new RegExp("[ \t\r\n"+domUtils.fillChar+"]","g");if(b[browser.ie?"innerText":"textContent"].replace(a,"").length>0){return 0}for(var c in dtd.$isNotEmpty){if(b.getElementsByTagName(c).length){return 0}}return 1},setViewportOffset:function(a,g){var f=parseInt(a.style.left)|0;var e=parseInt(a.style.top)|0;var c=a.getBoundingClientRect();var d=g.left-c.left;var b=g.top-c.top;if(d){a.style.left=f+d+"px"}if(b){a.style.top=e+b+"px"}},fillNode:function(c,b){var a=browser.ie?c.createTextNode(domUtils.fillChar):c.createElement("br");b.innerHTML="";b.appendChild(a)},moveChild:function(c,a,b){while(c.firstChild){if(b&&a.firstChild){a.insertBefore(c.lastChild,a.firstChild)}else{a.appendChild(c.firstChild)}}},hasNoAttributes:function(a){return browser.ie?/^<\w+\s*?>/.test(a.outerHTML):a.attributes.length==0},isCustomeNode:function(a){return a.nodeType==1&&a.getAttribute("_ue_custom_node_")},isTagNode:function(b,a){return b.nodeType==1&&new RegExp(b.tagName,"i").test(a)},filterNodeList:function(d,c,b){var a=[];if(!utils.isFunction(c)){var e=c;c=function(f){return utils.indexOf(utils.isArray(e)?e:e.split(" "),f.tagName.toLowerCase())!=-1}}utils.each(d,function(f){c(f)&&a.push(f)});return a.length==0?null:a.length==1||!b?a[0]:a},isInNodeEndBoundary:function(a,b){var c=a.startContainer;if(c.nodeType==3&&a.startOffset!=c.nodeValue.length){return 0}if(c.nodeType==1&&a.startOffset!=c.childNodes.length){return 0}while(c!==b){if(c.nextSibling){return 0}c=c.parentNode}return 1}};var fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){var f=0,g=domUtils.fillChar,c;function b(k){k.collapsed=k.startContainer&&k.endContainer&&k.startContainer===k.endContainer&&k.startOffset==k.endOffset}function j(k){return !k.collapsed&&k.startContainer.nodeType==1&&k.startContainer===k.endContainer&&k.endOffset-k.startOffset==1}function a(l,m,n,k){if(m.nodeType==1&&(dtd.$empty[m.tagName]||dtd.$nonChild[m.tagName])){n=domUtils.getNodeIndex(m)+(l?0:1);m=m.parentNode}if(l){k.startContainer=m;k.startOffset=n;if(!k.endContainer){k.collapse(true)}}else{k.endContainer=m;k.endOffset=n;if(!k.startContainer){k.collapse(false)}}b(k);return k}function i(r,v){var o=r.startContainer,n=r.endContainer,x=r.startOffset,q=r.endOffset,D=r.document,k=D.createDocumentFragment(),s,u;if(o.nodeType==1){o=o.childNodes[x]||(s=o.appendChild(D.createTextNode("")))}if(n.nodeType==1){n=n.childNodes[q]||(u=n.appendChild(D.createTextNode("")))}if(o===n&&o.nodeType==3){k.appendChild(D.createTextNode(o.substringData(x,q-x)));if(v){o.deleteData(x,q-x);r.collapse(true)}return k}var t,z,B=k,A=domUtils.findParents(o,true),l=domUtils.findParents(n,true);for(var y=0;A[y]==l[y];){y++}for(var w=y,C;C=A[w];w++){t=C.nextSibling;if(C==o){if(!s){if(r.startContainer.nodeType==3){B.appendChild(D.createTextNode(o.nodeValue.slice(x)));if(v){o.deleteData(x,o.nodeValue.length-x)}}else{B.appendChild(!v?o.cloneNode(true):o)}}}else{z=C.cloneNode(false);B.appendChild(z)}while(t){if(t===n||t===l[w]){break}C=t.nextSibling;B.appendChild(!v?t.cloneNode(true):t);t=C}B=z}B=k;if(!A[y]){B.appendChild(A[y-1].cloneNode(false));B=B.firstChild}for(var w=y,m;m=l[w];w++){t=m.previousSibling;if(m==n){if(!u&&r.endContainer.nodeType==3){B.appendChild(D.createTextNode(n.substringData(0,q)));if(v){n.deleteData(0,q)}}}else{z=m.cloneNode(false);B.appendChild(z)}if(w!=y||!A[y]){while(t){if(t===o){break}m=t.previousSibling;B.insertBefore(!v?t.cloneNode(true):t,B.firstChild);t=m}}B=z}if(v){r.setStartBefore(!l[y]?l[y-1]:!A[y]?A[y-1]:l[y]).collapse(true)}s&&domUtils.remove(s);u&&domUtils.remove(u);return k}var d=dom.Range=function(k){var l=this;l.startContainer=l.startOffset=l.endContainer=l.endOffset=null;l.document=k;l.collapsed=true};function e(n,k){try{if(c&&domUtils.inDoc(c,n)){if(!c.nodeValue.replace(fillCharReg,"").length){var l=c.parentNode;domUtils.remove(c);while(l&&domUtils.isEmptyInlineElement(l)&&(browser.safari?!(domUtils.getPosition(l,k)&domUtils.POSITION_CONTAINS):!l.contains(k))){c=l.parentNode;domUtils.remove(l);l=c}}else{c.nodeValue=c.nodeValue.replace(fillCharReg,"")}}}catch(m){}}function h(m,k){var l;m=m[k];while(m&&domUtils.isFillChar(m)){l=m[k];domUtils.remove(m);m=l}}d.prototype={cloneContents:function(){return this.collapsed?null:i(this,0)},deleteContents:function(){var k;if(!this.collapsed){i(this,1)}if(browser.webkit){k=this.startContainer;if(k.nodeType==3&&!k.nodeValue.length){this.setStartBefore(k).collapse(true);domUtils.remove(k)}}return this},extractContents:function(){return this.collapsed?null:i(this,2)},setStart:function(k,l){return a(true,k,l,this)},setEnd:function(k,l){return a(false,k,l,this)},setStartAfter:function(k){return this.setStart(k.parentNode,domUtils.getNodeIndex(k)+1)},setStartBefore:function(k){return this.setStart(k.parentNode,domUtils.getNodeIndex(k))},setEndAfter:function(k){return this.setEnd(k.parentNode,domUtils.getNodeIndex(k)+1)},setEndBefore:function(k){return this.setEnd(k.parentNode,domUtils.getNodeIndex(k))},setStartAtFirst:function(k){return this.setStart(k,0)},setStartAtLast:function(k){return this.setStart(k,k.nodeType==3?k.nodeValue.length:k.childNodes.length)},setEndAtFirst:function(k){return this.setEnd(k,0)},setEndAtLast:function(k){return this.setEnd(k,k.nodeType==3?k.nodeValue.length:k.childNodes.length)},selectNode:function(k){return this.setStartBefore(k).setEndAfter(k)},selectNodeContents:function(k){return this.setStart(k,0).setEndAtLast(k)},cloneRange:function(){var k=this;return new d(k.document).setStart(k.startContainer,k.startOffset).setEnd(k.endContainer,k.endOffset)},collapse:function(k){var l=this;if(k){l.endContainer=l.startContainer;l.endOffset=l.startOffset}else{l.startContainer=l.endContainer;l.startOffset=l.endOffset}l.collapsed=true;return l},shrinkBoundary:function(m){var l=this,o,n=l.collapsed;function k(q){return q.nodeType==1&&!domUtils.isBookmarkNode(q)&&!dtd.$empty[q.tagName]&&!dtd.$nonChild[q.tagName]}while(l.startContainer.nodeType==1&&(o=l.startContainer.childNodes[l.startOffset])&&k(o)){l.setStart(o,0)}if(n){return l.collapse(true)}if(!m){while(l.endContainer.nodeType==1&&l.endOffset>0&&(o=l.endContainer.childNodes[l.endOffset-1])&&k(o)){l.setEnd(o,o.childNodes.length)}}return l},getCommonAncestor:function(l,m){var n=this,o=n.startContainer,k=n.endContainer;if(o===k){if(l&&j(this)){o=o.childNodes[n.startOffset];if(o.nodeType==1){return o}}return m&&o.nodeType==3?o.parentNode:o}return domUtils.getCommonAncestor(o,k)},trimBoundary:function(l){this.txtToElmBoundary();var q=this.startContainer,o=this.startOffset,n=this.collapsed,k=this.endContainer;if(q.nodeType==3){if(o==0){this.setStartBefore(q)}else{if(o>=q.nodeValue.length){this.setStartAfter(q)}else{var m=domUtils.split(q,o);if(q===k){this.setEnd(m,this.endOffset-o)}else{if(q.parentNode===k){this.endOffset+=1}}this.setStartBefore(m)}}if(n){return this.collapse(true)}}if(!l){o=this.endOffset;k=this.endContainer;if(k.nodeType==3){if(o==0){this.setEndBefore(k)}else{o<k.nodeValue.length&&domUtils.split(k,o);this.setEndAfter(k)}}}return this},txtToElmBoundary:function(){function k(m,o){var l=m[o+"Container"],n=m[o+"Offset"];if(l.nodeType==3){if(!n){m["set"+o.replace(/(\w)/,function(q){return q.toUpperCase()})+"Before"](l)}else{if(n>=l.nodeValue.length){m["set"+o.replace(/(\w)/,function(q){return q.toUpperCase()})+"After"](l)}}}}if(!this.collapsed){k(this,"start");k(this,"end")}return this},insertNode:function(m){var o=m,l=1;if(m.nodeType==11){o=m.firstChild;l=m.childNodes.length}this.trimBoundary(true);var q=this.startContainer,n=this.startOffset;var k=q.childNodes[n];if(k){q.insertBefore(m,k)}else{q.appendChild(m)}if(o.parentNode===this.endContainer){this.endOffset=this.endOffset+l}return this.setStartBefore(o)},setCursor:function(l,k){return this.collapse(!l).select(k)},createBookmark:function(m,n){var k,l=this.document.createElement("span");l.style.cssText="display:none;line-height:0px;";l.appendChild(this.document.createTextNode("\uFEFF"));l.id="_baidu_bookmark_start_"+(n?"":f++);if(!this.collapsed){k=l.cloneNode(true);k.id="_baidu_bookmark_end_"+(n?"":f++)}this.insertNode(l);if(k){this.collapse().insertNode(k).setEndBefore(k)}this.setStartAfter(l);return{start:m?l.id:l,end:k?m?k.id:k:null,id:m}},moveToBookmark:function(l){var m=l.id?this.document.getElementById(l.start):l.start,k=l.end&&l.id?this.document.getElementById(l.end):l.end;this.setStartBefore(m);domUtils.remove(m);if(k){this.setEndBefore(k);domUtils.remove(k)}else{this.collapse(true)}return this},enlarge:function(l,o){var k=domUtils.isBody,q,n,m=this.document.createTextNode("");if(l){n=this.startContainer;if(n.nodeType==1){if(n.childNodes[this.startOffset]){q=n=n.childNodes[this.startOffset]}else{n.appendChild(m);q=n=m}}else{q=n}while(1){if(domUtils.isBlockElm(n)){n=q;while((q=n.previousSibling)&&!domUtils.isBlockElm(q)){n=q}this.setStartBefore(n);break}q=n;n=n.parentNode}n=this.endContainer;if(n.nodeType==1){if(q=n.childNodes[this.endOffset]){n.insertBefore(m,q)}else{n.appendChild(m)}q=n=m}else{q=n}while(1){if(domUtils.isBlockElm(n)){n=q;while((q=n.nextSibling)&&!domUtils.isBlockElm(q)){n=q}this.setEndAfter(n);break}q=n;n=n.parentNode}if(m.parentNode===this.endContainer){this.endOffset--}domUtils.remove(m)}if(!this.collapsed){while(this.startOffset==0){if(o&&o(this.startContainer)){break}if(k(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(o&&o(this.endContainer)){break}if(k(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!domUtils.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(m,y,u){if(this.collapsed){return this}this.trimBoundary().enlarge(false,function(C){return C.nodeType==1&&domUtils.isBlockElm(C)}).adjustmentBoundary();var v=this.createBookmark(),q=v.end,A=function(C){return C.nodeType==1?C.tagName.toLowerCase()!="br":!domUtils.isWhitespace(C)},t=domUtils.getNextDomNode(v.start,false,A),n,o,s=this.cloneRange();while(t&&(domUtils.getPosition(t,q)&domUtils.POSITION_PRECEDING)){if(t.nodeType==3||dtd[m][t.tagName]){s.setStartBefore(t);n=t;while(n&&(n.nodeType==3||dtd[m][n.tagName])&&n!==q){o=n;n=domUtils.getNextDomNode(n,n.nodeType==1,null,function(C){return dtd[m][C.tagName]})}var z=s.setEndAfter(o).extractContents(),w;if(u&&u.length>0){var k,x;x=k=u[0].cloneNode(false);for(var r=1,B;B=u[r++];){k.appendChild(B.cloneNode(false));k=k.firstChild}w=k}else{w=s.document.createElement(m)}if(y){domUtils.setAttributes(w,y)}w.appendChild(z);s.insertNode(u?x:w);var l;if(m=="span"&&y.style&&/text\-decoration/.test(y.style)&&(l=domUtils.findParentByTagName(w,"a",true))){domUtils.setAttributes(l,y);domUtils.remove(w,true);w=l}else{domUtils.mergeSibling(w);domUtils.clearEmptySibling(w)}domUtils.mergeChild(w,y);t=domUtils.getNextDomNode(w,false,A);domUtils.mergeToParent(w);if(n===q){break}}else{t=domUtils.getNextDomNode(t,true,A)}}return this.moveToBookmark(v)},removeInlineStyle:function(k){if(this.collapsed){return this}k=utils.isArray(k)?k:[k];this.shrinkBoundary().adjustmentBoundary();var s=this.startContainer,l=this.endContainer;while(1){if(s.nodeType==1){if(utils.indexOf(k,s.tagName.toLowerCase())>-1){break}if(s.tagName.toLowerCase()=="body"){s=null;break}}s=s.parentNode}while(1){if(l.nodeType==1){if(utils.indexOf(k,l.tagName.toLowerCase())>-1){break}if(l.tagName.toLowerCase()=="body"){l=null;break}}l=l.parentNode}var n=this.createBookmark(),r,q;if(s){q=this.cloneRange().setEndBefore(n.start).setStartBefore(s);r=q.extractContents();q.insertNode(r);domUtils.clearEmptySibling(s,true);s.parentNode.insertBefore(n.start,s)}if(l){q=this.cloneRange().setStartAfter(n.end).setEndAfter(l);r=q.extractContents();q.insertNode(r);domUtils.clearEmptySibling(l,false,true);l.parentNode.insertBefore(n.end,l.nextSibling)}var o=domUtils.getNextDomNode(n.start,false,function(t){return t.nodeType==1}),m;while(o&&o!==n.end){m=domUtils.getNextDomNode(o,true,function(t){return t.nodeType==1});if(utils.indexOf(k,o.tagName.toLowerCase())>-1){domUtils.remove(o,true)}o=m}return this.moveToBookmark(n)},getClosedNode:function(){var l;if(!this.collapsed){var k=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(j(k)){var m=k.startContainer.childNodes[k.startOffset];if(m&&m.nodeType==1&&(dtd.$empty[m.tagName]||dtd.$nonChild[m.tagName])){l=m}}}return l},select:browser.ie?function(l,v){var r;if(!this.collapsed){this.shrinkBoundary()}var m=this.getClosedNode();if(m&&!v){try{r=this.document.body.createControlRange();r.addElement(m);r.select()}catch(s){}return this}var t=this.createBookmark(),k=t.start,n;r=this.document.body.createTextRange();r.moveToElementText(k);r.moveStart("character",1);if(!this.collapsed){var q=this.document.body.createTextRange();n=t.end;q.moveToElementText(n);r.setEndPoint("EndToEnd",q)}else{if(!l&&this.startContainer.nodeType!=3){var u=this.document.createTextNode(g),o=this.document.createElement("span");o.appendChild(this.document.createTextNode(g));k.parentNode.insertBefore(o,k);k.parentNode.insertBefore(u,k);e(this.document,u);c=u;h(o,"previousSibling");h(k,"nextSibling");r.moveStart("character",-1);r.collapse(true)}}this.moveToBookmark(t);o&&domUtils.remove(o);try{r.select()}catch(s){}return this}:function(k){var q=domUtils.getWindow(this.document),o=q.getSelection(),n;browser.gecko?this.document.body.focus():q.focus();if(o){o.removeAllRanges();if(this.collapsed){if(k&&browser.opera&&!domUtils.isBody(this.startContainer)&&this.startContainer.nodeType==1){var l=this.document.createTextNode("");this.insertNode(l).setStart(l,0).collapse(true)}if(!k&&(this.startContainer.nodeType!=3||this.startOffset==0&&(!this.startContainer.previousSibling||this.startContainer.previousSibling.nodeType!=3))){n=this.document.createTextNode(g);this.insertNode(n);e(this.document,n);h(n,"previousSibling");h(n,"nextSibling");c=n;this.setStart(n,browser.webkit?1:0).collapse(true)}}var m=this.document.createRange();m.setStart(this.startContainer,this.startOffset);m.setEnd(this.endContainer,this.endOffset);o.addRange(m)}return this},scrollToView:function(m,n){m=m?window:domUtils.getWindow(this.document);var l=this,k=l.document.createElement("span");k.innerHTML="&nbsp;";l.cloneRange().insertNode(k);domUtils.scrollToView(k,m,n);domUtils.remove(k);return l}}})();(function(){function d(q,g){var h=domUtils.getNodeIndex;q=q.duplicate();q.collapse(g);var u=q.parentElement();if(!u.hasChildNodes()){return{container:u,offset:0}}var t=u.children,j,l=q.duplicate(),v=0,o=t.length-1,r=-1,f;while(v<=o){r=Math.floor((v+o)/2);j=t[r];l.moveToElementText(j);var n=l.compareEndPoints("StartToStart",q);if(n>0){o=r-1}else{if(n<0){v=r+1}else{return{container:u,offset:h(j)}}}}if(r==-1){l.moveToElementText(u);l.setEndPoint("StartToStart",q);f=l.text.replace(/(\r\n|\r)/g,"\n").length;t=u.childNodes;if(!f){j=t[t.length-1];return{container:j,offset:j.nodeValue.length}}var m=t.length;while(f>0){f-=t[--m].nodeValue.length}return{container:t[m],offset:-f}}l.collapse(n>0);l.setEndPoint(n>0?"StartToStart":"EndToStart",q);f=l.text.replace(/(\r\n|\r)/g,"\n").length;if(!f){return dtd.$empty[j.tagName]||dtd.$nonChild[j.tagName]?{container:u,offset:h(j)+(n>0?0:1)}:{container:j,offset:n>0?0:j.childNodes.length}}while(f>0){try{var k=j;j=j[n>0?"previousSibling":"nextSibling"];f-=j.nodeValue.length}catch(s){return{container:u,offset:h(k)}}}return{container:j,offset:n>0?-f:j.nodeValue.length+f}}function c(g,f){if(g.item){f.selectNode(g.item(0))}else{var e=d(g,true);f.setStart(e.container,e.offset);if(g.compareEndPoints("StartToEnd",g)!=0){e=d(g,false);f.setEnd(e.container,e.offset)}}return f}function b(h){var g;try{g=h.getNative().createRange()}catch(i){return null}var f=g.item?g.item(0):g.parentElement();if((f.ownerDocument||f)===h.document){return g}return null}var a=dom.Selection=function(g){var f=this,e;f.document=g;if(ie){e=domUtils.getWindow(g).frameElement;domUtils.on(e,"beforedeactivate",function(){f._bakIERange=f.getIERange()});domUtils.on(e,"activate",function(){try{if(!b(f)&&f._bakIERange){f._bakIERange.select()}}catch(h){}f._bakIERange=null})}e=g=null};a.prototype={getNative:function(){var g=this.document;try{return !g?null:ie?g.selection:domUtils.getWindow(g).getSelection()}catch(f){return null}},getIERange:function(){var e=b(this);if(!e){if(this._bakIERange){return this._bakIERange}}return e},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath){return this._cachedStartElementPath}var e=this.getStart();if(e){return domUtils.findParents(e,true,null,true)}return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return browser.ie&&b(this)||!browser.ie&&this.getNative().rangeCount?true:false}catch(f){return false}},getRange:function(){var h=this;function g(l){var n=h.document.body.firstChild,m=l.collapsed;while(n&&n.firstChild){l.setStart(n,0);n=n.firstChild}if(!l.startContainer){l.setStart(h.document.body,0)}if(m){l.collapse(true)}}if(h._cachedRange!=null){return this._cachedRange}var f=new baidu.editor.dom.Range(h.document);if(ie){var j=h.getIERange();if(j){c(j,f)}else{g(f)}}else{var i=h.getNative();if(i&&i.rangeCount){var e=i.getRangeAt(0);var k=i.getRangeAt(i.rangeCount-1);f.setStart(e.startContainer,e.startOffset).setEnd(k.endContainer,k.endOffset);if(f.collapsed&&domUtils.isBody(f.startContainer)&&!f.startOffset){g(f)}}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange}g(f)}}return this._bakRange=f},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var e=ie?this.getIERange():this.getRange(),h,i,f,g;if(ie){if(!e){return this.document.body.firstChild}if(e.item){return e.item(0)}h=e.duplicate();h.text.length>0&&h.moveStart("character",1);h.collapse(1);i=h.parentElement();g=f=e.parentElement();while(f=f.parentNode){if(f==i){i=g;break}}}else{e.shrinkBoundary();i=e.startContainer;if(i.nodeType==1&&i.hasChildNodes()){i=i.childNodes[Math.min(i.childNodes.length-1,e.startOffset)]}if(i.nodeType==3){return i.parentNode}}return i},getText:function(){var e,f;if(this.isFocus()&&(e=this.getNative())){f=browser.ie?e.createRange():e.getRangeAt(0);return browser.ie?f.text:f.toString()}return""}}})();(function(){var d=0,b;function c(m){var l=m.getElementsByTagName("img"),k;for(var j=0,h;h=l[j++];){if(k=h.getAttribute("orgSrc")){h.src=k;h.removeAttribute("orgSrc")}}var g=m.getElementsByTagName("a");for(var j=0,f;f=g[j++];j++){if(f.getAttribute("data_ue_src")){f.setAttribute("href",f.getAttribute("data_ue_src"))}}}function e(l,k){var f;if(k.textarea){if(utils.isString(k.textarea)){for(var h=0,j,g=domUtils.getElementsByTagName(l,"textarea");j=g[h++];){if(j.id=="ueditor_textarea_"+k.options.textarea){f=j;break}}}else{f=k.textarea}}if(!f){l.appendChild(f=domUtils.createElement(document,"textarea",{name:k.options.textarea,id:"ueditor_textarea_"+k.options.textarea,style:"display:none"}));k.textarea=f}f.value=k.hasContents()?(k.options.allHtmlEnabled?k.getAllHtml():k.getContent(null,null,true)):""}var a=UE.Editor=function(f){var g=this;g.uid=d++;EventBase.call(g);g.commands={};g.options=utils.extend(utils.clone(f||{}),UEDITOR_CONFIG,true);g.setOpt({isShow:true,initialContent:"\u6b22\u8fce\u4f7f\u7528ueditor!",autoClearinitialContent:false,iframeCssUrl:g.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:false,initialFrameWidth:1000,initialFrameHeight:g.options.minFrameHeight||320,minFrameWidth:800,minFrameHeight:220,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",pageBreakTag:"_baidu_page_break_tag_",customDomain:false,lang:"zh-cn",langPath:g.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:g.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false});utils.loadFile(document,{src:g.options.langPath+g.options.lang+"/"+g.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){for(var h in UE.plugins){UE.plugins[h].call(g)}g.langIsReady=true;g.fireEvent("langReady")});UE.instants["ueditorInstant"+g.uid]=g};a.prototype={ready:function(f){var g=this;if(f){g.isReady?f.apply(g):g.addListener("ready",f)}},setOpt:function(f,h){var g={};if(utils.isString(f)){g[f]=h}else{g=f}utils.extend(this.options,g,true)},destroy:function(){var i=this;i.fireEvent("destroy");var g=i.container.parentNode;var f=i.textarea;if(!f){f=document.createElement("textarea");g.parentNode.insertBefore(f,g)}else{f.style.display=""}f.style.width=g.offsetWidth+"px";f.style.height=g.offsetHeight+"px";f.value=i.getContent();f.id=i.key;g.innerHTML="";domUtils.remove(g);var h=i.key;for(var j in i){if(i.hasOwnProperty(j)){delete this[j]}}UE.delEditor(h)},render:function(g){var j=this,h=j.options;if(utils.isString(g)){g=document.getElementById(g)}if(g){var f=ie&&browser.version<9,i=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(!f?" class='view'":"")+"><head>"+(h.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(h.iframeCssUrl)+"'/>":"")+"<style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}"+(h.initialStyle||"")+"</style></head><body"+(f?" class='view'":"")+"></body>";if(h.customDomain&&document.domain!=location.hostname){i+="<script>window.parent.UE.instants['ueditorInstant"+j.uid+"']._setup(document);<\/script></html>";g.appendChild(domUtils.createElement(document,"iframe",{id:"baidu_editor_"+j.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";document.write("'+i+'");document.close();}())'}))}else{g.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%" scroll="no" frameborder="0" ></iframe>';var k=g.firstChild.contentWindow.document;k.open();k.write(i+"</html>");k.close();j._setup(k)}g.style.overflow="hidden"}},_setup:function(k){var i=this,f=i.options;if(ie){k.body.disabled=true;k.body.contentEditable=true;k.body.disabled=false}else{k.body.contentEditable=true;k.body.spellcheck=false}i.document=k;i.window=k.defaultView||k.parentWindow;i.iframe=i.window.frameElement;i.body=k.body;i.setHeight(Math.max(f.minFrameHeight,f.initialFrameHeight));i.selection=new dom.Selection(k);var l;if(browser.gecko&&(l=this.selection.getNative())){l.removeAllRanges()}this._initEvents();if(f.initialContent){if(f.autoClearinitialContent){var g=i.execCommand;i.execCommand=function(){i.fireEvent("firstBeforeExecCommand");g.apply(i,arguments)};this._setDefaultContent(f.initialContent)}else{this.setContent(f.initialContent,true)}}for(var h=this.iframe.parentNode;!domUtils.isBody(h);h=h.parentNode){if(h.tagName=="FORM"){domUtils.on(h,"submit",function(){e(this,i)});break}}if(domUtils.isEmptyNode(i.body)){i.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"}if(f.focus){setTimeout(function(){i.focus();!i.options.autoClearinitialContent&&i._selectionChange()},0)}if(!i.container){i.container=this.iframe.parentNode}if(f.fullscreen&&i.ui){i.ui.setFullScreen(true)}try{i.document.execCommand("2D-position",false,false)}catch(j){}try{i.document.execCommand("enableInlineTableEditing",false,f.tableNativeEditInFF)}catch(j){}try{i.document.execCommand("enableObjectResizing",false,false)}catch(j){domUtils.on(i.body,browser.ie?"resizestart":"resize",function(m){domUtils.preventDefault(m)})}i.isReady=1;i.fireEvent("ready");f.onready&&f.onready.call(i);if(!browser.ie){domUtils.on(i.window,["blur","focus"],function(m){if(m.type=="blur"){i._bakRange=i.selection.getRange();try{i.selection.getNative().removeAllRanges()}catch(m){}}else{try{i._bakRange&&i._bakRange.select()}catch(m){}}})}if(browser.gecko&&browser.version<=10902){i.body.contentEditable=false;setTimeout(function(){i.body.contentEditable=true},100);setInterval(function(){i.body.style.height=i.iframe.offsetHeight-20+"px"},100)}!f.isShow&&i.setHide();f.readonly&&i.setDisabled()},sync:function(h){var g=this,f=h?document.getElementById(h):domUtils.findParent(g.iframe.parentNode,function(i){return i.tagName=="FORM"},true);f&&e(f,g)},setHeight:function(f){if(f!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=f+"px"}this.document.body.style.height=f-20+"px"},getContent:function(l,i,f){var k=this;if(l&&utils.isFunction(l)){i=l;l=""}if(i?!i():!this.hasContents()){return""}k.fireEvent("beforegetcontent",l);var h=new RegExp(domUtils.fillChar,"g"),g=k.body.innerHTML.replace(h,"").replace(/>[\t\r\n]*?</g,"><");k.fireEvent("aftergetcontent",l);if(k.serialize){var j=k.serialize.parseHTML(g);j=k.serialize.transformOutput(j);g=k.serialize.toHTML(j)}if(ie&&f){g=g.replace(/<p>\s*?<\/p>/g,"<p>&nbsp;</p>")}else{g=g.replace(/(&nbsp;)+/g,function(o){for(var n=0,q=[],m=o.split(";").length-1;n<m;n++){q.push(n%2==0?" ":"&nbsp;")}return q.join("")})}return g},getAllHtml:function(){var h=this,g={html:""},f="";h.fireEvent("getAllHtml",g);return"<html><head>"+(h.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+h.options.charset+'"/>':"")+h.document.getElementsByTagName("head")[0].innerHTML+g.html+"</head><body "+(ie&&browser.version<9?'class="view"':"")+">"+h.getContent(null,null,true)+"</body></html>"},getPlainTxt:function(){var g=new RegExp(domUtils.fillChar,"g"),f=this.body.innerHTML.replace(/[\n\r]/g,"");f=f.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(i,h,j){return dtd.$block[j]?"\n":h?h:""});return f.replace(g,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var f=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(f,"").replace(/\u00a0/g," ")},setContent:function(l,j){var o=this,n=utils.extend({a:1,A:1},dtd.$inline,true),k;l=l.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>[\t\r\n]*?</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(s,r,t){if(r){k=t}else{r=k}return !n[r]&&!n[t]?s.replace(/>[ \t\r\n]*?</,"><"):s});l={html:l};o.fireEvent("beforesetcontent",l);l=l.html;var q=this.serialize;if(q){var i=q.parseHTML(l);i=q.transformInput(i);i=q.filter(i);l=q.toHTML(i)}this.body.innerHTML=l.replace(new RegExp("[\r"+domUtils.fillChar+"]*","g"),"");if(browser.ie&&browser.version<7){c(this.document.body)}if(o.options.enterTag=="p"){var g=this.body.firstChild,h;if(!g||g.nodeType==1&&(dtd.$cdata[g.tagName]||domUtils.isCustomeNode(g))&&g===this.body.lastChild){this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML}else{var f=o.document.createElement("p");while(g){while(g&&(g.nodeType==3||g.nodeType==1&&dtd.p[g.tagName]&&!dtd.$cdata[g.tagName])){h=g.nextSibling;f.appendChild(g);g=h}if(f.firstChild){if(!g){o.body.appendChild(f);break}else{o.body.insertBefore(f,g);f=o.document.createElement("p")}}g=g.nextSibling}}}o.fireEvent("aftersetcontent");o.fireEvent("contentchange");!j&&o._selectionChange();o._bakRange=o._bakIERange=null;var m;if(browser.gecko&&(m=this.selection.getNative())){m.removeAllRanges()}},focus:function(i){try{var g=this,f=g.selection.getRange();if(i){f.setStartAtLast(g.body.lastChild).setCursor(false,true)}else{f.select(true)}}catch(h){}},_initEvents:function(){var g=this,k=g.document,j=g.window;g._proxyDomEvent=utils.bind(g._proxyDomEvent,g);domUtils.on(k,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],g._proxyDomEvent);domUtils.on(j,["focus","blur"],g._proxyDomEvent);domUtils.on(k,["mouseup","keydown"],function(l){if(l.type=="keydown"&&(l.ctrlKey||l.metaKey||l.shiftKey||l.altKey)){return}if(l.button==2){return}g._selectionChange(250,l)});var f=0,h=browser.ie?g.body:g.document,i;domUtils.on(h,"dragstart",function(){f=1});domUtils.on(h,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(i);i=setTimeout(function(){if(!f){var q=g.selection,l=q.getRange();if(l){var m=l.getCommonAncestor();if(m&&g.serialize){var o=g.serialize,n=o.filter(o.transformInput(o.parseHTML(o.word(m.innerHTML))));m.innerHTML=o.toHTML(n)}}}f=0},200)}:function(l){if(!f){l.preventDefault?l.preventDefault():(l.returnValue=false)}f=0}}())},_proxyDomEvent:function(f){return this.fireEvent(f.type.replace(/^on/,""),f)},_selectionChange:function(i,f){var l=this;var k=false;var j,h;if(browser.ie&&browser.version<9&&f&&f.type=="mouseup"){var g=this.selection.getRange();if(!g.collapsed){k=true;j=f.clientX;h=f.clientY}}clearTimeout(b);b=setTimeout(function(){if(!l.selection.getNative()){return}var n;if(k&&l.selection.getNative().type=="None"){n=l.document.body.createTextRange();try{n.moveToPoint(j,h)}catch(m){n=null}}var o;if(n){o=l.selection.getIERange;l.selection.getIERange=function(){return n}}l.selection.cache();if(o){l.selection.getIERange=o}if(l.selection._cachedRange&&l.selection._cachedStartElement){l.fireEvent("beforeselectionchange");l.fireEvent("selectionchange",!!f);l.fireEvent("afterselectionchange");l.selection.clear()}},i||50)},_callCmdFn:function(j,g){var f=g[0].toLowerCase(),i,h;i=this.commands[f]||UE.commands[f];h=i&&i[j];if((!i||!h)&&j=="queryCommandState"){return 0}else{if(h){return h.apply(this,g)}}},execCommand:function(g){g=g.toLowerCase();var h=this,f,i=h.commands[g]||UE.commands[g];if(!i||!i.execCommand){return null}if(!i.notNeedUndo&&!h.__hasEnterExecCommand){h.__hasEnterExecCommand=true;if(h.queryCommandState(g)!=-1){h.fireEvent("beforeexeccommand",g);f=this._callCmdFn("execCommand",arguments);h.fireEvent("afterexeccommand",g)}h.__hasEnterExecCommand=false}else{f=this._callCmdFn("execCommand",arguments)}!h.__hasEnterExecCommand&&h._selectionChange();return f},queryCommandState:function(f){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(f){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(g){if(g){for(var j=0,h;h=g[j++];){if(this.document.getElementsByTagName(h).length>0){return true}}}if(!domUtils.isEmptyBlock(this.body)){return true}g=["div"];for(j=0;h=g[j++];){var f=domUtils.getElementsByTagName(this.document,h);for(var l=0,k;k=f[l++];){if(domUtils.isCustomeNode(k)){return true}}}return false},reset:function(){this.fireEvent("reset")},setEnabled:function(){var g=this,f;if(g.body.contentEditable=="false"){g.body.contentEditable=true;f=g.selection.getRange();try{f.moveToBookmark(g.lastBk);delete g.lastBk}catch(h){f.setStartAtFirst(g.body).collapse(true)}f.select(true);if(g.bkqueryCommandState){g.queryCommandState=g.bkqueryCommandState;delete g.bkqueryCommandState}g.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(f){var g=this;f=f?utils.isArray(f)?f:[f]:[];if(g.body.contentEditable=="true"){if(!g.lastBk){g.lastBk=g.selection.getRange().createBookmark(true)}g.body.contentEditable=false;g.bkqueryCommandState=g.queryCommandState;g.queryCommandState=function(h){if(utils.indexOf(f,h)!=-1){return g.bkqueryCommandState.apply(g,arguments)}return -1};g.fireEvent("selectionchange")}},disable:function(f){return this.setDisabled(f)},_setDefaultContent:function(){function f(){var g=this;if(g.document.getElementById("initContent")){g.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";g.removeListener("firstBeforeExecCommand focus",f);setTimeout(function(){g.focus();g._selectionChange()},0)}}return function(g){var h=this;h.body.innerHTML='<p id="initContent">'+g+"</p>";if(browser.ie&&browser.version<7){c(h.body)}h.addListener("firstBeforeExecCommand focus",f)}}(),setShow:function(){var g=this,f=g.selection.getRange();if(g.container.style.display=="none"){try{f.moveToBookmark(g.lastBk);delete g.lastBk}catch(h){f.setStartAtFirst(g.body).collapse(true)}setTimeout(function(){f.select(true)},100);g.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var f=this;if(!f.lastBk){f.lastBk=f.selection.getRange().createBookmark(true)}f.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(h){var j=UE.I18N[this.options.lang];h=(h||"").split(".");for(var g=0,f;f=h[g++];){j=j[f];if(!j){break}}return j}};utils.inherits(a,EventBase)})();UE.ajax=function(){var a="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");a="ActiveXObject('Msxml2.XMLHTTP')"}catch(d){try{new ActiveXObject("Microsoft.XMLHTTP");a="ActiveXObject('Microsoft.XMLHTTP')"}catch(d){}}var c=new Function("return new "+a);function b(f){var g=[];for(var e in f){if(e=="method"||e=="timeout"||e=="async"){continue}if(!((typeof f[e]).toLowerCase()=="function"||(typeof f[e]).toLowerCase()=="object")){g.push(encodeURIComponent(e)+"="+encodeURIComponent(f[e]))}}return g.join("&")}return{request:function(f,h){var l=c(),i=false,g={method:"POST",timeout:5000,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof f==="object"){h=f;f=h.url}if(!l||!f){return}var k=h?utils.extend(g,h):g;var n=b(k);if(!utils.isEmptyObject(k.data)){n+=(n?"&":"")+b(k.data)}var m=setTimeout(function(){if(l.readyState!=4){i=true;l.abort();clearTimeout(m)}},k.timeout);var e=k.method.toUpperCase();var j=f+(f.indexOf("?")==-1?"?":"&")+(e=="POST"?"":n+"&noCache="+ +new Date);l.open(e,j,k.async);l.onreadystatechange=function(){if(l.readyState==4){if(!i&&l.status==200){k.onsuccess(l)}else{k.onerror(l)}}};if(e=="POST"){l.setRequestHeader("Content-Type","application/x-www-form-urlencoded");l.send(n)}else{l.send(null)}}}}();var filterWord=UE.filterWord=function(){function c(d){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(d)}function a(d){d=d.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)});return d}function b(d){return d.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(j){if(browser.opera){return""}try{var g=j.match(/width:([ \d.]*p[tx])/i)[1],f=j.match(/height:([ \d.]*p[tx])/i)[1],i=j.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+a(g)+'" height="'+a(f)+'" src="'+i+'" />'}catch(h){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)[\w-]+\2/ig,"").replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(l,r,j,f){var g=[],q=f.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g);for(var k=0,o;o=q[k];k++){var e,m,h=o.split(":");if(h.length==2){e=h[0].toLowerCase();m=h[1].toLowerCase();if(/^(background)\w*/.test(e)&&m.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(e)&&/^0\w+$/.test(m)){continue}switch(e){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(r)){g[k]=e.replace(/^mso-|-alt$/g,"")+":"+a(m)}continue;case"horiz-align":g[k]="text-align:"+m;continue;case"vert-align":g[k]="vertical-align:"+m;continue;case"font-color":case"mso-foreground":g[k]="color:"+m;continue;case"mso-background":case"mso-highlight":g[k]="background:"+m;continue;case"mso-default-height":g[k]="min-height:"+a(m);continue;case"mso-default-width":g[k]="min-width:"+a(m);continue;case"mso-padding-between-alt":g[k]="border-collapse:separate;border-spacing:"+a(m);continue;case"text-line-through":if((m=="single")||(m=="double")){g[k]="text-decoration:line-through"}continue;case"mso-zero-height":if(m=="yes"){g[k]="display:none"}continue;case"background":if(m=="initial"){}break;case"margin":if(!/[1-9]/.test(m)){continue}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(e)||/text\-indent|padding|margin/.test(e)&&/\-[\d.]+/.test(m)){continue}g[k]=e+":"+h[1]}}return r+(g.length?' style="'+g.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)})}return function(d){return(c(d)?b(d):d).replace(/>[ \t\r\n]*</g,"><")}}();var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){var d=baidu.editor.browser,c=baidu.editor.dom.domUtils;var g="$EDITORUI";var f=window[g]={};var a="ID"+g;var i=0;var b=baidu.editor.ui.uiUtils={uid:function(j){return(j?j[a]||(j[a]=++i):++i)},hook:function(j,l){var k;if(j&&j._callbacks){k=j}else{k=function(){var s;if(j){s=j.apply(this,arguments)}var o=k._callbacks;var m=o.length;while(m--){var n=o[m].apply(this,arguments);if(s===undefined){s=n}}return s};k._callbacks=[]}k._callbacks.push(l);return k},createElementByHtml:function(j){var k=document.createElement("div");k.innerHTML=j;k=k.firstChild;k.parentNode.removeChild(k);return k},getViewportElement:function(){return(d.ie&&d.quirks)?document.body:document.documentElement},getClientRect:function(j){var n;try{n=j.getBoundingClientRect()}catch(m){n={left:0,top:0,height:0,width:0}}var k={left:Math.round(n.left),top:Math.round(n.top),height:Math.round(n.bottom-n.top),width:Math.round(n.right-n.left)};var l;while((l=j.ownerDocument)!==document&&(j=c.getWindow(l).frameElement)){n=j.getBoundingClientRect();k.left+=n.left;k.top+=n.top}k.bottom=k.top+k.height;k.right=k.left+k.width;return k},getViewportRect:function(){var k=b.getViewportElement();var l=(window.innerWidth||k.clientWidth)|0;var j=(window.innerHeight||k.clientHeight)|0;return{left:0,top:0,height:j,width:l,bottom:j,right:l}},setViewportOffset:function(j,m){var k;var l=b.getFixedLayer();if(j.parentNode===l){j.style.left=m.left+"px";j.style.top=m.top+"px"}else{c.setViewportOffset(j,m)}},getEventOffset:function(j){var k=j.target||j.srcElement;var l=b.getClientRect(k);var m=b.getViewportOffsetByEvent(j);return{left:m.left-l.left,top:m.top-l.top}},getViewportOffsetByEvent:function(k){var l=k.target||k.srcElement;var j=c.getWindow(l).frameElement;var n={left:k.clientX,top:k.clientY};if(j&&l.ownerDocument!==document){var m=b.getClientRect(j);n.left+=m.left;n.top+=m.top}return n},setGlobal:function(k,j){f[k]=j;return g+'["'+k+'"]'},unsetGlobal:function(j){delete f[j]},copyAttributes:function(o,n){var l=n.attributes;var j=l.length;while(j--){var m=l[j];if(m.nodeName!="style"&&m.nodeName!="class"&&(!d.ie||m.specified)){o.setAttribute(m.nodeName,m.nodeValue)}}if(n.className){c.addClass(o,n.className)}if(n.style.cssText){o.style.cssText+=";"+n.style.cssText}},removeStyle:function(k,j){if(k.style.removeProperty){k.style.removeProperty(j)}else{if(k.style.removeAttribute){k.style.removeAttribute(j)}else{throw""}}},contains:function(k,j){return k&&j&&(k===j?false:(k.contains?k.contains(j):k.compareDocumentPosition(j)&16))},startDrag:function(s,n,q){var q=q||document;var m=s.clientX;var l=s.clientY;function k(u){var t=u.clientX-m;var v=u.clientY-l;n.ondragmove(t,v);if(u.stopPropagation){u.stopPropagation()}else{u.cancelBubble=true}}if(q.addEventListener){function r(t){q.removeEventListener("mousemove",k,true);q.removeEventListener("mouseup",k,true);window.removeEventListener("mouseup",r,true);n.ondragstop()}q.addEventListener("mousemove",k,true);q.addEventListener("mouseup",r,true);window.addEventListener("mouseup",r,true);s.preventDefault()}else{var o=s.srcElement;o.setCapture();function j(){o.releaseCapture();o.detachEvent("onmousemove",k);o.detachEvent("onmouseup",j);o.detachEvent("onlosecaptrue",j);n.ondragstop()}o.attachEvent("onmousemove",k);o.attachEvent("onmouseup",j);o.attachEvent("onlosecaptrue",j);s.returnValue=false}n.ondragstart()},getFixedLayer:function(){var j=document.getElementById("edui_fixedlayer");if(j==null){j=document.createElement("div");j.id="edui_fixedlayer";document.body.appendChild(j);if(d.ie&&d.version<=8){j.style.position="absolute";h();setTimeout(e)}else{j.style.position="fixed"}j.style.left="0";j.style.top="0";j.style.width="0";j.style.height="0"}return j},makeUnselectable:function(k){if(d.opera||(d.ie&&d.version<9)){k.unselectable="on";if(k.hasChildNodes()){for(var j=0;j<k.childNodes.length;j++){if(k.childNodes[j].nodeType==1){b.makeUnselectable(k.childNodes[j])}}}}else{if(k.style.MozUserSelect!==undefined){k.style.MozUserSelect="none"}else{if(k.style.WebkitUserSelect!==undefined){k.style.WebkitUserSelect="none"}else{if(k.style.KhtmlUserSelect!==undefined){k.style.KhtmlUserSelect="none"}}}}}};function e(){var j=document.getElementById("edui_fixedlayer");b.setViewportOffset(j,{left:0,top:0})}function h(j){c.on(window,"scroll",e);c.on(window,"resize",baidu.editor.utils.defer(e,0,true))}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,d=baidu.editor.ui.UIBase=function(){};d.prototype={className:"",uiName:"",initOptions:function(f){var g=this;for(var e in f){g[e]=f[e]}this.id=this.id||"edui"+b.uid()},initUIBase:function(){this._globalKey=a.unhtml(b.setGlobal(this.id,this))},render:function(n){var j=this.renderHtml();var e=b.createElementByHtml(j);var l=domUtils.getElementsByTagName(e,"*");var g="edui-"+(this.theme||this.editor.options.theme);var k=document.getElementById("edui_fixedlayer");for(var h=0,f;f=l[h++];){domUtils.addClass(f,g)}domUtils.addClass(e,g);if(k){k.className="";domUtils.addClass(k,g)}var m=this.getDom();if(m!=null){m.parentNode.replaceChild(e,m);b.copyAttributes(e,m)}else{if(typeof n=="string"){n=document.getElementById(n)}n=n||b.getFixedLayer();domUtils.addClass(n,g);n.appendChild(e)}this.postRender()},getDom:function(e){if(!e){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+e)}},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var f="edui-"+this.uiName;return(e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?f+"-":"").replace(/%%/g,(this.uiName?f:"")+" "+this.className).replace(/\$\$/g,this._globalKey))},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();if(e){baidu.editor.dom.domUtils.remove(e)}b.unsetGlobal(this.id)}};a.inherits(d,c)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.Separator=function(d){this.initOptions(d);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,a=baidu.editor.dom.domUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.uiUtils;var e=baidu.editor.ui.Mask=function(f){this.initOptions(f);this.initUIBase()};e.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var f=this;a.on(window,"resize",function(){setTimeout(function(){if(!f.isHidden()){f._fill()}})})},show:function(f){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=f},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_fill:function(){var f=this.getDom();var g=c.getViewportRect();f.style.width=g.width+"px";f.style.height=g.height+"px"}};b.inherits(e,d)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,h=baidu.editor.ui.UIBase,g=baidu.editor.ui.Popup=function(i){this.initOptions(i);this.initPopup()};var b=[];function f(l){var m=[];for(var k=0;k<b.length;k++){var j=b[k];if(!j.isHidden()){if(j.queryAutoHide(l)!==false){j.hide()}}}}g.postHide=f;var d=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];g.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function(){this.initUIBase();b.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(this.content){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()}else{return""}},_UIBase_postRender:h.prototype.postRender,postRender:function(){if(this.content instanceof h){this.content.postRender()}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){if(!this.getDom()&&this.autoRender){this.render()}},mesureSize:function(){var i=this.getDom("content");return e.getClientRect(i)},fitSize:function(){var i=this.getDom("body");i.style.width="";i.style.height="";var j=this.mesureSize();i.style.width=j.width+"px";i.style.height=j.height+"px";return j},showAnchor:function(j,i){this.showAnchorRect(e.getClientRect(j),i)},showAnchorRect:function(q,m,n){this._doAutoRender();var k=e.getViewportRect();this._show();var j=this.fitSize();var r,l,i,o;if(m){r=this.canSideLeft&&(q.right+j.width>k.right&&q.left>j.width);l=this.canSideUp&&(q.top+j.height>k.bottom&&q.bottom>j.height);i=(r?q.left-j.width:q.right);o=(l?q.bottom-j.height:q.top)}else{r=this.canSideLeft&&(q.right+j.width>k.right&&q.left>j.width);l=this.canSideUp&&(q.top+j.height>k.bottom&&q.bottom>j.height);i=(r?q.right-j.width:q.left);o=(l?q.top-j.height:q.bottom)}var s=this.getDom();e.setViewportOffset(s,{left:i,top:o});a.removeClasses(s,d);s.className+=" "+d[(l?1:0)*2+(r?1:0)];if(this.editor){s.style.zIndex=this.editor.container.style.zIndex*1+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=s.style.zIndex-1}},showAt:function(l){var k=l.left;var j=l.top;var i={left:k,top:j,right:k,bottom:j,height:0,width:0};this.showAnchorRect(i,false,true)},_show:function(){if(this._hidden){var i=this.getDom();i.style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(i){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;if(!i){this.fireEvent("hide")}}},queryAutoHide:function(i){return !i||!e.contains(this.getDom(),i)}};c.inherits(g,h);a.on(document,"mousedown",function(i){var j=i.target||i.srcElement;f(j)});a.on(window,"scroll",function(){f()})})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.UIBase,b=baidu.editor.ui.ColorPicker=function(f){this.initOptions(f);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};b.prototype={getHtmlTpl:function(){return e(this.noColorText,this.editor)},_onTableClick:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.fireEvent("pickcolor",g)}},_onTableOver:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.getDom("preview").style.backgroundColor=g}},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};a.inherits(b,c);var d=("ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,").split(",");function e(f,j){var h='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+f+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+j.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var g=0;g<d.length;g++){if(g&&g%10===0){h+="</tr>"+(g==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+j.getLang("standardColor")+"</td></tr>":"")+"<tr"+(g==60?' class="edui-colorpicker-tablefirstrow"':"")+">"}h+=g<70?'<td style="padding: 0 2px;"><a hidefocus title="'+d[g]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+d[g]+'" style="background-color:#'+d[g]+";border:solid #ccc;"+(g<10||g>=60?"border-width:1px;":g>=10&&g<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}h+="</tr></table></div>";return h}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase;var d=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};d.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span><span class="edui-clickable" onclick="$$._onMore();">'+e.editor.getLang("more")+'</span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:c.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(i,h){var f=this.getDom("overlay").style;var g=this.lengthOfCellSide;f.width=i*g+"px";f.height=h*g+"px";var e=this.getDom("label");e.innerHTML=i+this.editor.getLang("t_col")+" x "+h+this.editor.getLang("t_row");this.numCols=i;this.numRows=h},_onMouseOver:function(f,g){var e=f.relatedTarget||f.fromElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(f,g){var e=f.relatedTarget||f.toElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,g){var f=this.getDom("overlay").style;var k=b.getEventOffset(e);var i=this.lengthOfCellSide;var j=Math.ceil(k.left/i);var h=Math.ceil(k.top/i);this._track(j,h)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)},_onMore:function(){this.fireEvent("more")}};a.inherits(d,c)})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils;var d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(c.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));baidu.editor.ui.Stateful={alwalysHoverable:false,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseEnter(f,g)}},Stateful_onMouseOut:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseLeave(f,g)}},Stateful_onMouseDown:function(e,f){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(e,f){if(!this.isDisabled()){this.removeState("active")}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled")}},hasState:function(e){return a.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){if(!this.hasState(e)){this.getStateDom().className+=" edui-state-"+e}},removeState:function(e){if(this.hasState(e)){a.removeClasses(this.getStateDom(),["edui-state-"+e])}},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){if(!this.isDisabled()&&e){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,a=baidu.editor.ui.Button=function(e){this.initOptions(e);this.initButton()};a.prototype={uiName:"button",label:"",title:"",showIcon:true,showText:true,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}}};b.inherits(a,d);b.extend(a.prototype,c)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,f=baidu.editor.ui.UIBase,d=baidu.editor.ui.Stateful,b=baidu.editor.ui.SplitButton=function(g){this.initOptions(g);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var h=this;if(this.popup!=null){var g=this.popup;this.popup=null;this.setPopup(g)}},_UIBase_postRender:f.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(g){if(this.popup===g){return}if(this.popup!=null){this.popup.dispose()}g.addListener("show",c.bind(this._onPopupShow,this));g.addListener("hide",c.bind(this._onPopupHide,this));g.addListener("postrender",c.bind(function(){g.getDom("body").appendChild(e.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(e.getClientRect(this.getDom()).width-2)+'px"></div>'));g.getDom().className+=" "+this.className},this));this.popup=g},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var g=e.getClientRect(this.getDom());g.top-=this.popup.SHADOW_RADIUS;g.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(g)},_onArrowClick:function(h,g){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};c.inherits(b,f);c.extend(b.prototype,d,true)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.ColorPicker,f=baidu.editor.ui.Popup,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.ColorButton=function(g){this.initOptions(g);this.initColorButton()};e.prototype={initColorButton:function(){var g=this;this.popup=new f({content:new d({noColorText:g.editor.getLang("clearColor"),editor:g.editor,onpickcolor:function(i,h){g._onPickColor(h)},onpicknocolor:function(i,h){g._onPickNoColor(h)}}),editor:g.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(c.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(g){this.getDom("colorlump").style.backgroundColor=g;this.color=g},_onPickColor:function(g){if(this.fireEvent("pickcolor",g)!==false){this.setColor(g);this.popup.hide()}},_onPickNoColor:function(g){if(this.fireEvent("picknocolor")!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Popup,d=baidu.editor.ui.TablePicker,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.TableButton=function(f){this.initOptions(f);this.initTableButton()};e.prototype={initTableButton:function(){var f=this;this.popup=new c({content:new d({editor:f.editor,onpicktable:function(g,i,h){f._onPickTable(i,h)},onmore:function(){f.popup.hide();f.fireEvent("more")}}),editor:f.editor});this.initSplitButton()},_onPickTable:function(g,f){if(this.fireEvent("picktable",g,f)!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase;var c=baidu.editor.ui.AutoTypeSetPicker=function(d){this.initOptions(d);this.initAutoTypeSetPicker()};c.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,d=e.options.autotypeset,f=e.getLang("autoTypeSet");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap colspan="2"><input type="checkbox" name="mergeEmptyline" '+(d.mergeEmptyline?"checked":"")+">"+f.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(d.removeEmptyline?"checked":"")+">"+f.delLine+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="removeClass" '+(d.removeClass?"checked":"")+">"+f.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(d.indent?"checked":"")+">"+f.indent+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="textAlign" '+(d.textAlign?"checked":"")+">"+f.alignment+'</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+((d.textAlign&&d.textAlign=="left")?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="textAlignValue" value="center" '+((d.textAlign&&d.textAlign=="center")?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="textAlignValue" value="right" '+((d.textAlign&&d.textAlign=="right")?"checked":"")+">"+e.getLang("justifyright")+' </tr><tr><td nowrap colspan="2"><input type="checkbox" name="imageBlockLine" '+(d.imageBlockLine?"checked":"")+">"+f.imageFloat+'</td><td nowrap colspan="2" id="imageBlockLineValue"><input type="radio" name="imageBlockLineValue" value="none" '+((d.imageBlockLine&&d.imageBlockLine=="none")?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="imageBlockLineValue" value="left" '+((d.imageBlockLine&&d.imageBlockLine=="left")?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="imageBlockLineValue" value="center" '+((d.imageBlockLine&&d.imageBlockLine=="center")?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="imageBlockLineValue" value="right" '+((d.imageBlockLine&&d.imageBlockLine=="right")?"checked":"")+">"+e.getLang("justifyright")+'</tr><tr><td nowrap colspan="2"><input type="checkbox" name="clearFontSize" '+(d.clearFontSize?"checked":"")+">"+f.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(d.clearFontFamily?"checked":"")+">"+f.removeFontFamily+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="removeEmptyNode" '+(d.removeEmptyNode?"checked":"")+">"+f.removeHtml+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="pasteFilter" '+(d.pasteFilter?"checked":"")+">"+f.pasteFilter+'</td></tr><tr><td nowrap colspan="4" align="right"><button >'+f.run+"</button></td></tr></table></div></div>"},_UIBase_render:b.prototype.render};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.Popup,e=baidu.editor.ui.AutoTypeSetPicker,a=baidu.editor.ui.SplitButton,f=baidu.editor.ui.AutoTypeSetButton=function(g){this.initOptions(g);this.initAutoTypeSetButton()};function c(s){var h=s.editor.options.autotypeset,w=s.getDom(),q=domUtils.getElementsByTagName(w,"input");for(var m=q.length-1,v;v=q[m--];){if(v.getAttribute("type")=="checkbox"){var t=v.getAttribute("name");h[t]&&delete h[t];if(v.checked){var n=document.getElementById(t+"Value");if(n){if(/input/ig.test(n.tagName)){h[t]=n.value}else{var g=n.getElementsByTagName("input");for(var k=g.length-1,u;u=g[k--];){if(u.checked){h[t]=u.value;break}}}}else{h[t]=true}}}}var r=domUtils.getElementsByTagName(w,"select");for(var m=0,l;l=r[m++];){var o=l.getAttribute("name");h[o]=h[o]?l.value:""}s.editor.options.autotypeset=h}f.prototype={initAutoTypeSetButton:function(){var h=this;this.popup=new d({content:new e({editor:h.editor}),editor:h.editor,hide:function(){if(!this._hidden&&this.getDom()){c(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}}});var g=0;this.popup.addListener("postRenderAfter",function(){var j=this;if(g){return}var i=this.getDom(),k=i.getElementsByTagName("button")[0];k.onclick=function(){c(j);h.editor.execCommand("autotypeset");j.hide()};g=1});this.initSplitButton()}};b.inherits(f,a)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};c.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var f=[];for(var e=0;e<this.items.length;e++){f[e]=this.items[e].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+f.join("")+"</div>"},postRender:function(){var f=this.getDom();for(var e=0;e<this.items.length;e++){this.items[e].postRender()}b.makeUnselectable(f)},_onMouseDown:function(){return false}};a.inherits(c,d)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,a=baidu.editor.ui.Stateful,e=baidu.editor.ui.Menu=function(j){this.initOptions(j);this.initMenu()};var f={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return true}};e.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var j=0;j<this.items.length;j++){var k=this.items[j];if(k=="-"){this.items[j]=this.getSeparator()}else{if(!(k instanceof g)){k.theme=this.editor.options.theme;this.items[j]=this.createItem(k)}}}},getSeparator:function(){return f},createItem:function(j){return new g(j)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0){return this._Popup_getContentHtmlTpl()}var l=[];for(var j=0;j<this.items.length;j++){var k=this.items[j];l[j]=k.renderHtml()}return('<div class="%%-body">'+l.join("")+"</div>")},_Popup_postRender:i.prototype.postRender,postRender:function(){var l=this;for(var j=0;j<this.items.length;j++){var k=this.items[j];k.ownerMenu=this;k.postRender()}d.on(this.getDom(),"mouseover",function(n){n=n||event;var m=n.relatedTarget||n.fromElement;var o=l.getDom();if(!b.contains(o,m)&&o!==m){l.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(k){if(k){if(b.contains(this.getDom(),k)){return false}for(var j=0;j<this.items.length;j++){var l=this.items[j];if(l.queryAutoHide(k)===false){return false}}}},clearItems:function(){for(var j=0;j<this.items.length;j++){var k=this.items[j];clearTimeout(k._showingTimer);clearTimeout(k._closingTimer);if(k.subMenu){k.subMenu.destroy()}}this.items=[]},destroy:function(){if(this.getDom()){d.remove(this.getDom())}this.clearItems()},dispose:function(){this.destroy()}};h.inherits(e,i);var g=baidu.editor.ui.MenuItem=function(j){this.initOptions(j);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof e)){this.subMenu=new e(this.subMenu)}};g.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var j=this;this.addListener("over",function(){j.ownerMenu.fireEvent("submenuover",j);if(j.subMenu){j.delayShowSubMenu()}});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){j.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(j._closingTimer);j._closingTimer=null;j.addState("opened")});this.ownerMenu.addListener("hide",function(){j.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(l,k){if(k!==j){j.delayHideSubMenu()}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(k){if(k&&b.contains(j.getDom(),k)){return false}return this._bakQueryAutoHide(k)}}this.getDom().style.tabIndex="-1";b.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var j=this;if(!j.isDisabled()){j.addState("opened");clearTimeout(j._showingTimer);clearTimeout(j._closingTimer);j._closingTimer=null;j._showingTimer=setTimeout(function(){j.showSubMenu()},250)}},delayHideSubMenu:function(){var j=this;if(!j.isDisabled()){j.removeState("opened");clearTimeout(j._showingTimer);if(!j._closingTimer){j._closingTimer=setTimeout(function(){if(!j.hasState("opened")){j.hideSubMenu()}j._closingTimer=null},400)}}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(j){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(j)}},_onClick:function(j,k){if(this.hasState("disabled")){return}if(this.fireEvent("click",j,k)!==false){if(this.subMenu){this.showSubMenu()}else{i.postHide()}}},showSubMenu:function(){var j=b.getClientRect(this.getDom());j.right-=5;j.left+=2;j.width-=7;j.top-=4;j.bottom+=4;j.height+=8;this.subMenu.showAnchorRect(j,true,true)},hideSubMenu:function(){this.subMenu.hide()}};h.inherits(g,c);h.extend(g.prototype,a,true)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,c=baidu.editor.ui.Combox=function(f){this.initOptions(f);this.initCombox()};c.prototype={uiName:"combox",initCombox:function(){var h=this;this.items=this.items||[];for(var f=0;f<this.items.length;f++){var g=this.items[f];g.uiName="listitem";g.index=f;g.onclick=function(){h.selectByIndex(this.index)}}this.popup=new e({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var f=d.getClientRect(this.getDom());f.top+=1;f.bottom-=1;f.height-=2;this.popup.showAnchorRect(f)},getValue:function(){return this.value},setValue:function(g){var f=this.indexByValue(g);if(f!=-1){this.selectedIndex=f;this.setLabel(this.items[f].label);this.value=this.items[f].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(g));this.value=g}},setLabel:function(f){this.getDom("button_body").innerHTML=f;this.label=f},getLabelForUnknowValue:function(f){return f},indexByValue:function(g){for(var f=0;f<this.items.length;f++){if(g==this.items[f].value){return f}}return -1},getItem:function(f){return this.items[f]},selectByIndex:function(f){if(f<this.items.length&&this.fireEvent("select",f)!==false){this.selectedIndex=f;this.value=this.items[f].value;this.setLabel(this.items[f].label)}}};b.inherits(c,a)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,a=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Mask,b=baidu.editor.ui.UIBase,f=baidu.editor.ui.Button,g=baidu.editor.ui.Dialog=function(j){this.initOptions(h.extend({autoReset:true,draggable:true,onok:function(){},oncancel:function(){},onclose:function(l,k){return k?this.onok():this.oncancel()}},j));this.initDialog()};var c;var i;g.prototype={draggable:false,uiName:"dialog",initDialog:function(){var k=this,l=this.editor.options.theme;this.initUIBase();this.modalMask=(c||(c=new e({className:"edui-dialog-modalmask",theme:l})));this.dragMask=(i||(i=new e({className:"edui-dialog-dragmask",theme:l})));this.closeButton=new f({className:"edui-dialog-closebutton",title:k.closeDialog,theme:l,onclick:function(){k.close(false)}});if(this.buttons){for(var j=0;j<this.buttons.length;j++){if(!(this.buttons[j] instanceof f)){this.buttons[j]=new f(this.buttons[j])}}}},fitSize:function(){var j=this.getDom("body");var k=this.mesureSize();j.style.width=k.width+"px";j.style.height=k.height+"px";return k},safeSetOffset:function(q){var l=this;var j=l.getDom();var o=a.getViewportRect();var k=a.getClientRect(j);var n=q.left;if(n+k.width>o.right){n=o.right-k.width}var m=q.top;if(m+k.height>o.bottom){m=o.bottom-k.height}j.style.left=Math.max(n,0)+"px";j.style.top=Math.max(m,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var o=a.getViewportRect();var j=this.fitSize();var n=this.getDom("titlebar").offsetHeight|0;var m=o.width/2-j.width/2;var l=o.height/2-(j.height-n)/2-n;var k=this.getDom();this.safeSetOffset({left:Math.max(m|0,0),top:Math.max(l|0,0)});if(!d.hasClass(k,"edui-state-centered")){k.className+=" edui-state-centered"}this._show()},getContentHtml:function(){var j="";if(typeof this.content=="string"){j=this.content}else{if(this.iframeUrl){j='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'}}return j},getHtmlTpl:function(){var k="";if(this.buttons){var l=[];for(var j=0;j<this.buttons.length;j++){l[j]=this.buttons[j].renderHtml()}k='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+l.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+k+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var k=this;this.addListener("show",function(){k.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){k.modalMask.hide()});if(this.buttons){for(var j=0;j<this.buttons.length;j++){this.buttons[j].postRender()}}d.on(window,"resize",function(){setTimeout(function(){if(!k.isHidden()){k.safeSetOffset(a.getClientRect(k.getDom()))}})});this._hide()},mesureSize:function(){var j=this.getDom("body");var k=a.getClientRect(this.getDom("content")).width;var l=j.style;l.width=k;return a.getClientRect(j)},_onTitlebarMouseDown:function(j,k){if(this.draggable){var m;var n=a.getViewportRect();var l=this;a.startDrag(j,{ondragstart:function(){m=a.getClientRect(l.getDom());l.getDom("contmask").style.visibility="visible";l.dragMask.show(l.getDom().style.zIndex-1)},ondragmove:function(o,s){var r=m.left+o;var q=m.top+s;l.safeSetOffset({left:r,top:q})},ondragstop:function(){l.getDom("contmask").style.visibility="hidden";d.removeClasses(l.getDom(),["edui-state-centered"]);l.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this.getDom().style.zIndex="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset){try{this.reset()}catch(k){this.render();this.open()}}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus()}catch(j){}}},_onCloseButtonClick:function(j,k){this.close(false)},close:function(j){if(this.fireEvent("close",j)!==false){this._hide()}}};h.inherits(g,b)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,d=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};d.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton";this.popup=new c({items:e.items,className:e.className,editor:e.editor});this.popup.addListener("show",function(){var g=this;for(var f=0;f<g.items.length;f++){g.items[f].removeState("checked");if(g.items[f].value==e._value){g.items[f].addState("checked");this.value=e._value}}});this.initSplitButton()},setValue:function(e){this._value=e}};b.inherits(d,a)})();(function(){var o=baidu.editor.utils;var k=baidu.editor.ui;var e=k.Dialog;k.Dialog=function(i){var l=new e(i);l.addListener("hide",function(){if(l.editor){var v=l.editor;try{if(browser.gecko){var w=v.window.scrollY,r=v.window.scrollX;v.body.focus();v.window.scrollTo(r,w)}else{v.focus()}}catch(u){}}});return l};var f={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",inserttable:"~/dialogs/table/table.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",highlightcode:"~/dialogs/highlightcode/highlightcode.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"};var j=["undo","redo","formatmatch","bold","italic","underline","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable"];for(var g=0,t;t=j[g++];){t=t.toLowerCase();k[t]=function(i){return function(l){var r=new k.Button({className:"edui-for-"+i,title:l.options.labelMap[i]||l.getLang("labelMap."+i)||"",onclick:function(){l.execCommand(i)},theme:l.options.theme,showText:false});l.addListener("selectionchange",function(v,u,x){var w=l.queryCommandState(i);if(w==-1){r.setDisabled(true);r.setChecked(false)}else{if(!x){r.setDisabled(false);r.setChecked(w)}}});return r}}(t)}k.cleardoc=function(i){var l=new k.Button({className:"edui-for-cleardoc",title:i.options.labelMap.cleardoc||i.getLang("labelMap.cleardoc")||"",theme:i.options.theme,onclick:function(){if(confirm(i.getLang("confirmClear"))){i.execCommand("cleardoc")}}});i.addListener("selectionchange",function(){l.setDisabled(i.queryCommandState("cleardoc")==-1)});return l};var n={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var b in n){(function(u,v){for(var r=0,l;l=v[r++];){(function(i){k[u.replace("float","")+i]=function(w){var x=new k.Button({className:"edui-for-"+u.replace("float","")+i,title:w.options.labelMap[u.replace("float","")+i]||w.getLang("labelMap."+u.replace("float","")+i)||"",theme:w.options.theme,onclick:function(){w.execCommand(u,i)}});w.addListener("selectionchange",function(z,y,A){x.setDisabled(w.queryCommandState(u)==-1);x.setChecked(w.queryCommandValue(u)==i&&!A)});return x}})(l)}})(b,n[b])}for(var g=0,t;t=["backcolor","forecolor"][g++];){k[t]=function(i){return function(l){var r=new k.ColorButton({className:"edui-for-"+i,color:"default",title:l.options.labelMap[i]||l.getLang("labelMap."+i)||"",editor:l,onpickcolor:function(v,u){l.execCommand(i,u)},onpicknocolor:function(){l.execCommand(i,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){l.execCommand(i,this.color)}});l.addListener("selectionchange",function(){r.setDisabled(l.queryCommandState(i)==-1)});return r}}(t)}var h={noOk:["searchreplace","help","spechars","webapp"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","highlightcode","insertframe","edittd","scrawl","template","music","background"]};for(var b in h){(function(u,v){for(var r=0,l;l=v[r++];){if(browser.opera&&l==="searchreplace"){continue}(function(i){k[i]=function(y,x,A){x=x||(y.options.iframeUrlMap||{})[i]||f[i];A=y.options.labelMap[i]||y.getLang("labelMap."+i)||"";var w;if(x){w=new k.Dialog(o.extend({iframeUrl:y.ui.mapUrl(x),editor:y,className:"edui-for-"+i,title:A,closeDialog:y.getLang("closeDialog")},u=="ok"?{buttons:[{className:"edui-okbutton",label:y.getLang("ok"),editor:y,onclick:function(){w.close(true)}},{className:"edui-cancelbutton",label:y.getLang("cancel"),editor:y,onclick:function(){w.close(false)}}]}:{}));y.ui._dialogs[i+"Dialog"]=w}var z=new k.Button({className:"edui-for-"+i,title:A,onclick:function(){if(w){switch(i){case"wordimage":y.execCommand("wordimage","word_img");if(y.word_img){w.render();w.open()}break;case"scrawl":if(y.queryCommandState("scrawl")!=-1){w.render();w.open()}break;default:w.render();w.open()}}},theme:y.options.theme,disabled:i=="scrawl"&&y.queryCommandState("scrawl")==-1});y.addListener("selectionchange",function(){var B={edittd:1,edittable:1};if(i in B){return}var C=y.queryCommandState(i);if(z.getDom()){z.setDisabled(C==-1);z.setChecked(C)}});return z}})(l.toLowerCase())}})(b,h[b])}k.snapscreen=function(r,l,v){v=r.options.labelMap.snapscreen||r.getLang("labelMap.snapscreen")||"";var u=new k.Button({className:"edui-for-snapscreen",title:v,onclick:function(){r.execCommand("snapscreen")},theme:r.options.theme,disabled:!browser.ie});if(browser.ie){l=l||(r.options.iframeUrlMap||{})["snapscreen"]||f.snapscreen;if(l){var i=new k.Dialog({iframeUrl:r.ui.mapUrl(l),editor:r,className:"edui-for-snapscreen",title:v,buttons:[{className:"edui-okbutton",label:r.getLang("ok"),editor:r,onclick:function(){i.close(true)}},{className:"edui-cancelbutton",label:r.getLang("cancel"),editor:r,onclick:function(){i.close(false)}}]});i.render();r.ui._dialogs.snapscreenDialog=i}}r.addListener("selectionchange",function(){u.setDisabled(r.queryCommandState("snapscreen")==-1)});return u};k.fontfamily=function(v,x,z){x=v.options.fontfamily||[];z=v.options.labelMap.fontfamily||v.getLang("labelMap.fontfamily")||"";if(!x.length){return}for(var u=0,r,l=[];r=x[u];u++){var y=v.getLang("fontfamily")[r.name]||"";(function(i,A){l.push({label:i,value:A,theme:v.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+o.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(r.label||y,r.val)}var w=new k.Combox({editor:v,items:l,onselect:function(A,i){v.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:z,initValue:z,className:"edui-for-fontfamily",indexByValue:function(C){if(C){for(var B=0,A;A=this.items[B];B++){if(A.value.indexOf(C)!=-1){return B}}}return -1}});v.addListener("selectionchange",function(A,i,D){if(!D){var C=v.queryCommandState("FontFamily");if(C==-1){w.setDisabled(true)}else{w.setDisabled(false);var B=v.queryCommandValue("FontFamily");B&&(B=B.replace(/['"]/g,"").split(",")[0]);w.setValue(B)}}});return w};k.fontsize=function(v,x,y){y=v.options.labelMap.fontsize||v.getLang("labelMap.fontsize")||"";x=x||v.options.fontsize||[];if(!x.length){return}var l=[];for(var u=0;u<x.length;u++){var r=x[u]+"px";l.push({label:r,value:r,theme:v.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var w=new k.Combox({editor:v,items:l,title:y,initValue:y,onselect:function(z,i){v.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});v.addListener("selectionchange",function(z,i,B){if(!B){var A=v.queryCommandState("FontSize");if(A==-1){w.setDisabled(true)}else{w.setDisabled(false);w.setValue(v.queryCommandValue("FontSize"))}}});return w};k.paragraph=function(u,w,x){x=u.options.labelMap.paragraph||u.getLang("labelMap.paragraph")||"";w=u.options.paragraph||[];if(o.isEmptyObject(w)){return}var l=[];for(var r in w){l.push({value:r,label:w[r]||u.getLang("paragraph")[r],theme:u.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var v=new k.Combox({editor:u,items:l,title:x,initValue:x,className:"edui-for-paragraph",onselect:function(y,i){u.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}});u.addListener("selectionchange",function(z,y,C){if(!C){var B=u.queryCommandState("Paragraph");if(B==-1){v.setDisabled(true)}else{v.setDisabled(false);var A=u.queryCommandValue("Paragraph");var i=v.indexByValue(A);if(i!=-1){v.setValue(A)}else{v.setValue(v.initValue)}}}});return v};k.customstyle=function(w){var y=w.options.customstyle||[],z=w.options.labelMap.customstyle||w.getLang("labelMap.customstyle")||"";if(!y.length){return}var v=w.getLang("customstyle");for(var u=0,l=[],r;r=y[u++];){(function(A){var i={};i.label=A.label?A.label:v[A.name];i.style=A.style;i.className=A.className;i.tag=A.tag;l.push({label:i.label,value:i,theme:w.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+i.tag+" "+(i.className?' class="'+i.className+'"':"")+(i.style?' style="'+i.style+'"':"")+">"+i.label+"</"+i.tag+"></div>"}})})(r)}var x=new k.Combox({editor:w,items:l,title:z,initValue:z,className:"edui-for-customstyle",onselect:function(A,i){w.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(C){for(var A=0,B;B=this.items[A++];){if(B.label==C){return A-1}}return -1}});w.addListener("selectionchange",function(B,A,E){if(!E){var D=w.queryCommandState("customstyle");if(D==-1){x.setDisabled(true)}else{x.setDisabled(false);var C=w.queryCommandValue("customstyle");var i=x.indexByValue(C);if(i!=-1){x.setValue(C)}else{x.setValue(x.initValue)}}}});return x};k.inserttable=function(u,r,w){r=r||(u.options.iframeUrlMap||{})["inserttable"]||f.inserttable;w=u.options.labelMap.inserttable||u.getLang("labelMap.inserttable")||"";if(r){var l=new k.Dialog({iframeUrl:u.ui.mapUrl(r),editor:u,className:"edui-for-inserttable",title:w,buttons:[{className:"edui-okbutton",label:u.getLang("ok"),editor:u,onclick:function(){l.close(true)}},{className:"edui-cancelbutton",label:u.getLang("cancel"),editor:u,onclick:function(){l.close(false)}}]});l.render();u.ui._dialogs.inserttableDialog=l}var i=function(){if(l){if(browser.webkit){l.open();l.close()}l.open()}};var v=new k.TableButton({editor:u,title:w,className:"edui-for-inserttable",onpicktable:function(x,z,y){u.execCommand("InsertTable",{numRows:y,numCols:z,border:1})},onmore:i,onbuttonclick:i});u.addListener("selectionchange",function(){v.setDisabled(u.queryCommandState("inserttable")==-1)});return v};k.lineheight=function(v){var x=v.options.lineheight||[];if(!x.length){return}for(var u=0,r,l=[];r=x[u++];){l.push({label:r,value:r,theme:v.options.theme,onclick:function(){v.execCommand("lineheight",this.value)}})}var w=new k.MenuButton({editor:v,className:"edui-for-lineheight",title:v.options.labelMap.lineheight||v.getLang("labelMap.lineheight")||"",items:l,onbuttonclick:function(){var i=v.queryCommandValue("LineHeight")||this.value;v.execCommand("LineHeight",i)}});v.addListener("selectionchange",function(){var y=v.queryCommandState("LineHeight");if(y==-1){w.setDisabled(true)}else{w.setDisabled(false);var i=v.queryCommandValue("LineHeight");i&&w.setValue((i+"").replace(/cm/,""));w.setChecked(y)}});return w};var c=["top","bottom"];for(var a=0,m;m=c[a++];){(function(i){k["rowspacing"+i]=function(v){var x=v.options["rowspacing"+i]||[];if(!x.length){return null}for(var u=0,r,l=[];r=x[u++];){l.push({label:r,value:r,theme:v.options.theme,onclick:function(){v.execCommand("rowspacing",this.value,i)}})}var w=new k.MenuButton({editor:v,className:"edui-for-rowspacing"+i,title:v.options.labelMap["rowspacing"+i]||v.getLang("labelMap.rowspacing"+i)||"",items:l,onbuttonclick:function(){var y=v.queryCommandValue("rowspacing",i)||this.value;v.execCommand("rowspacing",y,i)}});v.addListener("selectionchange",function(){var z=v.queryCommandState("rowspacing",i);if(z==-1){w.setDisabled(true)}else{w.setDisabled(false);var y=v.queryCommandValue("rowspacing",i);y&&w.setValue((y+"").replace(/%/,""));w.setChecked(z)}});return w}})(m)}var s=["insertorderedlist","insertunorderedlist"];for(var d=0,q;q=s[d++];){(function(i){k[i]=function(u){var w=u.options[i],x=function(){u.execCommand(i,this.value)},l=[];for(var r in w){l.push({label:w[r]||u.getLang()[i][r]||"",value:r,theme:u.options.theme,onclick:x})}var v=new k.MenuButton({editor:u,className:"edui-for-"+i,title:u.getLang("labelMap."+i)||"",items:l,onbuttonclick:function(){var y=u.queryCommandValue(i)||this.value;u.execCommand(i,y)}});u.addListener("selectionchange",function(){var z=u.queryCommandState(i);if(z==-1){v.setDisabled(true)}else{v.setDisabled(false);var y=u.queryCommandValue(i);v.setValue(y);v.setChecked(z)}});return v}})(q)}k.fullscreen=function(i,r){r=i.options.labelMap.fullscreen||i.getLang("labelMap.fullscreen")||"";var l=new k.Button({className:"edui-for-fullscreen",title:r,theme:i.options.theme,onclick:function(){var u=i.ui.getDom("scale");if(i.ui){i.ui.setFullScreen(!i.ui.isFullScreen())}this.setChecked(i.ui.isFullScreen())}});i.addListener("selectionchange",function(){var u=i.queryCommandState("fullscreen");l.setDisabled(u==-1);l.setChecked(i.ui.isFullScreen())});return l};k.emotion=function(l,i){var r=new k.MultiMenuPop({title:l.options.labelMap.emotion||l.getLang("labelMap.emotion")||"",editor:l,className:"edui-for-emotion",iframeUrl:l.ui.mapUrl(i||(l.options.iframeUrlMap||{})["emotion"]||f.emotion)});l.addListener("selectionchange",function(){r.setDisabled(l.queryCommandState("emotion")==-1)});return r};k.autotypeset=function(i){var l=new k.AutoTypeSetButton({editor:i,title:i.options.labelMap.autotypeset||i.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){i.execCommand("autotypeset")}});i.addListener("selectionchange",function(){l.setDisabled(i.queryCommandState("autotypeset")==-1)});return l}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,f=baidu.editor.ui.UIBase,a=baidu.editor.dom.domUtils;var e=[];function c(h){this.initOptions(h);this.initEditorUI()}c.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var i=this.editor,j=this;i.addListener("ready",function(){i.getDialog=function(k){return i.ui._dialogs[k+"Dialog"]};a.on(i.window,"scroll",function(){baidu.editor.ui.Popup.postHide()});if(i.options.elementPathEnabled){i.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+i.getLang("elementPathTip")+":</div>"}if(i.options.wordCount){i.ui.getDom("wordcount").innerHTML=i.getLang("wordCountTip");i.addListener("keyup",function(l,k){var m=k.keyCode||k.which;if(m==32){j._wordCount()}})}i.ui._scale();if(i.options.scaleEnabled){if(i.autoHeightEnabled){i.disableAutoHeight()}j.enableScale()}else{j.disableScale()}if(!i.options.elementPathEnabled&&!i.options.wordCount&&!i.options.scaleEnabled){i.ui.getDom("elementpath").style.display="none";i.ui.getDom("wordcount").style.display="none";i.ui.getDom("scale").style.display="none"}if(!i.selection.isFocus()){return}i.fireEvent("selectionchange",false,true)});i.addListener("mousedown",function(l,k){var m=k.target||k.srcElement;baidu.editor.ui.Popup.postHide(m)});i.addListener("contextmenu",function(l,k){baidu.editor.ui.Popup.postHide()});i.addListener("selectionchange",function(){if(i.options.elementPathEnabled){j[(i.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]()}if(i.options.wordCount){j[(i.queryCommandState("wordcount")==-1?"dis":"en")+"ableWordCount"]()}if(i.options.scaleEnabled){j[(i.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()}});var h=new baidu.editor.ui.Popup({editor:i,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();i.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(k){this.hide();i.ui._dialogs[k]&&i.ui._dialogs[k].open()},_onImgSetFloat:function(k){this.hide();i.execCommand("imagefloat",k)},_setIframeAlign:function(k){var l=h.anchorEl;var m=l.cloneNode(true);switch(k){case -2:m.setAttribute("align","");break;case -1:m.setAttribute("align","left");break;case 1:m.setAttribute("align","right");break;case 2:m.setAttribute("align","middle");break}l.parentNode.insertBefore(m,l);a.remove(l);h.anchorEl=m;h.showAnchor(h.anchorEl)},_updateIframe:function(){i._iframe=h.anchorEl;i.ui._dialogs.insertframeDialog.open();h.hide()},_onRemoveButtonClick:function(k){i.execCommand(k);this.hide()},queryAutoHide:function(k){if(k&&k.ownerDocument==i.document){if(k.tagName.toLowerCase()=="img"||a.findParentByTagName(k,"a",true)){return k!==h.anchorEl}}return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,k)}});h.render();if(i.options.imagePopup){i.addListener("mouseover",function(m,k){k=k||window.event;var n=k.target||k.srcElement;if(i.ui._dialogs.insertframeDialog&&/iframe/ig.test(n.tagName)){var l=h.formatHtml("<nobr>"+i.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+i.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+i.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+i.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable">'+i.getLang("justifycenter")+'</span> <span onclick="$$._updateIframe( this);" class="edui-clickable">'+i.getLang("modify")+"</span></nobr>");if(l){h.getDom("content").innerHTML=l;h.anchorEl=n;h.showAnchor(h.anchorEl)}else{h.hide()}}});i.addListener("selectionchange",function(u,n){if(!n){return}var r="",q=i.selection.getRange().getClosedNode(),k=i.ui._dialogs;if(q&&q.tagName=="IMG"){var m="insertimageDialog";if(q.className.indexOf("edui-faked-video")!=-1){m="insertvideoDialog"}if(q.className.indexOf("edui-faked-webapp")!=-1){m="webappDialog"}if(q.src.indexOf("http://api.map.baidu.com")!=-1){m="mapDialog"}if(q.className.indexOf("edui-faked-music")!=-1){m="musicDialog"}if(q.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){m="gmapDialog"}if(q.getAttribute("anchorname")){m="anchorDialog";r=h.formatHtml("<nobr>"+i.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+i.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+i.getLang("delete")+"</span></nobr>")}if(q.getAttribute("word_img")){i.word_img=[q.getAttribute("word_img")];m="wordimageDialog"}if(!k[m]){return}!r&&(r=h.formatHtml("<nobr>"+i.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+i.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+i.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+i.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+i.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+m+'\');" class="edui-clickable">'+i.getLang("modify")+"</span></nobr>"))}if(i.ui._dialogs.linkDialog){var s=i.queryCommandValue("link");var l;if(s&&(l=(s.getAttribute("data_ue_src")||s.getAttribute("href",2)))){var o=l;if(l.length>30){o=l.substring(0,20)+"..."}if(r){r+='<div style="height:5px;"></div>'}r+=h.formatHtml("<nobr>"+i.getLang("anthorMsg")+': <a target="_blank" href="'+l+'" title="'+l+'" >'+o+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+i.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+i.getLang("clear")+"</span></nobr>");h.showAnchor(s)}}if(r){h.getDom("content").innerHTML=r;h.anchorEl=q||s;h.showAnchor(h.anchorEl)}else{h.hide()}})}},_initToolbars:function(){var q=this.editor;var s=this.toolbars||[];var l=[];for(var o=0;o<s.length;o++){var r=s[o];var m=new baidu.editor.ui.Toolbar({theme:q.options.theme});for(var n=0;n<r.length;n++){var h=r[n];var k=null;if(typeof h=="string"){h=h.toLowerCase();if(h=="|"){h="Separator"}if(baidu.editor.ui[h]){k=new baidu.editor.ui[h](q)}if(h=="fullscreen"){if(l&&l[0]){l[0].items.splice(0,0,k)}else{k&&m.items.splice(0,0,k)}continue}}else{k=h}if(k&&k.id){m.add(k)}}l[o]=m}this.toolbars=l},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){var j=[];for(var h=0;h<this.toolbars.length;h++){j.push(this.toolbars[h].renderHtml())}return j.join("")},setFullScreen:function(m){var l=this.editor,j=l.container.parentNode.parentNode;if(this._fullscreen!=m){this._fullscreen=m;this.editor.fireEvent("beforefullscreenchange",m);if(baidu.editor.browser.gecko){var i=l.selection.getRange().createBookmark()}if(m){while(j.tagName!="BODY"){var h=baidu.editor.dom.domUtils.getComputedStyle(j,"position");e.push(h);j.style.position="static";j=j.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){l.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen()}else{while(j.tagName!="BODY"){j.style.position=e.shift();j=j.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){l.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop)}if(baidu.editor.browser.gecko){var k=document.createElement("input");document.body.appendChild(k);l.body.contentEditable=false;setTimeout(function(){k.focus();setTimeout(function(){l.body.contentEditable=true;l.selection.getRange().moveToBookmark(i).select(true);baidu.editor.dom.domUtils.remove(k);m&&window.scroll(0,0)},0)},0)}this.editor.fireEvent("fullscreenchanged",m);this.triggerLayout()}},_wordCount:function(){var h=this.getDom("wordcount");if(!this.editor.options.wordCount){h.style.display="none";return}h.innerHTML=this.editor.queryCommandValue("wordcount")},disableWordCount:function(){var h=this.getDom("wordcount");h.innerHTML="";h.style.display="none";this.wordcount=false},enableWordCount:function(){var h=this.getDom("wordcount");h.style.display="";this.wordcount=true;this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var h=d.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+h.width+"px;height:"+h.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);d.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(h.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0))}},_updateElementPath:function(){var h=this.getDom("elementpath"),l;if(this.elementPathEnabled&&(l=this.editor.queryCommandValue("elementpath"))){var m=[];for(var k=0,j;j=l[k];k++){m[k]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+k+'&quot;);">'+j+"</span>")}h.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+m.join(" &gt; ")+"</div>"}else{h.style.display="none"}},disableElementPath:function(){var h=this.getDom("elementpath");h.innerHTML="";h.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){var h=this.getDom("elementpath");h.style.display="";this.elementPathEnabled=true;this._updateElementPath()},_scale:function(){var C=document,l=this.editor,A=l.container,j=l.document,n=this.getDom("toolbarbox"),o=this.getDom("bottombar"),B=this.getDom("scale"),y=this.getDom("scalelayer");var s=false,z=null,m=0,w=l.options.minFrameWidth,i=0,h=0,v=0,k=0;function r(){z=a.getXY(A);if(!m){m=l.options.minFrameHeight+n.offsetHeight+o.offsetHeight}y.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+A.offsetWidth+"px;height:"+A.offsetHeight+"px;z-index:"+(l.options.zIndex+1);a.on(C,"mousemove",t);a.on(j,"mouseup",q);a.on(C,"mouseup",q)}var x=this;this.editor.addListener("fullscreenchanged",function(F,D){if(D){x.disableScale()}else{if(x.editor.options.scaleEnabled){x.enableScale();var E=x.editor.document.createElement("span");x.editor.body.appendChild(E);x.editor.body.style.height=Math.max(a.getXY(E).y,x.editor.iframe.offsetHeight-20)+"px";a.remove(E)}}});function t(D){u();var E=D||window.event;i=E.pageX||(C.documentElement.scrollLeft+E.clientX);h=E.pageY||(C.documentElement.scrollTop+E.clientY);v=i-z.x;k=h-z.y;if(v>=w){s=true;y.style.width=v+"px"}if(k>=m){s=true;y.style.height=k+"px"}}function q(){if(s){s=false;A.style.width=y.offsetWidth-2+"px";l.setHeight(y.offsetHeight-o.offsetHeight-n.offsetHeight-2)}if(y){y.style.display="none"}u();a.un(C,"mousemove",t);a.un(j,"mouseup",q);a.un(C,"mouseup",q)}function u(){if(browser.ie){C.selection.clear()}else{window.getSelection().removeAllRanges()}}this.enableScale=function(){if(l.queryCommandState("source")==1){return}B.style.display="";this.scaleEnabled=true;a.on(B,"mousedown",r)};this.disableScale=function(){B.style.display="none";this.scaleEnabled=false;a.un(B,"mousedown",r)}},isFullScreen:function(){return this._fullscreen},postRender:function(){f.prototype.postRender.call(this);for(var k=0;k<this.toolbars.length;k++){this.toolbars[k].postRender()}var l=this;var j,h=baidu.editor.dom.domUtils,m=function(){clearTimeout(j);j=setTimeout(function(){l._updateFullScreen()})};h.on(window,"resize",m);l.addListener("destroy",function(){h.un(window,"resize",m);clearTimeout(j)})},showToolbarMsg:function(j,i){this.getDom("toolbarmsg_label").innerHTML=j;this.getDom("toolbarmsg").style.display="";if(!i){var h=this.getDom("upload_dialog");h.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(h){return h?h.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var h=this.getDom();if(h.style.zoom=="1"){h.style.zoom="100%"}else{h.style.zoom="1"}}};b.inherits(c,baidu.editor.ui.UIBase);var g={};UE.ui.Editor=function(h){var j=new baidu.editor.Editor(h);j.options.editor=j;b.loadFile(document,{href:j.options.themePath+j.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var i=j.render;j.render=function(k){if(k.constructor===String){j.key=k;g[k]=j}b.domReady(function(){j.langIsReady?l():j.addListener("langReady",l);function l(){j.setOpt({labelMap:j.options.labelMap||j.getLang("labelMap")});new c(j.options);if(k){if(k.constructor===String){k=document.getElementById(k)}k&&k.getAttribute("name")&&(j.options.textarea=k.getAttribute("name"));if(k&&/script|textarea/ig.test(k.tagName)){var o=document.createElement("div");k.parentNode.insertBefore(o,k);var m=k.value||k.innerHTML;j.options.initialContent=/^[\t\r\n ]*$/.test(m)?j.options.initialContent:m.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");k.className&&(o.className=k.className);k.style.cssText&&(o.style.cssText=k.style.cssText);if(/textarea/i.test(k.tagName)){j.textarea=k;j.textarea.style.display="none"}else{k.parentNode.removeChild(k);k.id&&(o.id=k.id)}k=o;k.innerHTML=""}}a.addClass(k,"edui-"+j.options.theme);j.ui.render(k);var n=j.ui.getDom("iframeholder");j.container=j.ui.getDom();j.container.style.cssText="z-index:"+j.options.zIndex+";width:"+j.options.initialFrameWidth+"px";i.call(j,n)}})};return j};UE.getEditor=function(j,h){var i=g[j];if(!i){i=g[j]=new UE.ui.Editor(h);i.render(j)}return i};UE.delEditor=function(i){var h;if(h=g[i]){h.key&&h.destroy();delete g[i]}}})();(function(){var c=baidu.editor.utils,d=baidu.editor.ui.Popup,b=baidu.editor.ui.SplitButton,a=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e);this.initMultiMenu()};a.prototype={initMultiMenu:function(){var e=this;this.popup=new d({content:"",editor:e.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>';e.editor.container.style.zIndex&&(this.getDom().style.zIndex=e.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};c.inherits(a,b)})();UE.plugins.highlightcode=function(){var b=this;if(!/highlightcode/i.test(b.options.toolbars.join(""))){return}b.commands.highlightcode={execCommand:function(m,g,i){if(g&&i){var h=document.createElement("pre");h.className="brush: "+i+";toolbar:false;";h.style.display="";h.appendChild(document.createTextNode(g));document.body.appendChild(h);if(b.queryCommandState("highlightcode")){b.execCommand("highlightcode")}b.execCommand("inserthtml",SyntaxHighlighter.highlight(h,null,true),true);var d=b.document.getElementById(SyntaxHighlighter.getHighlighterDivId());d.setAttribute("highlighter",h.className);domUtils.remove(h);c()}else{var k=this.selection.getRange(),f=domUtils.findParentByTagName(k.startContainer,"table",true),j=domUtils.findParentByTagName(k.endContainer,"table",true),l;if(f&&j&&f===j&&f.parentNode.className.indexOf("syntaxhighlighter")>-1){l=f.parentNode;if(domUtils.isBody(l.parentNode)&&!l.nextSibling){var e=b.document.createElement("p");e.innerHTML=browser.ie?"":"<br/>";b.body.insertBefore(e,l);k.setStart(e,0)}else{k.setStartBefore(l)}k.setCursor();domUtils.remove(l)}}},queryCommandState:function(){var e=this.selection.getRange(),f,d;e.adjustmentBoundary();f=domUtils.findParent(e.startContainer,function(g){return g.nodeType==1&&g.tagName=="DIV"&&domUtils.hasClass(g,"syntaxhighlighter")},true);d=domUtils.findParent(e.endContainer,function(g){return g.nodeType==1&&g.tagName=="DIV"&&domUtils.hasClass(g,"syntaxhighlighter")},true);return f&&d&&f==d?1:0}};b.addListener("beforeselectionchange afterselectionchange",function(d){b.highlight=/^b/.test(d)?b.queryCommandState("highlightcode"):0});b.addListener("ready",function(){if(typeof XRegExp=="undefined"){utils.loadFile(document,{id:"syntaxhighlighter_js",src:b.options.highlightJsUrl||b.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js",tag:"script",type:"text/javascript",defer:"defer"},function(){a()})}if(!b.document.getElementById("syntaxhighlighter_css")){utils.loadFile(b.document,{id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:b.options.highlightCssUrl||b.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css"})}});b.addListener("beforegetcontent",function(){for(var f=0,h,g=domUtils.getElementsByTagName(b.body,"div");h=g[f++];){if(h.className=="container"){var d=h.parentNode;while(d){if(d.tagName=="DIV"&&/highlighter/.test(d.id)){break}d=d.parentNode}if(!d){return}var j=b.document.createElement("pre");for(var k=[],l=0,e;e=h.childNodes[l++];){k.push(e[browser.ie?"innerText":"textContent"])}j.appendChild(b.document.createTextNode(k.join("\n")));j.className=d.getAttribute("highlighter");d.parentNode.insertBefore(j,d);domUtils.remove(d)}}});b.addListener("aftergetcontent aftersetcontent",a);function c(){setTimeout(function(){var h=b.document.getElementById(SyntaxHighlighter.getHighlighterDivId());if(h){var g=h.getElementsByTagName("td");for(var f=0,d,e;d=g[0].childNodes[f];f++){e=g[1].firstChild.childNodes[f];if(e){e.style.height=d.style.height=e.offsetHeight+"px"}}}})}function a(){for(var f=0,l,j=domUtils.getElementsByTagName(b.document,"pre");l=j[f++];){if(l.className.indexOf("brush")>-1){var h=document.createElement("pre"),d,k;h.className=l.className;h.style.display="none";h.appendChild(document.createTextNode(l[browser.ie?"innerText":"textContent"]));document.body.appendChild(h);try{d=SyntaxHighlighter.highlight(h,null,true)}catch(g){domUtils.remove(h);return}k=b.document.createElement("div");k.innerHTML=d;k.firstChild.setAttribute("highlighter",h.className);l.parentNode.insertBefore(k.firstChild,l);domUtils.remove(h);domUtils.remove(l);c()}}}b.addListener("getAllHtml",function(k,g){var d="";for(var f=0,e,j=domUtils.getElementsByTagName(b.document,"div");e=j[f++];){if(domUtils.hasClass(e,"syntaxhighlighter")){if(!b.document.getElementById("syntaxhighlighter_css")){d='<link id="syntaxhighlighter_css" rel="stylesheet" type="text/css" href="'+(b.options.highlightCssUrl||b.options.UEDITOR_HOME_URL+'third-party/SyntaxHighlighter/shCoreDefault.css"')+" ></link>"}if(!b.window.XRegExp){d+='<script id="syntaxhighlighter_js"  type="text/javascript" src="'+(b.options.highlightJsUrl||b.options.UEDITOR_HOME_URL+'third-party/SyntaxHighlighter/shCore.js"')+' ><\/script><script type="text/javascript">window.onload = function(){SyntaxHighlighter.highlight();setTimeout(function(){for(var i=0,di;di=SyntaxHighlighter.highlightContainers[i++];){var tds = di.getElementsByTagName("td");for(var j=0,li,ri;li=tds[0].childNodes[j];j++){ri = tds[1].firstChild.childNodes[j];ri.style.height = li.style.height = ri.offsetHeight + "px";}}},100)}<\/script>'}break}}if(!d){var h;if(h=b.document.getElementById("syntaxhighlighter_css")){domUtils.remove(h)}if(h=b.document.getElementById("syntaxhighlighter_js")){domUtils.remove(h)}}g.html+=d});b.addListener("fullscreenchanged",function(){var l=domUtils.getElementsByTagName(b.document,"div");for(var f=0,k;k=l[f++];){if(/^highlighter/.test(k.id)){var h=k.getElementsByTagName("td");for(var g=0,d,e;d=h[0].childNodes[g];g++){e=h[1].firstChild.childNodes[g];e.style.height=d.style.height=e.offsetHeight+"px"}}}})};(function(){function c(f){f=f||{};this.indentChar=f.indentChar||"    ";this.breakChar=f.breakChar||"\n";this.selfClosingEnd=f.selfClosingEnd||" />"}var e=function(){var g={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function f(h){return g[h]}return function(h){h=h+"";return h?h.replace(/[<>"']/g,f):""}}();var d=utils.extend({a:1,A:1},dtd.$inline,true);function b(g){var h=[];for(var f in g){h.push(f+'="'+e(g[f])+'"')}return h.join(" ")}c.prototype={format:function(f){var g=UE.serialize.parseHTML(f);this.buff=[];this.indents="";this.indenting=1;this.visitNode(g);return this.buff.join("")},visitNode:function(g){if(g.type=="fragment"){this.visitChildren(g.children)}else{if(g.type=="element"){var f=dtd.$empty[g.tag];this.visitTag(g.tag,g.attributes,f);this.visitChildren(g.children);if(!f){this.visitEndTag(g.tag)}}else{if(g.type=="comment"){this.visitComment(g.data)}else{this.visitText(g.data,dtd.$notTransContent[g.parent.tag])}}}},visitChildren:function(g){for(var f=0;f<g.length;f++){this.visitNode(g[f])}},visitTag:function(f,h,g){if(this.indenting){this.indent()}else{if(!d[f]){this.newline();this.indent()}}this.buff.push("<",f);var i=b(h);if(i){this.buff.push(" ",i)}if(g){this.buff.push(this.selfClosingEnd);if(f=="br"){this.newline()}}else{this.buff.push(">");this.indents+=this.indentChar}if(!d[f]){this.newline()}},indent:function(){this.buff.push(this.indents);this.indenting=0},newline:function(){this.buff.push(this.breakChar);this.indenting=1},visitEndTag:function(f){this.indents=this.indents.slice(0,-this.indentChar.length);if(this.indenting){this.indent()}else{if(!d[f]){this.newline();this.indent()}}this.buff.push("</",f,">")},visitText:function(g,f){if(this.indenting){this.indent()}g=g.replace(/&nbsp;/g," ");this.buff.push(g)},visitComment:function(f){if(this.indenting){this.indent()}this.buff.push("<!--",f,"-->")}};var a={textarea:function(h,g){var f=g.ownerDocument.createElement("textarea");f.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(browser.ie&&browser.version<8){f.style.width=g.offsetWidth+"px";f.style.height=g.offsetHeight+"px";g.onresize=function(){f.style.width=g.offsetWidth+"px";f.style.height=g.offsetHeight+"px"}}g.appendChild(f);return{setContent:function(i){f.value=i},getContent:function(){return f.value},select:function(){var i;if(browser.ie){i=f.createTextRange();i.collapse(true);i.select()}else{f.setSelectionRange(0,0);f.focus()}},dispose:function(){g.removeChild(f);g.onresize=null;f=null;g=null}}},codemirror:function(h,g){var f=window.CodeMirror(g,{mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true});var i=f.getWrapperElement();i.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';f.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";f.refresh();return{getCodeMirror:function(){return f},setContent:function(j){f.setValue(j)},getContent:function(){return f.getValue()},select:function(){f.focus()},dispose:function(){g.removeChild(i);i=null;f=null}}}};UE.plugins.source=function(){var j=this;var f=this.options;var l=new c(f.source);var i=false;var m;f.sourceEditor=browser.ie&&browser.version<8?"textarea":(f.sourceEditor||"codemirror");j.setOpt({sourceEditorFirst:false});function g(o){return a[f.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](j,o)}var n;var k=j.getContent;j.commands.source={execCommand:function(){i=!i;if(i){j.undoManger&&j.undoManger.save();this.currentSelectedArr&&domUtils.clearSelectedArr(this.currentSelectedArr);if(browser.gecko){j.body.contentEditable=false}n=j.iframe.style.cssText;j.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var q=l.format(j.hasContents()?j.getContent():"");m=g(j.iframe.parentNode);m.setContent(q);setTimeout(function(){m.select();j.addListener("fullscreenchanged",function(){try{m.getCodeMirror().refresh()}catch(r){}})});j.getContent=function(){var r=m.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";r=r.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");j.setContent(r,true);return k.apply(this)}}else{j.iframe.style.cssText=n;var o=m.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";o=o.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");j.setContent(o);m.dispose();m=null;j.getContent=k;setTimeout(function(){var t=j.body.firstChild;if(!t){j.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";t=j.body.firstChild}j.undoManger&&j.undoManger.save(true);while(t&&t.firstChild){t=t.firstChild}var s=j.selection.getRange();if(t.nodeType==3||dtd.$empty[t.tagName]){s.setStartBefore(t)}else{s.setStart(t,0)}if(browser.gecko){var r=document.createElement("input");r.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(r);j.body.contentEditable=false;setTimeout(function(){domUtils.setViewportOffset(r,{left:-32768,top:0});r.focus();setTimeout(function(){j.body.contentEditable=true;s.setCursor(false,true);domUtils.remove(r)})})}else{s.setCursor(false,true)}})}this.fireEvent("sourcemodechanged",i)},queryCommandState:function(){return i|0},notNeedUndo:1};var h=j.queryCommandState;j.queryCommandState=function(o){o=o.toLowerCase();if(i){return o in {source:1,fullscreen:1}?1:-1}return h.apply(this,arguments)};if(f.sourceEditor=="codemirror"){j.addListener("ready",function(){utils.loadFile(document,{src:f.codeMirrorJsUrl||f.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){if(f.sourceEditorFirst){setTimeout(function(){j.execCommand("source")},0)}});utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:f.codeMirrorCssUrl||f.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}}})();UE.plugins.basestyle=function(){var d={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},c=function(f,e){return domUtils.filterNodeList(f.selection.getStartElementPath(),e)},b=this;for(var a in d){(function(f,e){b.commands[f]={execCommand:function(h){var g=new dom.Range(b.document),n="";if(b.currentSelectedArr&&b.currentSelectedArr.length>0){for(var k=0,j;j=b.currentSelectedArr[k++];){if(j.style.display!="none"){g.selectNodeContents(j).select();!n&&(n=c(this,e));if(h=="superscript"||h=="subscript"){if(!n||n.tagName.toLowerCase()!=h){g.removeInlineStyle(["sub","sup"])}}n?g.removeInlineStyle(e):g.applyInlineStyle(e[0])}}g.selectNodeContents(b.currentSelectedArr[0]).select()}else{g=b.selection.getRange();n=c(this,e);if(g.collapsed){if(n){var m=b.document.createTextNode("");g.insertNode(m).removeInlineStyle(e);g.setStartBefore(m);domUtils.remove(m)}else{var l=g.document.createElement(e[0]);if(h=="superscript"||h=="subscript"){m=b.document.createTextNode("");g.insertNode(m).removeInlineStyle(["sub","sup"]).setStartBefore(m).collapse(true)}g.insertNode(l).setStart(l,0)}g.collapse(true)}else{if(h=="superscript"||h=="subscript"){if(!n||n.tagName.toLowerCase()!=h){g.removeInlineStyle(["sub","sup"])}}n?g.removeInlineStyle(e):g.applyInlineStyle(e[0])}g.select()}return true},queryCommandState:function(){if(this.highlight){return -1}return c(this,e)?1:0}}})(a,d[a])}};UE.plugins.removeformat=function(){var a=this;a.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});a.commands.removeformat={execCommand:function(o,s,b,m,n){var h=new RegExp("^(?:"+(s||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=b?[]:(m||this.options.removeFormatAttributes).split(","),j=new dom.Range(this.document),k,e,l,c=function(i){return i.nodeType==1};function d(w){if(w.nodeType==3||w.tagName.toLowerCase()!="span"){return 0}if(browser.ie){var u=w.attributes;if(u.length){for(var v=0,t=u.length;v<t;v++){if(u[v].specified){return 0}}return 1}}return !w.attributes.length}function q(y){var i=y.createBookmark();if(y.collapsed){y.enlarge(true)}if(!n){var t=domUtils.findParentByTagName(y.startContainer,"a",true);if(t){y.setStartBefore(t)}t=domUtils.findParentByTagName(y.endContainer,"a",true);if(t){y.setEndAfter(t)}}k=y.createBookmark();u=k.start;while((l=u.parentNode)&&!domUtils.isBlockElm(l)){domUtils.breakParent(u,l);domUtils.clearEmptySibling(u)}if(k.end){u=k.end;while((l=u.parentNode)&&!domUtils.isBlockElm(l)){domUtils.breakParent(u,l);domUtils.clearEmptySibling(u)}var z=domUtils.getNextDomNode(k.start,false,c),x;while(z){if(z==k.end){break}x=domUtils.getNextDomNode(z,true,c);if(!dtd.$empty[z.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(z)){if(h.test(z.tagName)){if(b){domUtils.removeStyle(z,b);if(d(z)&&b!="text-decoration"){domUtils.remove(z,true)}}else{domUtils.remove(z,true)}}else{if(!dtd.$tableContent[z.tagName]&&!dtd.$list[z.tagName]){domUtils.removeAttributes(z,f);if(d(z)){domUtils.remove(z,true)}}}}z=x}}var A=k.start.parentNode;if(domUtils.isBlockElm(A)&&!dtd.$tableContent[A.tagName]&&!dtd.$list[A.tagName]){domUtils.removeAttributes(A,f)}A=k.end.parentNode;if(k.end&&domUtils.isBlockElm(A)&&!dtd.$tableContent[A.tagName]&&!dtd.$list[A.tagName]){domUtils.removeAttributes(A,f)}y.moveToBookmark(k).moveToBookmark(i);var u=y.startContainer,w,v=y.collapsed;while(u.nodeType==1&&domUtils.isEmptyNode(u)&&dtd.$removeEmpty[u.tagName]){w=u.parentNode;y.setStartBefore(u);if(y.startContainer===y.endContainer){y.endOffset--}domUtils.remove(u);u=w}if(!v){u=y.endContainer;while(u.nodeType==1&&domUtils.isEmptyNode(u)&&dtd.$removeEmpty[u.tagName]){w=u.parentNode;y.setEndBefore(u);domUtils.remove(u);u=w}}}if(this.currentSelectedArr&&this.currentSelectedArr.length){for(var g=0,r;r=this.currentSelectedArr[g++];){j.selectNodeContents(r);q(j)}j.selectNodeContents(this.currentSelectedArr[0]).select()}else{j=this.selection.getRange();q(j);j.select()}},queryCommandState:function(){return this.highlight?-1:0}}};UE.plugins.font=function(){var a=this,c={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};a.setOpt({fontfamily:[{name:"songti",val:"\u5b8b\u4f53,SimSun"},{name:"yahei",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"kaiti",val:"\u6977\u4f53,\u6977\u4f53_GB2312, SimKai"},{name:"heiti",val:"\u9ed1\u4f53, SimHei"},{name:"lishu",val:"\u96b6\u4e66, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});for(var b in c){(function(e,d){UE.commands[e]={execCommand:function(m,j){j=j||(this.queryCommandState(m)?"none":m=="underline"?"underline":"line-through");var h=this,g=this.selection.getRange(),l;if(j=="default"){if(g.collapsed){l=h.document.createTextNode("font");g.insertNode(l).select()}h.execCommand("removeFormat","span,a",d);if(l){g.setStartBefore(l).setCursor();domUtils.remove(l)}}else{if(h.currentSelectedArr&&h.currentSelectedArr.length>0){for(var f=0,o;o=h.currentSelectedArr[f++];){g.selectNodeContents(o);g.applyInlineStyle("span",{style:d+":"+j})}g.selectNodeContents(this.currentSelectedArr[0]).select()}else{if(!g.collapsed){if((e=="underline"||e=="strikethrough")&&h.queryCommandValue(e)){h.execCommand("removeFormat","span,a",d)}g=h.selection.getRange();g.applyInlineStyle("span",{style:d+":"+j}).select()}else{var k=domUtils.findParentByTagName(g.startContainer,"span",true);l=h.document.createTextNode("font");if(k&&!k.children.length&&!k[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){g.insertNode(l);if(e=="underline"||e=="strikethrough"){g.selectNode(l).select();h.execCommand("removeFormat","span,a",d,null);k=domUtils.findParentByTagName(l,"span",true);g.setStartBefore(l)}k.style.cssText+=";"+d+":"+j;g.collapse(true).select()}else{g.insertNode(l);g.selectNode(l).select();k=g.document.createElement("span");if(e=="underline"||e=="strikethrough"){if(domUtils.findParentByTagName(l,"a",true)){g.setStartBefore(l).setCursor();domUtils.remove(l);return}h.execCommand("removeFormat","span,a",d)}k.style.cssText=d+":"+j;l.parentNode.insertBefore(k,l);if(!browser.ie||browser.ie&&browser.version==9){var n=k.parentNode;while(!domUtils.isBlockElm(n)){if(n.tagName=="SPAN"){k.style.cssText=n.style.cssText+";"+k.style.cssText}n=n.parentNode}}if(opera){setTimeout(function(){g.setStart(k,0).setCursor()})}else{g.setStart(k,0).setCursor()}}domUtils.remove(l)}}}return true},queryCommandValue:function(g){var f=this.selection.getStart();if(g=="underline"||g=="strikethrough"){var h=f,i;while(h&&!domUtils.isBlockElm(h)&&!domUtils.isBody(h)){if(h.nodeType==1){i=domUtils.getComputedStyle(h,d);if(i!="none"){return i}}h=h.parentNode}return"none"}return domUtils.getComputedStyle(f,d)},queryCommandState:function(f){if(this.highlight){return -1}if(!(f=="underline"||f=="strikethrough")){return 0}return this.queryCommandValue(f)==(f=="underline"?"underline":"line-through")}}})(b,c[b])}};UE.plugins.list=function(){var b=this,d={TD:1,PRE:1,BLOCKQUOTE:1};b.setOpt({insertorderedlist:{decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:""}});b.ready(function(){utils.cssRule("list","li{clear:both}",b.document)});function c(i,f,h){var g=i.nextSibling;if(g&&g.nodeType==1&&g.tagName.toLowerCase()==f&&(domUtils.getStyle(g,"list-style-type")||(f=="ol"?"decimal":"disc"))==h){domUtils.moveChild(g,i);if(g.childNodes.length==0){domUtils.remove(g)}}var e=i.previousSibling;if(e&&e.nodeType==1&&e.tagName.toLowerCase()==f&&(domUtils.getStyle(e,"list-style-type")||(f=="ol"?"decimal":"disc"))==h){domUtils.moveChild(i,e)}if(i.childNodes.length==0){domUtils.remove(i)}}function a(f){var e=f.previousSibling;if(e&&domUtils.isEmptyBlock(e)){domUtils.remove(e)}e=f.nextSibling;if(e&&domUtils.isEmptyBlock(e)){domUtils.remove(e)}}b.addListener("keydown",function(l,s){function i(){s.preventDefault?s.preventDefault():(s.returnValue=false);b.undoManger&&b.undoManger.save()}var t=s.keyCode||s.which;if(t==13){var k=b.selection.getRange(),f=domUtils.findParentByTagName(k.startContainer,["ol","ul"],true,function(u){return u.tagName=="TABLE"}),h=domUtils.findParentByTagName(k.endContainer,["ol","ul"],true,function(u){return u.tagName=="TABLE"});if(f&&h&&f===h){if(!k.collapsed){f=domUtils.findParentByTagName(k.startContainer,"li",true);h=domUtils.findParentByTagName(k.endContainer,"li",true);if(f&&h&&f===h){k.deleteContents();q=domUtils.findParentByTagName(k.startContainer,"li",true);if(q&&domUtils.isEmptyBlock(q)){pre=q.previousSibling;next=q.nextSibling;e=b.document.createElement("p");domUtils.fillNode(b.document,e);n=q.parentNode;if(pre&&next){k.setStart(next,0).collapse(true).select(true);domUtils.remove(q)}else{if(!pre&&!next||!pre){n.parentNode.insertBefore(e,n)}else{q.parentNode.parentNode.insertBefore(e,n.nextSibling)}domUtils.remove(q);if(!n.firstChild){domUtils.remove(n)}k.setStart(e,0).setCursor()}i();return}}else{var r=k.cloneRange(),g=r.collapse(false).createBookmark();k.deleteContents();r.moveToBookmark(g);var q=domUtils.findParentByTagName(r.startContainer,"li",true);a(q);r.select();i();return}}q=domUtils.findParentByTagName(k.startContainer,"li",true);if(q){if(domUtils.isEmptyBlock(q)){g=k.createBookmark();var n=q.parentNode;if(q!==n.lastChild){domUtils.breakParent(q,n);a(q)}else{n.parentNode.insertBefore(q,n.nextSibling);if(domUtils.isEmptyNode(n)){domUtils.remove(n)}}if(!dtd.$list[q.parentNode.tagName]){if(!domUtils.isBlockElm(q.firstChild)){e=b.document.createElement("p");q.parentNode.insertBefore(e,q);while(q.firstChild){e.appendChild(q.firstChild)}domUtils.remove(q)}else{domUtils.remove(q,true)}}k.moveToBookmark(g).select()}else{var j=q.firstChild;if(!j||!domUtils.isBlockElm(j)){var e=b.document.createElement("p");!q.firstChild&&domUtils.fillNode(b.document,e);while(q.firstChild){e.appendChild(q.firstChild)}q.appendChild(e);j=e}var m=b.document.createElement("span");k.insertNode(m);domUtils.breakParent(m,q);var o=m.nextSibling;j=o.firstChild;if(!j){e=b.document.createElement("p");domUtils.fillNode(b.document,e);o.appendChild(e);j=e}if(domUtils.isEmptyNode(j)){j.innerHTML="";domUtils.fillNode(b.document,j)}k.setStart(j,0).collapse(true).shrinkBoundary().select();domUtils.remove(m);pre=o.previousSibling;if(pre&&domUtils.isEmptyBlock(pre)){pre.innerHTML="<p></p>";domUtils.fillNode(b.document,pre.firstChild)}}i()}}}if(t==8){k=b.selection.getRange();if(k.collapsed&&domUtils.isStartInblock(k)){r=k.cloneRange().trimBoundary();q=domUtils.findParentByTagName(k.startContainer,"li",true);if(q&&domUtils.isStartInblock(r)){if(q&&(pre=q.previousSibling)){if(t==46&&q.childNodes.length){return}if(dtd.$list[pre.tagName]){pre=pre.lastChild}b.undoManger&&b.undoManger.save();j=q.firstChild;if(domUtils.isBlockElm(j)){if(domUtils.isEmptyNode(j)){pre.appendChild(j);k.setStart(j,0).setCursor(false,true);while(q.firstChild){pre.appendChild(q.firstChild)}}else{f=domUtils.findParentByTagName(k.startContainer,"p",true);if(f&&f!==j){return}m=b.document.createElement("span");k.insertNode(m);if(domUtils.isEmptyBlock(pre)){pre.innerHTML=""}domUtils.moveChild(q,pre);k.setStartBefore(m).collapse(true).select(true);domUtils.remove(m)}}else{if(domUtils.isEmptyNode(q)){var e=b.document.createElement("p");pre.appendChild(e);k.setStart(e,0).setCursor()}else{k.setEnd(pre,pre.childNodes.length).collapse().select(true);while(q.firstChild){pre.appendChild(q.firstChild)}}}domUtils.remove(q);b.undoManger&&b.undoManger.save();domUtils.preventDefault(s);return}if(q&&!q.previousSibling){j=q.firstChild;if(!j||q.lastChild===j&&domUtils.isEmptyNode(domUtils.isBlockElm(j)?j:q)){var e=b.document.createElement("p");q.parentNode.parentNode.insertBefore(e,q.parentNode);domUtils.fillNode(b.document,e);k.setStart(e,0).setCursor();domUtils.remove(!q.nextSibling?q.parentNode:q);b.undoManger&&b.undoManger.save();domUtils.preventDefault(s);return}}}}}});b.commands.insertorderedlist=b.commands.insertunorderedlist={execCommand:function(j,B){if(!B){B=j.toLowerCase()=="insertorderedlist"?"decimal":"disc"}var J=this,u=this.selection.getRange(),v=function(i){return i.nodeType==1?i.tagName.toLowerCase()!="br":!domUtils.isWhitespace(i)},L=j.toLowerCase()=="insertorderedlist"?"ol":"ul",h=J.document.createDocumentFragment();u.adjustmentBoundary().shrinkBoundary();var n=u.createBookmark(true),l=domUtils.findParentByTagName(J.document.getElementById(n.start),"li"),y=0,k=domUtils.findParentByTagName(J.document.getElementById(n.end),"li"),z=0,H,r,C,E;if(l||k){l&&(H=l.parentNode);if(!n.end){k=l}k&&(r=k.parentNode);if(H===r){while(l!==k){E=l;l=l.nextSibling;if(!domUtils.isBlockElm(E.firstChild)){var w=J.document.createElement("p");while(E.firstChild){w.appendChild(E.firstChild)}E.appendChild(w)}h.appendChild(E)}E=J.document.createElement("span");H.insertBefore(E,k);if(!domUtils.isBlockElm(k.firstChild)){w=J.document.createElement("p");while(k.firstChild){w.appendChild(k.firstChild)}k.appendChild(w)}h.appendChild(k);domUtils.breakParent(E,H);if(domUtils.isEmptyNode(E.previousSibling)){domUtils.remove(E.previousSibling)}if(domUtils.isEmptyNode(E.nextSibling)){domUtils.remove(E.nextSibling)}var m=domUtils.getComputedStyle(H,"list-style-type")||(j.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(H.tagName.toLowerCase()==L&&m==B){for(var A=0,s,o=J.document.createDocumentFragment();s=h.childNodes[A++];){while(s.firstChild){o.appendChild(s.firstChild)}}E.parentNode.insertBefore(o,E)}else{C=J.document.createElement(L);domUtils.setStyle(C,"list-style-type",B);C.appendChild(h);E.parentNode.insertBefore(C,E)}domUtils.remove(E);C&&c(C,L,B);u.moveToBookmark(n).select();return}if(l){while(l){E=l.nextSibling;if(domUtils.isTagNode(l,"ol ul")){h.appendChild(l)}else{var f=J.document.createDocumentFragment(),G=0;while(l.firstChild){if(domUtils.isBlockElm(l.firstChild)){G=1}f.appendChild(l.firstChild)}if(!G){var K=J.document.createElement("p");K.appendChild(f);h.appendChild(K)}else{h.appendChild(f)}domUtils.remove(l)}l=E}H.parentNode.insertBefore(h,H.nextSibling);if(domUtils.isEmptyNode(H)){u.setStartBefore(H);domUtils.remove(H)}else{u.setStartAfter(H)}y=1}if(k&&domUtils.inDoc(r,J.document)){l=r.firstChild;while(l&&l!==k){E=l.nextSibling;if(domUtils.isTagNode(l,"ol ul")){h.appendChild(l)}else{f=J.document.createDocumentFragment();G=0;while(l.firstChild){if(domUtils.isBlockElm(l.firstChild)){G=1}f.appendChild(l.firstChild)}if(!G){K=J.document.createElement("p");K.appendChild(f);h.appendChild(K)}else{h.appendChild(f)}domUtils.remove(l)}l=E}var e=domUtils.createElement(J.document,"div",{tmpDiv:1});domUtils.moveChild(k,e);h.appendChild(e);domUtils.remove(k);r.parentNode.insertBefore(h,r);u.setEndBefore(r);if(domUtils.isEmptyNode(r)){domUtils.remove(r)}z=1}}if(!y){u.setStartBefore(J.document.getElementById(n.start))}if(n.end&&!z){u.setEndAfter(J.document.getElementById(n.end))}u.enlarge(true,function(i){return d[i.tagName]});h=J.document.createDocumentFragment();var g=u.createBookmark(),x=domUtils.getNextDomNode(g.start,false,v),I=u.cloneRange(),D,q=domUtils.isBlockElm;while(x&&x!==g.end&&(domUtils.getPosition(x,g.end)&domUtils.POSITION_PRECEDING)){if(x.nodeType==3||dtd.li[x.tagName]){if(x.nodeType==1&&dtd.$list[x.tagName]){while(x.firstChild){h.appendChild(x.firstChild)}D=domUtils.getNextDomNode(x,false,v);domUtils.remove(x);x=D;continue}D=x;I.setStartBefore(x);while(x&&x!==g.end&&(!q(x)||domUtils.isBookmarkNode(x))){D=x;x=domUtils.getNextDomNode(x,false,null,function(i){return !d[i.tagName]})}if(x&&q(x)){E=domUtils.getNextDomNode(D,false,v);if(E&&domUtils.isBookmarkNode(E)){x=domUtils.getNextDomNode(E,false,v);D=E}}I.setEndAfter(D);x=domUtils.getNextDomNode(D,false,v);var t=u.document.createElement("li");t.appendChild(I.extractContents());h.appendChild(t)}else{x=domUtils.getNextDomNode(x,true,v)}}u.moveToBookmark(g).collapse(true);C=J.document.createElement(L);domUtils.setStyle(C,"list-style-type",B);C.appendChild(h);u.insertNode(C);c(C,L,B);for(var A=0,s,F=domUtils.getElementsByTagName(C,"div");s=F[A++];){if(s.getAttribute("tmpDiv")){domUtils.remove(s,true)}}u.moveToBookmark(n).select()},queryCommandState:function(e){return this.highlight?-1:domUtils.filterNodeList(this.selection.getStartElementPath(),e.toLowerCase()=="insertorderedlist"?"ol":"ul")?1:0},queryCommandValue:function(f){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),f.toLowerCase()=="insertorderedlist"?"ol":"ul");return e?domUtils.getComputedStyle(e,"list-style-type"):null}}};UE.plugins.paragraph=function(){var b=this,d=domUtils.isBlockElm,c=["TD","LI","PRE"],a=function(g,e,m,j){var i=g.createBookmark(),n=function(r){return r.nodeType==1?r.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(r):!domUtils.isWhitespace(r)},q;g.enlarge(true);var o=g.createBookmark(),h=domUtils.getNextDomNode(o.start,false,n),l=g.cloneRange(),f;while(h&&!(domUtils.getPosition(h,o.end)&domUtils.POSITION_FOLLOWING)){if(h.nodeType==3||!d(h)){l.setStartBefore(h);while(h&&h!==o.end&&!d(h)){f=h;h=domUtils.getNextDomNode(h,false,null,function(r){return !d(r)})}l.setEndAfter(f);q=g.document.createElement(e);if(m){domUtils.setAttributes(q,m);if(j&&j=="customstyle"&&m.style){q.style.cssText=m.style}}q.appendChild(l.extractContents());if(domUtils.isEmptyNode(q)){domUtils.fillChar(g.document,q)}l.insertNode(q);var k=q.parentNode;if(d(k)&&!domUtils.isBody(q.parentNode)&&utils.indexOf(c,k.tagName)==-1){if(!(j&&j=="customstyle")){k.getAttribute("dir")&&q.setAttribute("dir",k.getAttribute("dir"));k.style.cssText&&(q.style.cssText=k.style.cssText+";"+q.style.cssText);k.style.textAlign&&!q.style.textAlign&&(q.style.textAlign=k.style.textAlign);k.style.textIndent&&!q.style.textIndent&&(q.style.textIndent=k.style.textIndent);k.style.padding&&!q.style.padding&&(q.style.padding=k.style.padding)}if(m&&/h\d/i.test(k.tagName)&&!/h\d/i.test(q.tagName)){domUtils.setAttributes(k,m);if(j&&j=="customstyle"&&m.style){k.style.cssText=m.style}domUtils.remove(q,true);q=k}else{domUtils.remove(q.parentNode,true)}}if(utils.indexOf(c,k.tagName)!=-1){h=k}else{h=q}h=domUtils.getNextDomNode(h,false,n)}else{h=domUtils.getNextDomNode(h,true,n)}}return g.moveToBookmark(o).moveToBookmark(i)};b.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});b.commands.paragraph={execCommand:function(s,e,r,o){var n=new dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var m=0,f;f=this.currentSelectedArr[m++];){if(f.style.display=="none"){continue}if(domUtils.isEmptyNode(f)){var k=this.document.createTextNode("paragraph");f.innerHTML="";f.appendChild(k)}a(n.selectNodeContents(f),e,r,o);if(k){var q=k.parentNode;domUtils.remove(k);if(domUtils.isEmptyNode(q)){domUtils.fillNode(this.document,q)}}}var j=this.currentSelectedArr[0];if(domUtils.isEmptyBlock(j)){n.setStart(j,0).setCursor(false,true)}else{n.selectNode(j).select()}}else{n=this.selection.getRange();if(n.collapsed){var l=this.document.createTextNode("p");n.insertNode(l);if(browser.ie){var h=l.previousSibling;if(h&&domUtils.isWhitespace(h)){domUtils.remove(h)}h=l.nextSibling;if(h&&domUtils.isWhitespace(h)){domUtils.remove(h)}}}n=a(n,e,r,o);if(l){n.setStartBefore(l).collapse(true);q=l.parentNode;domUtils.remove(l);if(domUtils.isBlockElm(q)&&domUtils.isEmptyNode(q)){domUtils.fillNode(this.document,q)}}if(browser.gecko&&n.collapsed&&n.startContainer.nodeType==1){var g=n.startContainer.childNodes[n.startOffset];if(g&&g.nodeType==1&&g.tagName.toLowerCase()==e){n.setStart(g,0).collapse(true)}}n.select()}return true},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""},queryCommandState:function(){return this.highlight?-1:0}}};UE.plugins.rowspacing=function(){var a=this;a.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});a.commands.rowspacing={execCommand:function(c,d,b){this.execCommand("paragraph","p",{style:"margin-"+b+":"+d+"px"});return true},queryCommandValue:function(d,c){var b=domUtils.filterNodeList(this.selection.getStartElementPath(),function(f){return domUtils.isBlockElm(f)}),e;if(b){e=domUtils.getComputedStyle(b,"margin-"+c).replace(/[^\d]/g,"");return !e?0:e}return 0},queryCommandState:function(){return this.highlight?-1:0}}};UE.plugins.lineheight=function(){var a=this;a.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});a.commands.lineheight={execCommand:function(b,c){this.execCommand("paragraph","p",{style:"line-height:"+(c=="1"?"normal":c+"em")});return true},queryCommandValue:function(){var b=domUtils.filterNodeList(this.selection.getStartElementPath(),function(d){return domUtils.isBlockElm(d)});if(b){var c=domUtils.getComputedStyle(b,"line-height");return c=="normal"?1:c.replace(/[^\d.]*/ig,"")}},queryCommandState:function(){return this.highlight?-1:0}}};UE.plugins.customstyle=function(){var a=this;a.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]});a.commands.customstyle={execCommand:function(s,l){var q=this,f=l.tag,g=domUtils.findParent(q.selection.getStart(),function(i){return i.getAttribute("label")},true),m,h,j={};for(var d in l){if(l[d]!==undefined){j[d]=l[d]}}delete j.tag;if(g&&g.getAttribute("label")==l.label){m=this.selection.getRange();h=m.createBookmark();if(m.collapsed){if(dtd.$block[g.tagName]){var t=q.document.createElement("p");domUtils.moveChild(g,t);g.parentNode.insertBefore(t,g);domUtils.remove(g)}else{domUtils.remove(g,true)}}else{var n=domUtils.getCommonAncestor(h.start,h.end),c=domUtils.getElementsByTagName(n,f);if(new RegExp(f,"i").test(n.tagName)){c.push(n)}for(var k=0,e;e=c[k++];){if(e.getAttribute("label")==l.label){var b=domUtils.getPosition(e,h.start),o=domUtils.getPosition(e,h.end);if((b&domUtils.POSITION_FOLLOWING||b&domUtils.POSITION_CONTAINS)&&(o&domUtils.POSITION_PRECEDING||o&domUtils.POSITION_CONTAINS)){if(dtd.$block[f]){var t=q.document.createElement("p");domUtils.moveChild(e,t);e.parentNode.insertBefore(t,e)}}domUtils.remove(e,true)}}g=domUtils.findParent(n,function(i){return i.getAttribute("label")==l.label},true);if(g){domUtils.remove(g,true)}}m.moveToBookmark(h).select()}else{if(dtd.$block[f]){this.execCommand("paragraph",f,j,"customstyle");m=q.selection.getRange();if(!m.collapsed){m.collapse();g=domUtils.findParent(q.selection.getStart(),function(i){return i.getAttribute("label")==l.label},true);var r=q.document.createElement("p");domUtils.insertAfter(g,r);domUtils.fillNode(q.document,r);m.setStart(r,0).setCursor()}}else{m=q.selection.getRange();if(m.collapsed){g=q.document.createElement(f);domUtils.setAttributes(g,j);m.insertNode(g).setStart(g,0).setCursor();return}h=m.createBookmark();m.applyInlineStyle(f,j).moveToBookmark(h).select()}}},queryCommandValue:function(){var b=domUtils.filterNodeList(this.selection.getStartElementPath(),function(c){return c.getAttribute("label")});return b?b.getAttribute("label"):""},queryCommandState:function(){return this.highlight?-1:0}};a.addListener("keyup",function(d,b){var g=b.keyCode||b.which;if(g==32||g==13){var c=a.selection.getRange();if(c.collapsed){var e=domUtils.findParent(a.selection.getStart(),function(h){return h.getAttribute("label")},true);if(e&&dtd.$block[e.tagName]&&domUtils.isEmptyNode(e)){var f=a.document.createElement("p");domUtils.insertAfter(e,f);domUtils.fillNode(a.document,f);domUtils.remove(e);c.setStart(f,0).setCursor()}}}})};UE.commands.indent={execCommand:function(){var a=this,b=a.queryCommandState("indent")?"0em":(a.options.indentValue||"2em");a.execCommand("Paragraph","p",{style:"text-indent:"+b})},queryCommandState:function(){if(this.highlight){return -1}var a=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return a&&a.style.textIndent&&parseInt(a.style.textIndent)?1:0}};(function(){var c=domUtils.isBlockElm,b={left:1,right:1,center:1,justify:1},a=function(g,d){var j=g.createBookmark(),m=function(o){return o.nodeType==1?o.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(o):!domUtils.isWhitespace(o)};g.enlarge(true);var n=g.createBookmark(),i=domUtils.getNextDomNode(n.start,false,m),k=g.cloneRange(),f;while(i&&!(domUtils.getPosition(i,n.end)&domUtils.POSITION_FOLLOWING)){if(i.nodeType==3||!c(i)){k.setStartBefore(i);while(i&&i!==n.end&&!c(i)){f=i;i=domUtils.getNextDomNode(i,false,null,function(o){return !c(o)})}k.setEndAfter(f);var h=k.getCommonAncestor();if(!domUtils.isBody(h)&&c(h)){domUtils.setStyles(h,utils.isString(d)?{"text-align":d}:d);i=h}else{var e=g.document.createElement("p");domUtils.setStyles(e,utils.isString(d)?{"text-align":d}:d);var l=k.extractContents();e.appendChild(l);k.insertNode(e);i=e}i=domUtils.getNextDomNode(i,false,m)}else{i=domUtils.getNextDomNode(i,true,m)}}return g.moveToBookmark(n).moveToBookmark(j)};UE.commands.justify={execCommand:function(f,j){var e=this.selection.getRange(),d;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var g=0,h;h=this.currentSelectedArr[g++];){if(domUtils.isEmptyNode(h)){d=this.document.createTextNode("p");e.setStart(h,0).collapse(true).insertNode(d).selectNode(d)}else{e.selectNodeContents(h)}a(e,j.toLowerCase());d&&domUtils.remove(d)}e.selectNode(this.currentSelectedArr[0]).select()}else{if(e.collapsed){d=this.document.createTextNode("p");e.insertNode(d)}a(e,j);if(d){e.setStartBefore(d).collapse(true);domUtils.remove(d)}e.select()}return true},queryCommandValue:function(){var d=this.selection.getStart(),e=domUtils.getComputedStyle(d,"text-align");return b[e]?e:"left"},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){function a(d){var e=d.startContainer,c=d.endContainer;if(e=domUtils.findParentByTagName(e,"a",true)){d.setStartBefore(e)}if(c=domUtils.findParentByTagName(c,"a",true)){d.setEndAfter(c)}}UE.commands.unlink={execCommand:function(){var c,d=new dom.Range(this.document),k=this.currentSelectedArr,h;if(k&&k.length>0){for(var f=0,g;g=k[f++];){c=domUtils.getElementsByTagName(g,"a");for(var e=0,l;l=c[e++];){domUtils.remove(l,true)}}if(domUtils.isEmptyNode(k[0])){d.setStart(k[0],0).setCursor()}else{d.selectNodeContents(k[0]).select()}}else{d=this.selection.getRange();if(d.collapsed&&!domUtils.findParentByTagName(d.startContainer,"a",true)){return}h=d.createBookmark();a(d);d.removeInlineStyle("a").moveToBookmark(h).select()}},queryCommandState:function(){return !this.highlight&&this.queryCommandValue("link")?0:-1}};function b(d,e,g){var h=d.cloneRange(),f=g.queryCommandValue("link");a(d=d.adjustmentBoundary());var j=d.startContainer;if(j.nodeType==1&&f){j=j.childNodes[d.startOffset];if(j&&j.nodeType==1&&j.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(j[browser.ie?"innerText":"textContent"])){j[browser.ie?"innerText":"textContent"]=utils.html(e.textValue||e.href)}}if(!h.collapsed||f){d.removeInlineStyle("a");h=d.cloneRange()}if(h.collapsed){var c=d.document.createElement("a"),i="";if(e.textValue){i=utils.html(e.textValue);delete e.textValue}else{i=utils.html(e.href)}domUtils.setAttributes(c,e);j=domUtils.findParentByTagName(h.startContainer,"a",true);if(j&&domUtils.isInNodeEndBoundary(h,j)){d.setStartAfter(j).collapse(true)}c[browser.ie?"innerText":"textContent"]=i;d.insertNode(c).selectNode(c)}else{d.applyInlineStyle("a",e)}}UE.commands.link={queryCommandState:function(){return this.highlight?-1:0},execCommand:function(d,f){var c=new dom.Range(this.document),h=this.currentSelectedArr;f.data_ue_src&&(f.data_ue_src=utils.unhtml(f.data_ue_src,/[<">]/g));f.href&&(f.href=utils.unhtml(f.href,/[<">]/g));f.textValue&&(f.textValue=utils.unhtml(f.textValue,/[<">]/g));if(h&&h.length){for(var e=0,g;g=h[e++];){if(domUtils.isEmptyNode(g)){g[browser.ie?"innerText":"textContent"]=utils.html(f.textValue||f.href)}b(c.selectNodeContents(g),f,this)}c.selectNodeContents(h[0]).select()}else{b(c=this.selection.getRange(),f,this);c.collapse().select(true)}},queryCommandValue:function(){var l=new dom.Range(this.document),j=this.currentSelectedArr,g,f;if(j&&j.length){for(var k=0,d;d=j[k++];){g=d.getElementsByTagName("a");if(g[0]){return g[0]}}}else{l=this.selection.getRange();if(l.collapsed){f=l.startContainer;f=f.nodeType==1?f:f.parentNode;if(f&&(f=domUtils.findParentByTagName(f,"a",true))&&!domUtils.isInNodeEndBoundary(l,f)){return f}}else{l.shrinkBoundary();var e=l.startContainer.nodeType==3||!l.startContainer.childNodes[l.startOffset]?l.startContainer:l.startContainer.childNodes[l.startOffset],h=l.endContainer.nodeType==3||l.endOffset==0?l.endContainer:l.endContainer.childNodes[l.endOffset-1],m=l.getCommonAncestor();f=domUtils.findParentByTagName(m,"a",true);if(!f&&m.nodeType==1){var g=m.getElementsByTagName("a"),c,n;for(var k=0,o;o=g[k++];){c=domUtils.getPosition(o,e),n=domUtils.getPosition(o,h);if((c&domUtils.POSITION_FOLLOWING||c&domUtils.POSITION_CONTAINS)&&(n&domUtils.POSITION_PRECEDING||n&domUtils.POSITION_CONTAINS)){f=o;break}}}return f}}}}})();UE.plugins.anchor=function(){var a=this;a.ready(function(){utils.cssRule("anchor",".anchorclass{background: url('"+a.options.UEDITOR_HOME_URL+"themes/default/images/anchor.gif') no-repeat scroll left center transparent;border: 1px dotted #0000FF;cursor: auto;display: inline-block;height: 16px;width: 15px;}",a.document)});a.commands.anchor={execCommand:function(f,e){var c=this.selection.getRange(),b=c.getClosedNode();if(b&&b.getAttribute("anchorname")){if(e){b.setAttribute("anchorname",e)}else{c.setStartBefore(b).setCursor();domUtils.remove(b)}}else{if(e){var d=this.document.createElement("img");c.collapse(true);domUtils.setAttributes(d,{anchorname:e,"class":"anchorclass"});c.insertNode(d).setStartAfter(d).setCursor(false,true)}}},queryCommandState:function(){return this.highlight?-1:0}}};UE.commands.imagefloat={execCommand:function(a,g){var i=this,f=i.selection.getRange();if(!f.collapsed){var d=f.getClosedNode();if(d&&d.tagName=="IMG"){switch(g){case"left":case"right":case"none":var h=d.parentNode,b,c,e;while(dtd.$inline[h.tagName]||h.tagName=="A"){h=h.parentNode}b=h;if(b.tagName=="P"&&domUtils.getStyle(b,"text-align")=="center"){if(!domUtils.isBody(b)&&domUtils.getChildCount(b,function(j){return !domUtils.isBr(j)&&!domUtils.isWhitespace(j)})==1){c=b.previousSibling;e=b.nextSibling;if(c&&e&&c.nodeType==1&&e.nodeType==1&&c.tagName==e.tagName&&domUtils.isBlockElm(c)){c.appendChild(b.firstChild);while(e.firstChild){c.appendChild(e.firstChild)}domUtils.remove(b);domUtils.remove(e)}else{domUtils.setStyle(b,"text-align","")}}f.selectNode(d).select()}domUtils.setStyle(d,"float",g);break;case"center":if(i.queryCommandValue("imagefloat")!="center"){h=d.parentNode;domUtils.setStyle(d,"float","none");b=d;while(h&&domUtils.getChildCount(h,function(j){return !domUtils.isBr(j)&&!domUtils.isWhitespace(j)})==1&&(dtd.$inline[h.tagName]||h.tagName=="A")){b=h;h=h.parentNode}f.setStartBefore(b).setCursor(false);h=i.document.createElement("div");h.appendChild(b);domUtils.setStyle(b,"float","");i.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+h.innerHTML+"</p>");b=i.document.getElementById("_img_parent_tmp");b.removeAttribute("id");b=b.firstChild;f.selectNode(b).select();e=b.parentNode.nextSibling;if(e&&domUtils.isEmptyNode(e)){domUtils.remove(e)}}break}}}},queryCommandValue:function(){var a=this.selection.getRange(),b,c;if(a.collapsed){return"none"}b=a.getClosedNode();if(b&&b.nodeType==1&&b.tagName=="IMG"){c=domUtils.getComputedStyle(b,"float");if(c=="none"){c=domUtils.getComputedStyle(b.parentNode,"text-align")=="center"?"center":c}return{left:1,right:1,center:1}[c]?c:"none"}return"none"},queryCommandState:function(){if(this.highlight){return -1}var a=this.selection.getRange(),b;if(a.collapsed){return -1}b=a.getClosedNode();if(b&&b.nodeType==1&&b.tagName=="IMG"){return 0}return -1}};UE.commands.insertimage={execCommand:function(b,a){a=utils.isArray(a)?a:[a];if(!a.length){return}var j=this,g=j.selection.getRange(),d=g.getClosedNode();if(d&&/img/i.test(d.tagName)&&d.className!="edui-faked-video"&&!d.getAttribute("word_img")){var e=a.shift();var k=e.floatStyle;delete e.floatStyle;domUtils.setAttributes(d,e);j.execCommand("imagefloat",k);if(a.length>0){g.setStartAfter(d).setCursor(false,true);j.execCommand("insertimage",a)}}else{var f=[],h="",l;l=a[0];if(a.length==1){h='<img src="'+l.src+'" '+(l.data_ue_src?' data_ue_src="'+l.data_ue_src+'" ':"")+(l.width?'width="'+l.width+'" ':"")+(l.height?' height="'+l.height+'" ':"")+(l.floatStyle=="left"||l.floatStyle=="right"?' style="float:'+l.floatStyle+';"':"")+(l.title&&l.title!=""?' title="'+l.title+'"':"")+(l.border&&l.border!="0"?' border="'+l.border+'"':"")+(l.alt&&l.alt!=""?' alt="'+l.alt+'"':"")+(l.hspace&&l.hspace!="0"?' hspace = "'+l.hspace+'"':"")+(l.vspace&&l.vspace!="0"?' vspace = "'+l.vspace+'"':"")+"/>";if(l.floatStyle=="center"){h='<p style="text-align: center">'+h+"</p>"}f.push(h)}else{for(var c=0;l=a[c++];){h="<p "+(l.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+l.src+'" '+(l.width?'width="'+l.width+'" ':"")+(l.data_ue_src?' data_ue_src="'+l.data_ue_src+'" ':"")+(l.height?' height="'+l.height+'" ':"")+' style="'+(l.floatStyle&&l.floatStyle!="center"?"float:"+l.floatStyle+";":"")+(l.border||"")+'" '+(l.title?' title="'+l.title+'"':"")+" /></p>";f.push(h)}}j.execCommand("insertHtml",f.join(""))}},queryCommandState:function(){return this.highlight?-1:0}};UE.plugins.catchremoteimage=function(){if(this.options.catchRemoteImageEnable===false){return}var me=this;this.setOpt({localDomain:["127.0.0.1","localhost","img.baidu.com"],separater:"ue_separate_ue",catchFieldName:"upfile",catchRemoteImageEnable:true});var ajax=UE.ajax,localDomain=me.options.localDomain,catcherUrl=me.options.catcherUrl,separater=me.options.separater;function catchremoteimage(imgs,callbacks){var submitStr=imgs.join(separater);var tmpOption={timeout:60000,onsuccess:callbacks.success,onerror:callbacks.error};tmpOption[me.options.catchFieldName]=submitStr;ajax.request(catcherUrl,tmpOption)}me.addListener("afterpaste",function(){me.fireEvent("catchRemoteImage")});me.addListener("catchRemoteImage",function(){var remoteImages=[];var imgs=domUtils.getElementsByTagName(me.document,"img");var test=function(src,urls){for(var j=0,url;url=urls[j++];){if(src.indexOf(url)!==-1){return true}}return false};for(var i=0,ci;ci=imgs[i++];){if(ci.getAttribute("word_img")){continue}var src=ci.getAttribute("data_ue_src")||ci.src||"";if(/^(https?|ftp):/i.test(src)&&!test(src,localDomain)){remoteImages.push(src)}}if(remoteImages.length){catchremoteimage(remoteImages,{success:function(xhr){try{var info=eval("("+xhr.responseText+")")}catch(e){return}var srcUrls=info.srcUrl.split(separater),urls=info.url.split(separater);for(var i=0,ci;ci=imgs[i++];){var src=ci.getAttribute("data_ue_src")||ci.src||"";for(var j=0,cj;cj=srcUrls[j++];){var url=urls[j-1];if(src==cj&&url!="error"){var newSrc=me.options.catcherPath+url;domUtils.setAttributes(ci,{src:newSrc,data_ue_src:newSrc});break}}}me.fireEvent("catchremotesuccess")},error:function(){me.fireEvent("catchremoteerror")}})}})};UE.commands.snapscreen={execCommand:function(){var me=this,lang=me.getLang("snapScreen_plugin");me.setOpt({snapscreenServerPort:80,snapscreenImgAlign:"left"});var editorOptions=me.options;if(!browser.ie){alert(lang.browserMsg);return}var onSuccess=function(rs){try{rs=eval("("+rs+")")}catch(e){alert(lang.callBackErrorMsg);return}if(rs.state!="SUCCESS"){alert(rs.state);return}me.execCommand("insertimage",{src:editorOptions.snapscreenPath+rs.url,floatStyle:editorOptions.snapscreenImgAlign,data_ue_src:editorOptions.snapscreenPath+rs.url})};var onStartUpload=function(){};var onError=function(){alert(lang.uploadErrorMsg)};try{var nativeObj=new ActiveXObject("Snapsie.CoSnapsie");nativeObj.saveSnapshot(editorOptions.snapscreenHost,editorOptions.snapscreenServerUrl,editorOptions.snapscreenServerPort,onStartUpload,onSuccess,onError)}catch(e){me.ui._dialogs.snapscreenDialog.open()}},queryCommandState:function(){return this.highlight||!browser.ie?-1:0}};(function(){UE.plugins.background=function(){var a=this;UE.commands.background={queryCommandState:function(){return this.highlight?-1:0}};a.addListener("getAllHtml",function(g,f){var b=this.body,c=domUtils.getComputedStyle(b,"background-image"),e="";if(c.indexOf(a.options.imagePath)>0){e=c.substring(c.indexOf(a.options.imagePath),c.length-1).replace(/"|\(|\)/ig,"")}else{e=c!="none"?c.replace(/url\("?|"?\)/ig,""):""}f.html+='<style type="text/css">body{';var h={"background-color":domUtils.getComputedStyle(b,"background-color")||"#ffffff","background-image":e?"url("+e+")":"","background-repeat":domUtils.getComputedStyle(b,"background-repeat")||"","background-position":browser.ie?(domUtils.getComputedStyle(b,"background-position-x")+" "+domUtils.getComputedStyle(b,"background-position-y")):domUtils.getComputedStyle(b,"background-position"),height:domUtils.getComputedStyle(b,"height")};for(var d in h){if(h.hasOwnProperty(d)){f.html+=d+":"+h[d]+";"}}f.html+="}</style> "})}})();UE.commands.emotion={queryCommandState:function(){return this.highlight?-1:0}};UE.commands.time=UE.commands.date={execCommand:function(b){var a=new Date;this.execCommand("insertHtml",b=="time"?(a.getHours()+":"+(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":"+(a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds())):(a.getFullYear()+"-"+((a.getMonth()+1)<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-"+(a.getDate()<10?"0"+a.getDate():a.getDate())))},queryCommandState:function(){return this.highlight?-1:0}};UE.commands.spechars={queryCommandState:function(){return this.highlight?-1:0}};UE.commands.horizontal={execCommand:function(b){var d=this;if(d.queryCommandState(b)!==-1){d.execCommand("insertHtml","<hr>");var a=d.selection.getRange(),e=a.startContainer;if(e.nodeType==1&&!e.childNodes[a.startOffset]){var c;if(c=e.childNodes[a.startOffset-1]){if(c.nodeType==1&&c.tagName=="HR"){if(d.options.enterTag=="p"){c=d.document.createElement("p");a.insertNode(c);a.setStart(c,0).setCursor()}else{c=d.document.createElement("br");a.insertNode(c);a.setStartBefore(c).setCursor()}}}}return true}},queryCommandState:function(){return this.highlight||domUtils.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}};UE.plugins.table=function(){var n=this,r=domUtils.keys,f=domUtils.clearSelectedArr;var o,g,m=domUtils.isEmptyNode;n.ready(function(){utils.cssRule("table",".selectTdClass{background-color:#3399FF !important;}table.noBorderTable td{border:1px dashed #ddd !important}table{clear:both;margin-bottom:10px;border-collapse:collapse;word-break:break-all;}",n.document)});function c(s){var t=s.parentNode.cells;for(var v=0,u;u=t[v];v++){if(u===s){return v}}}function l(u,t){var v=u.ownerDocument.createElement("p");domUtils.fillNode(n.document,v);var s=u.parentNode;if(s&&s.getAttribute("dropdrag")){u=s}u.parentNode.insertBefore(v,u);domUtils.remove(u);t.setStart(v,0).setCursor()}function k(s){return s.style.display=="none"}function b(s){var v=0;for(var t=0,u;u=s[t++];){if(!k(u)){v++}}return v}n.currentSelectedArr=[];n.addListener("mousedown",d);n.addListener("keydown",function(t,s){var u=s.keyCode||s.which;if(!r[u]&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey){f(n.currentSelectedArr)}});n.addListener("mouseup",function(){o=null;n.removeListener("mouseover",d);var v=n.currentSelectedArr[0];if(v){n.document.body.style.webkitUserSelect="";var t=new dom.Range(n.document);if(m(v)){t.setStart(n.currentSelectedArr[0],0).setCursor()}else{t.selectNodeContents(n.currentSelectedArr[0]).select()}}else{var t=n.selection.getRange().shrinkBoundary();if(!t.collapsed){var u=domUtils.findParentByTagName(t.startContainer,"td",true),s=domUtils.findParentByTagName(t.endContainer,"td",true);if(u&&!s||!u&&s||u&&s&&u!==s){t.collapse(true).select(true)}}}});function j(){n.currentSelectedArr=[];o=null}n.commands.inserttable={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange();return domUtils.findParentByTagName(s.startContainer,"table",true)||domUtils.findParentByTagName(s.endContainer,"table",true)||n.currentSelectedArr.length>0?-1:0},execCommand:function(v,y){y=y||{numRows:5,numCols:5,border:1};var x=["<table "+(y.border=="0"?' class="noBorderTable"':"")+' _innerCreateTable = "true" '];if(y.cellSpacing&&y.cellSpacing!="0"||y.cellPadding&&y.cellPadding!="0"){x.push(' style="border-collapse:separate;" ')}y.cellSpacing&&y.cellSpacing!="0"&&x.push(' cellSpacing="'+y.cellSpacing+'" ');y.cellPadding&&y.cellPadding!="0"&&x.push(' cellPadding="'+y.cellPadding+'" ');x.push(' width="'+(y.width||100)+(typeof y.widthUnit=="undefined"?"%":y.widthUnit)+'" ');y.height&&x.push(' height="'+y.height+(typeof y.heightUnit=="undefined"?"%":y.heightUnit)+'" ');y.align&&(x.push(' align="'+y.align+'" '));x.push(' border="'+(y.border||0)+'" borderColor="'+(y.borderColor||"#000000")+'"');y.borderType=="1"&&x.push(' borderType="1" ');y.bgColor&&x.push(' bgColor="'+y.bgColor+'"');x.push(" ><tbody>");y.width=Math.floor((y.width||"100")/y.numCols);for(var w=0;w<y.numRows;w++){x.push("<tr>");for(var u=0;u<y.numCols;u++){x.push('<td style="width:'+y.width+(typeof y.widthUnit=="undefined"?"%":y.widthUnit)+";"+(y.borderType=="1"?"border:"+y.border+"px solid "+(y.borderColor||"#000000"):"")+'">'+(browser.ie?domUtils.fillChar:"<br/>")+"</td>")}x.push("</tr>")}n.execCommand("insertHtml",x.join("")+"</tbody></table>");j();if(y.align){var t=n.selection.getRange(),s=t.createBookmark(),z=t.startContainer;while(z&&!domUtils.isBody(z)){if(domUtils.isBlockElm(z)){z.style.clear="both";t.moveToBookmark(s).select();break}z=z.parentNode}}}};n.commands.edittable={queryCommandState:function(){var s=this.selection.getRange();if(this.highlight){return -1}return domUtils.findParentByTagName(s.startContainer,"table",true)||n.currentSelectedArr.length>0?0:-1},execCommand:function(s,u){var y=n.selection.getStart(),x=domUtils.findParentByTagName(y,"table",true);if(x){x.style.cssText=x.style.cssText.replace(/border[^;]+/gi,"");x.style.borderCollapse=u.cellSpacing&&u.cellSpacing!="0"||u.cellPadding&&u.cellPadding!="0"?"separate":"collapse";u.cellSpacing&&u.cellSpacing!="0"?x.setAttribute("cellSpacing",u.cellSpacing):x.removeAttribute("cellSpacing");u.cellPadding&&u.cellPadding!="0"?x.setAttribute("cellPadding",u.cellPadding):x.removeAttribute("cellPadding");u.height&&x.setAttribute("height",u.height+u.heightUnit);u.align&&x.setAttribute("align",u.align);u.width&&x.setAttribute("width",u.width+u.widthUnit);if(u.bgColor){x.setAttribute("bgColor",u.bgColor)}else{domUtils.removeAttributes(x,["bgColor"])}u.borderColor&&x.setAttribute("borderColor",u.borderColor);x.setAttribute("border",u.border);if(domUtils.hasClass(x,"noBorderTable")){domUtils.removeClasses(x,["noBorderTable"])}domUtils.addClass(x,u.border=="0"?" noBorderTable":"");if(u.borderType=="1"){for(var t=0,w,v=x.getElementsByTagName("td");w=v[t++];){w.style.border=u.border+"px solid "+(u.borderColor||"#000000")}x.setAttribute("borderType","1")}else{for(var t=0,w,v=x.getElementsByTagName("td");w=v[t++];){if(browser.ie){w.style.cssText=w.style.cssText.replace(/border[^;]+/gi,"")}else{domUtils.removeStyle(w,"border");domUtils.removeStyle(w,"border-image")}}x.removeAttribute("borderType")}}}};n.commands.edittd={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange();return(domUtils.findParentByTagName(s.startContainer,"table",true)&&domUtils.findParentByTagName(s.endContainer,"table",true))||n.currentSelectedArr.length>0?0:-1},execCommand:function(t,w){var s=this.selection.getRange(),v=!n.currentSelectedArr.length?[domUtils.findParentByTagName(s.startContainer,["td","th"],true)]:n.currentSelectedArr;for(var u=0,x;x=v[u++];){domUtils.setAttributes(x,{bgColor:w.bgColor,align:w.align,vAlign:w.vAlign})}}};n.commands.deletetable={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange();return(domUtils.findParentByTagName(s.startContainer,"table",true)&&domUtils.findParentByTagName(s.endContainer,"table",true))||n.currentSelectedArr.length>0?0:-1},execCommand:function(){var s=this.selection.getRange(),t=domUtils.findParentByTagName(n.currentSelectedArr.length>0?n.currentSelectedArr[0]:s.startContainer,"table",true);l(t,s);j()}};n.commands.mergeright={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange(),x=s.startContainer,w=domUtils.findParentByTagName(x,["td","th"],true);if(!w||this.currentSelectedArr.length>1){return -1}var v=w.parentNode;var t=c(w)+w.colSpan;if(t>=v.cells.length){return -1}var u=v.cells[t];if(k(u)){return -1}return w.rowSpan==u.rowSpan?0:-1},execCommand:function(){var y=this.selection.getRange(),s=y.startContainer,t=domUtils.findParentByTagName(s,["td","th"],true)||n.currentSelectedArr[0],z=t.parentNode,C=z.parentNode.parentNode.rows;var v=z.rowIndex,B=c(t)+t.colSpan,x=C[v].cells[B];for(var w=v;w<v+x.rowSpan;w++){for(var u=B;u<B+x.colSpan;u++){var A=C[w].cells[u];A.setAttribute("rootRowIndex",z.rowIndex);A.setAttribute("rootCellIndex",c(t))}}t.colSpan+=x.colSpan||1;i(t,x);x.style.display="none";if(domUtils.isEmptyBlock(t)){y.setStart(t,0).setCursor()}else{y.selectNodeContents(t).setCursor(true,true)}browser.ie&&domUtils.removeAttributes(t,["width","height"])}};n.commands.mergedown={queryCommandState:function(){if(this.highlight){return -1}var t=this.selection.getRange(),z=t.startContainer,y=domUtils.findParentByTagName(z,"td",true);if(!y||b(n.currentSelectedArr)>1){return -1}var x=y.parentNode,v=x.parentNode.parentNode,w=v.rows;var u=x.rowIndex+y.rowSpan;if(u>=w.length){return -1}var s=w[u].cells[c(y)];if(k(s)){return -1}return y.colSpan==s.colSpan?0:-1},execCommand:function(){var y=this.selection.getRange(),s=y.startContainer,u=domUtils.findParentByTagName(s,["td","th"],true)||n.currentSelectedArr[0];var A=u.parentNode,C=A.parentNode.parentNode.rows;var t=A.rowIndex+u.rowSpan,z=c(u),w=C[t].cells[z];for(var x=t;x<t+w.rowSpan;x++){for(var v=z;v<z+w.colSpan;v++){var B=C[x].cells[v];B.setAttribute("rootRowIndex",A.rowIndex);B.setAttribute("rootCellIndex",c(u))}}u.rowSpan+=w.rowSpan||1;i(u,w);w.style.display="none";if(domUtils.isEmptyBlock(u)){y.setStart(u,0).setCursor()}else{y.selectNodeContents(u).setCursor(true,true)}browser.ie&&domUtils.removeAttributes(u,["width","height"])}};n.commands.deleterow={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange(),u=s.startContainer,t=domUtils.findParentByTagName(u,["td","th"],true);if(!t&&n.currentSelectedArr.length==0){return -1}return 0},execCommand:function(){var D=this.selection.getRange(),w=D.startContainer,y=domUtils.findParentByTagName(w,["td","th"],true),s,I,v,A,B,z;if(y&&n.currentSelectedArr.length==0){var x=(y.rowSpan||1)-1;n.currentSelectedArr.push(y);s=y.parentNode;I=s.parentNode.parentNode;A=I.rows,B=s.rowIndex+1,z=c(y);while(x){n.currentSelectedArr.push(A[B].cells[z]);x--;B++}}while(y=n.currentSelectedArr.pop()){if(!domUtils.findParentByTagName(y,"table")){continue}s=y.parentNode,I=s.parentNode.parentNode;v=s.cells,A=I.rows,B=s.rowIndex,z=c(y);for(var C=0;C<v.length;){var u=v[C];if(k(u)){var t=A[u.getAttribute("rootRowIndex")].cells[u.getAttribute("rootCellIndex")];t.rowSpan--;C+=t.colSpan}else{if(u.rowSpan==1){C+=u.colSpan}else{var G=A[B+1].cells[C];G.style.display="";G.rowSpan=u.rowSpan-1;G.colSpan=u.colSpan;C+=u.colSpan}}}domUtils.remove(s);var J,E,H;if(B==A.length){if(B==0){l(I,D);return}var F=B-1;J=A[F].cells[z];E=k(J)?A[J.getAttribute("rootRowIndex")].cells[J.getAttribute("rootCellIndex")]:J}else{H=A[B].cells[z];E=k(H)?A[H.getAttribute("rootRowIndex")].cells[H.getAttribute("rootCellIndex")]:H}}D.setStart(E,0).setCursor();h(I)}};n.commands.deletecol={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange(),u=s.startContainer,t=domUtils.findParentByTagName(u,["td","th"],true);if(!t&&n.currentSelectedArr.length==0){return -1}return 0},execCommand:function(){var E=this.selection.getRange(),w=E.startContainer,z=domUtils.findParentByTagName(w,["td","th"],true);if(z&&n.currentSelectedArr.length==0){var y=(z.colSpan||1)-1;n.currentSelectedArr.push(z);while(y){do{z=z.nextSibling}while(z.nodeType==3);n.currentSelectedArr.push(z);y--}}while(z=n.currentSelectedArr.pop()){if(!domUtils.findParentByTagName(z,"table")){continue}var s=z.parentNode,I=s.parentNode.parentNode,B=c(z),C=I.rows,u=s.cells,D=s.rowIndex;var v;for(var N=0;N<C.length;){var t=C[N].cells[B];if(k(t)){var J=C[t.getAttribute("rootRowIndex")].cells[t.getAttribute("rootCellIndex")];v=J.rowSpan;for(var H=0;H<J.rowSpan;H++){var L=C[N+H].cells[B];domUtils.remove(L)}J.colSpan--;N+=v}else{if(t.colSpan==1){v=t.rowSpan;for(var H=N,G=N+t.rowSpan;H<G;H++){domUtils.remove(C[H].cells[B])}N+=v}else{var x=C[N].cells[B+1];x.style.display="";x.rowSpan=t.rowSpan;x.colSpan=t.colSpan-1;N+=t.rowSpan;domUtils.remove(t)}}}var M,F,K;if(B==u.length){if(B==0){l(I,E);return}var A=B-1;M=C[D].cells[A];F=k(M)?C[M.getAttribute("rootRowIndex")].cells[M.getAttribute("rootCellIndex")]:M}else{K=C[D].cells[B];F=k(K)?C[K.getAttribute("rootRowIndex")].cells[K.getAttribute("rootCellIndex")]:K}}E.setStart(F,0).setCursor();h(I)}};n.commands.splittocells={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange(),u=s.startContainer,t=domUtils.findParentByTagName(u,["td","th"],true);return t&&(t.rowSpan>1||t.colSpan>1)&&(!n.currentSelectedArr.length||b(n.currentSelectedArr)==1)?0:-1},execCommand:function(){var w=this.selection.getRange(),s=w.startContainer,t=domUtils.findParentByTagName(s,["td","th"],true),y=t.parentNode,D=y.parentNode.parentNode;var B=y.rowIndex,A=c(t),z=t.rowSpan,x=t.colSpan;for(var v=0;v<z;v++){for(var u=0;u<x;u++){var C=D.rows[B+v].cells[A+u];C.rowSpan=1;C.colSpan=1;if(k(C)){C.style.display="";C.innerHTML=browser.ie?"":"<br/>"}}}}};n.commands.splittorows={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange(),u=s.startContainer,t=domUtils.findParentByTagName(u,"td",true)||n.currentSelectedArr[0];return t&&(t.rowSpan>1)&&(!n.currentSelectedArr.length||b(n.currentSelectedArr)==1)?0:-1},execCommand:function(){var w=this.selection.getRange(),s=w.startContainer,t=domUtils.findParentByTagName(s,"td",true)||n.currentSelectedArr[0],y=t.parentNode,E=y.parentNode.parentNode.rows;var B=y.rowIndex,A=c(t),z=t.rowSpan,x=t.colSpan;for(var v=0;v<z;v++){var D=E[B+v],C=D.cells[A];C.rowSpan=1;C.colSpan=x;if(k(C)){C.style.display="";C.innerHTML=browser.ie?"":"<br/>"}for(var u=A+1;u<A+x;u++){C=D.cells[u];C.setAttribute("rootRowIndex",B+v)}}f(n.currentSelectedArr);this.selection.getRange().setStart(t,0).setCursor()}};n.commands.insertparagraphbeforetable={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange(),u=s.startContainer,t=domUtils.findParentByTagName(u,"td",true)||n.currentSelectedArr[0];return t&&domUtils.findParentByTagName(t,"table")?0:-1},execCommand:function(){var s=this.selection.getRange(),u=s.startContainer,t=domUtils.findParentByTagName(u,"table",true);u=n.document.createElement(n.options.enterTag);t.parentNode.insertBefore(u,t);f(n.currentSelectedArr);if(u.tagName=="P"){u.innerHTML=browser.ie?"":"<br/>";s.setStart(u,0)}else{s.setStartBefore(u)}s.setCursor()}};n.commands.splittocols={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange(),u=s.startContainer,t=domUtils.findParentByTagName(u,["td","th"],true)||n.currentSelectedArr[0];return t&&(t.colSpan>1)&&(!n.currentSelectedArr.length||b(n.currentSelectedArr)==1)?0:-1},execCommand:function(){var w=this.selection.getRange(),s=w.startContainer,t=domUtils.findParentByTagName(s,["td","th"],true)||n.currentSelectedArr[0],y=t.parentNode,E=y.parentNode.parentNode.rows;var B=y.rowIndex,A=c(t),z=t.rowSpan,x=t.colSpan;for(var v=0;v<x;v++){var D=E[B].cells[A+v];D.rowSpan=z;D.colSpan=1;if(k(D)){D.style.display="";D.innerHTML=browser.ie?"":"<br/>"}for(var u=B+1;u<B+z;u++){var C=E[u].cells[A+v];C.setAttribute("rootCellIndex",A+v)}}f(n.currentSelectedArr);this.selection.getRange().setStart(t,0).setCursor()}};n.commands.insertrow={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange();return domUtils.findParentByTagName(s.startContainer,"table",true)||domUtils.findParentByTagName(s.endContainer,"table",true)||n.currentSelectedArr.length!=0?0:-1},execCommand:function(){var x=this.selection.getRange(),s=x.startContainer,z=domUtils.findParentByTagName(s,"tr",true)||n.currentSelectedArr[0].parentNode,C=z.parentNode.parentNode,F=C.rows;var A=z.rowIndex,D=F[A].cells;var E=C.insertRow(A);var v;for(var y=0;y<D.length;){var B=D[y];if(k(B)){var w=F[B.getAttribute("rootRowIndex")].cells[B.getAttribute("rootCellIndex")];w.rowSpan++;for(var u=0;u<w.colSpan;u++){v=B.cloneNode(false);domUtils.removeAttributes(v,["bgColor","valign","align"]);v.rowSpan=v.colSpan=1;v.innerHTML=browser.ie?"":"<br/>";v.className="";if(E.children[y+u]){E.insertBefore(v,E.children[y+u])}else{E.appendChild(v)}v.style.display="none"}y+=w.colSpan}else{for(var t=0;t<B.colSpan;t++){v=B.cloneNode(false);domUtils.removeAttributes(v,["bgColor","valign","align"]);v.rowSpan=v.colSpan=1;v.innerHTML=browser.ie?"":"<br/>";v.className="";if(E.children[y+t]){E.insertBefore(v,E.children[y+t])}else{E.appendChild(v)}}y+=B.colSpan}}h(C);x.setStart(E.cells[0],0).setCursor();f(n.currentSelectedArr)}};n.commands.insertcol={queryCommandState:function(){if(this.highlight){return -1}var s=this.selection.getRange();return domUtils.findParentByTagName(s.startContainer,"table",true)||domUtils.findParentByTagName(s.endContainer,"table",true)||n.currentSelectedArr.length!=0?0:-1},execCommand:function(){var x=this.selection.getRange(),s=x.startContainer,t=domUtils.findParentByTagName(s,["td","th"],true)||n.currentSelectedArr[0],D=domUtils.findParentByTagName(t,"table"),E=D.rows;var z=c(t),w;for(var B=0;B<E.length;){var C=E[B].cells[z],y;if(k(C)){var A=E[C.getAttribute("rootRowIndex")].cells[C.getAttribute("rootCellIndex")];A.colSpan++;for(var v=0;v<A.rowSpan;v++){w=t.cloneNode(false);domUtils.removeAttributes(w,["bgColor","valign","align"]);w.rowSpan=w.colSpan=1;w.innerHTML=browser.ie?"":"<br/>";w.className="";y=E[B+v];if(y.children[z]){y.insertBefore(w,y.children[z])}else{y.appendChild(w)}w.style.display="none"}B+=A.rowSpan}else{for(var u=0;u<C.rowSpan;u++){w=t.cloneNode(false);domUtils.removeAttributes(w,["bgColor","valign","align"]);w.rowSpan=w.colSpan=1;w.innerHTML=browser.ie?"":"<br/>";w.className="";y=E[B+u];if(y.children[z]){y.insertBefore(w,y.children[z])}else{y.appendChild(w)}w.innerHTML=browser.ie?"":"<br/>"}B+=C.rowSpan}}h(D);x.setStart(E[0].cells[z],0).setCursor();f(n.currentSelectedArr)}};n.commands.mergecells={queryCommandState:function(){if(this.highlight){return -1}var u=0;for(var s=0,t;t=this.currentSelectedArr[s++];){if(!k(t)){u++}}return u>1?0:-1},execCommand:function(){var t=n.currentSelectedArr[0],w=n.currentSelectedArr[n.currentSelectedArr.length-1],D=domUtils.findParentByTagName(t,"table"),F=D.rows,s={beginRowIndex:t.parentNode.rowIndex,beginCellIndex:c(t),endRowIndex:w.parentNode.rowIndex,endCellIndex:c(w)},C=s.beginRowIndex,v=s.beginCellIndex,u=s.endRowIndex-s.beginRowIndex+1,B=s.endCellIndex-s.beginCellIndex+1,z=F[C].cells[v];for(var y=0,A;(A=F[C+y++])&&y<=u;){for(var x=0,E;(E=A.cells[v+x++])&&x<=B;){if(y==1&&x==1){E.style.display="";E.rowSpan=u;E.colSpan=B}else{E.style.display="none";E.rowSpan=1;E.colSpan=1;E.setAttribute("rootRowIndex",C);E.setAttribute("rootCellIndex",v);i(z,E)}}}this.selection.getRange().setStart(z,0).setCursor();browser.ie&&domUtils.removeAttributes(z,["width","height"]);f(n.currentSelectedArr)}};function i(t,s){if(m(s)){return}if(m(t)){t.innerHTML=s.innerHTML;return}var u=t.lastChild;if(u.nodeType!=1||u.tagName!="BR"){t.appendChild(t.ownerDocument.createElement("br"))}while(u=s.firstChild){t.appendChild(u)}}function e(w,v){var F=w.parentNode,E=v.parentNode,G=F.rowIndex,u=E.rowIndex,C=F.parentNode.parentNode.rows,P=C.length,t=C[0].cells.length,J=c(w),Q=c(v);if(w==v){return{beginRowIndex:G,beginCellIndex:J,endRowIndex:G+w.rowSpan-1,endCellIndex:Q+w.colSpan-1}}var L=Math.min(G,u),D=Math.min(J,Q),s=Math.max(G+w.rowSpan-1,u+v.rowSpan-1),K=Math.max(J+w.colSpan-1,Q+v.colSpan-1);while(1){var I=L,N=D,O=s,z=K;if(L>0){for(A=D;A<=K;){var x=C[L].cells[A];if(k(x)){L=x.getAttribute("rootRowIndex");x=C[x.getAttribute("rootRowIndex")].cells[x.getAttribute("rootCellIndex")]}A=c(x)+(x.colSpan||1)}}if(D>0){for(var B=L;B<=s;){var M=C[B].cells[D];if(k(M)){D=M.getAttribute("rootCellIndex");M=C[M.getAttribute("rootRowIndex")].cells[M.getAttribute("rootCellIndex")]}B=M.parentNode.rowIndex+(M.rowSpan||1)}}if(s<P){for(var A=D;A<=K;){var y=C[s].cells[A];if(k(y)){y=C[y.getAttribute("rootRowIndex")].cells[y.getAttribute("rootCellIndex")]}s=y.parentNode.rowIndex+y.rowSpan-1;A=c(y)+(y.colSpan||1)}}if(K<t){for(B=L;B<=s;){var H=C[B].cells[K];if(k(H)){H=C[H.getAttribute("rootRowIndex")].cells[H.getAttribute("rootCellIndex")]}K=c(H)+H.colSpan-1;B=H.parentNode.rowIndex+(H.rowSpan||1)}}if(N==D&&z==K&&O==s&&I==L){break}}return{beginRowIndex:L,beginCellIndex:D,endRowIndex:s,endCellIndex:K}}function d(t,s){o=s.target||s.srcElement;if(n.queryCommandState("highlightcode")||domUtils.findParent(o,function(u){return u.tagName=="DIV"&&/highlighter/.test(u.id)})){return}if(s.button==2){return}n.document.body.style.webkitUserSelect="";f(n.currentSelectedArr);domUtils.clearSelectedArr(n.currentSelectedArr);if(o.tagName!=="TD"){o=domUtils.findParentByTagName(o,"td")||o}if(o.tagName=="TD"){n.addListener("mouseover",function(v,u){var w=u.target||u.srcElement;a.call(n,w);u.preventDefault?u.preventDefault():(u.returnValue=false)})}else{j()}}function a(u){if(o&&u.tagName=="TD"&&domUtils.findParentByTagName(o,"table")==domUtils.findParentByTagName(u,"table")){n.document.body.style.webkitUserSelect="none";var t=u.parentNode.parentNode.parentNode;n.selection.getNative()[browser.ie?"empty":"removeAllRanges"]();var s=e(o,u);q(t,s)}}function q(v,u){var w=v.rows;f(n.currentSelectedArr);for(var t=u.beginRowIndex;t<=u.endRowIndex;t++){for(var s=u.beginCellIndex;s<=u.endCellIndex;s++){var x=w[t].cells[s];x.className="selectTdClass";n.currentSelectedArr.push(x)}}}function h(B){var x=B.getElementsByTagName("td"),A,z,C=B.rows;for(var v=0,t;t=x[v++];){if(!k(t)){A=t.parentNode.rowIndex;z=c(t);for(var s=0;s<t.rowSpan;s++){var y=s==0?1:0;for(;y<t.colSpan;y++){var w=C[A+s].children[z+y];w.setAttribute("rootRowIndex",A);w.setAttribute("rootCellIndex",z)}}}if(!k(t)){domUtils.removeAttributes(t,["rootRowIndex","rootCellIndex"])}if(t.colSpan&&t.colSpan==1){t.removeAttribute("colSpan")}if(t.rowSpan&&t.rowSpan==1){t.removeAttribute("rowSpan")}var u;if(!k(t)&&(u=t.style.width)&&/%/.test(u)){t.style.width=Math.floor(100/t.parentNode.cells.length)+"%"}}}n.adjustTable=function(I){var F=I.getElementsByTagName("table");for(var z=0,u;u=F[z++];){if(u.getAttribute("align")){var A=u.nextSibling;while(A){if(domUtils.isBlockElm(A)){break}A=A.nextSibling}if(A){A.style.clear="both"}}if(!u.getAttribute("border")&&!domUtils.getComputedStyle(u,"border")){domUtils.addClass(u,"noBorderTable")}u.removeAttribute("_innerCreateTable");var y=domUtils.getElementsByTagName(u,"td"),w,v;for(var x=0,t;t=y[x++];){if(domUtils.isEmptyNode(t)){t.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}var B=c(t),E=t.parentNode.rowIndex,H=domUtils.findParentByTagName(t,"table").rows;for(var s=0;s<t.rowSpan;s++){var C=s==0?1:0;for(;C<t.colSpan;C++){if(!w){w=t.cloneNode(false);w.rowSpan=w.colSpan=1;w.style.display="none";w.innerHTML=browser.ie?"":"<br/>"}else{w=w.cloneNode(true)}w.setAttribute("rootRowIndex",t.parentNode.rowIndex);w.setAttribute("rootCellIndex",B);if(s==0){if(t.nextSibling){t.parentNode.insertBefore(w,t.nextSibling)}else{t.parentNode.appendChild(w)}}else{var G;if(!H[E+s]){G=u.insertRow(E+s)}else{G=H[E+s]}v=G.children[B];if(v){v.parentNode.insertBefore(w,v)}else{H[E+s].appendChild(w)}}}}}var D=domUtils.getComputedStyle(u,"border-width");if(D=="0px"&&u.style.border!="none"||((D==""||D=="medium")&&u.getAttribute("border")==="0")){domUtils.addClass(u,"noBorderTable")}}n.fireEvent("afteradjusttable",I)};n.addListener("aftersetcontent",function(){n.adjustTable(n.body)})};UE.commands.preview={execCommand:function(){var a=window.open("","_blank",""),b=a.document;b.open();b.write(this.getAllHtml());b.close()},notNeedUndo:1};UE.plugins.searchreplace=function(){var a,c,b=this;b.addListener("reset",function(){a=null;c=null});b.commands.searchreplace={execCommand:function(n,d){var i=this,e=i.selection,g,h,f=0,d=utils.extend(d,{all:false,casesensitive:false,dir:1},true);if(browser.ie){while(1){var k;h=i.document.selection.createRange();k=h.duplicate();k.moveToElementText(i.document.body);if(d.all){c=0;d.dir=1;if(a){k.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",a)}}else{k.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",h);if(d.hasOwnProperty("replaceStr")){k.setEndPoint(d.dir==-1?"StartToEnd":"EndToStart",h)}}h=k.duplicate();if(!k.findText(d.searchStr,d.dir,d.casesensitive?4:0)){a=null;k=i.document.selection.createRange();k.scrollIntoView();return f}k.select();if(d.hasOwnProperty("replaceStr")){g=e.getRange();g.deleteContents().insertNode(g.document.createTextNode(d.replaceStr)).select();a=e.getNative().createRange()}f++;if(!d.all){break}}}else{var j=i.window,m=e.getNative(),k;while(1){if(d.all){if(a){a.collapse(false);h=a}else{h=i.document.createRange();h.setStart(i.document.body,0)}m.removeAllRanges();m.addRange(h);c=0;d.dir=1}else{if(browser.safari){i.selection.getRange().select()}h=j.getSelection().getRangeAt(0);if(d.hasOwnProperty("replaceStr")){h.collapse(d.dir==1?true:false)}}if(!c){h.collapse(d.dir<0?true:false);m.removeAllRanges();m.addRange(h)}else{m.removeAllRanges()}if(!j.find(d.searchStr,d.casesensitive,d.dir<0?true:false)){a=null;m.removeAllRanges();return f}c=0;g=j.getSelection().getRangeAt(0);if(!g.collapsed){if(d.hasOwnProperty("replaceStr")){g.deleteContents();var l=j.document.createTextNode(d.replaceStr);g.insertNode(l);g.selectNode(l);m.addRange(g);a=g.cloneRange()}}f++;if(!d.all){break}}}return true}}};UE.plugins.wordcount=function(){var d=this;d.setOpt({wordCount:true,maximumWords:10000,wordCountMsg:d.options.wordCountMsg||d.getLang("wordCountMsg"),wordOverFlowMsg:d.options.wordOverFlowMsg||d.getLang("wordOverFlowMsg")});var b=d.options,a=b.maximumWords,e=b.wordCountMsg,c=b.wordOverFlowMsg;if(!b.wordCount){return}d.commands.wordcount={queryCommandValue:function(j,h){var i,f,g;if(h){g=new RegExp("[\r\t\n]","g");f=this.getContentTxt().replace(g,"");return f.length}g=new RegExp("[\r\t\n]","g");f=this.getContentTxt().replace(g,"");i=f.length;if(a-i<0){d.fireEvent("wordcountoverflow",i);return c}return e.replace("{#leave}",a-i>=0?a-i:0).replace("{#count}",i)}}};UE.plugins.contextmenu=function(){var c=this,e=c.getLang("contextMenu"),d,a=c.options.contextMenu||[{label:e["delete"],cmdName:"delete"},{label:e.selectall,cmdName:"selectall"},{label:e.deletecode,cmdName:"highlightcode",icon:"deletehighlightcode"},{label:e.cleardoc,cmdName:"cleardoc",exec:function(){if(confirm(e.confirmclear)){this.execCommand("cleardoc")}}},"-",{label:e.unlink,cmdName:"unlink"},"-",{group:e.paragraph,icon:"justifyjustify",subMenu:[{label:e.justifyleft,cmdName:"justify",value:"left"},{label:e.justifyright,cmdName:"justify",value:"right"},{label:e.justifycenter,cmdName:"justify",value:"center"},{label:e.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{label:e.edittable,cmdName:"edittable",exec:function(){this.ui._dialogs.inserttableDialog.open()}},{label:e.edittd,cmdName:"edittd",exec:function(){if(UE.ui.edittd){new UE.ui.edittd(this)}this.ui._dialogs.edittdDialog.open()}},{group:e.table,icon:"table",subMenu:[{label:e.inserttable,cmdName:"inserttable"},{label:e.deletetable,cmdName:"deletetable"},{label:e.insertparagraphbeforetable,cmdName:"insertparagraphbeforetable"},{label:e.deleterow,cmdName:"deleterow"},{label:e.deletecol,cmdName:"deletecol"},{label:e.insertrow,cmdName:"insertrow"},{label:e.insertcol,cmdName:"insertcol"},{label:e.mergeright,cmdName:"mergeright"},{label:e.mergedown,cmdName:"mergedown"},{label:e.splittorows,cmdName:"splittorows"},{label:e.splittocols,cmdName:"splittocols"},{label:e.mergecells,cmdName:"mergecells"},{label:e.splittocells,cmdName:"splittocells"}]},"-",{label:e.copy,cmdName:"copy",exec:function(){alert(e.copymsg)},query:function(){return 0}},{label:e.paste,cmdName:"paste",exec:function(){alert(e.pastemsg)},query:function(){return 0}},{label:e.highlightcode,cmdName:"highlightcode",exec:function(){if(UE.ui.highlightcode){new UE.ui.highlightcode(this)}this.ui._dialogs.highlightcodeDialog.open()}}];if(!a.length){return}var b=UE.ui.uiUtils;c.addListener("contextmenu",function(m,o){var h=b.getViewportOffsetByEvent(o);c.fireEvent("beforeselectionchange");if(d){d.destroy()}for(var j=0,f,q=[];f=a[j];j++){var n;(function(t){if(t=="-"){if((n=q[q.length-1])&&n!=="-"){q.push("-")}}else{if(t.hasOwnProperty("group")){for(var s=0,r,i=[];r=t.subMenu[s];s++){(function(u){if(u=="-"){if((n=i[i.length-1])&&n!=="-"){i.push("-")}}else{if((c.commands[u.cmdName]||UE.commands[u.cmdName]||u.query)&&(u.query?u.query():c.queryCommandState(u.cmdName))>-1){i.push({label:u.label||c.getLang("contextMenu."+u.cmdName+(u.value||"")),className:"edui-for-"+u.cmdName+(u.value||""),onclick:u.exec?function(){u.exec.call(c)}:function(){c.execCommand(u.cmdName,u.value)}})}}})(r)}if(i.length){q.push({label:t.icon=="table"?c.getLang("contextMenu.table"):c.getLang("contextMenu.paragraph"),className:"edui-for-"+t.icon,subMenu:{items:i,editor:c}})}}else{if((c.commands[t.cmdName]||UE.commands[t.cmdName]||t.query)&&(t.query?t.query.call(c):c.queryCommandState(t.cmdName))>-1){if(t.cmdName=="highlightcode"){if(c.queryCommandState(t.cmdName)==1&&t.icon!="deletehighlightcode"){return}if(c.queryCommandState(t.cmdName)!=1&&t.icon=="deletehighlightcode"){return}}q.push({label:t.label||c.getLang("contextMenu."+t.cmdName),className:"edui-for-"+(t.icon?t.icon:t.cmdName+(t.value||"")),onclick:t.exec?function(){t.exec.call(c)}:function(){c.execCommand(t.cmdName,t.value)}})}}}})(f)}if(q[q.length-1]=="-"){q.pop()}d=new UE.ui.Menu({items:q,editor:c});d.render();d.showAt(h);domUtils.preventDefault(o);if(browser.ie){var g;try{g=c.selection.getNative().createRange()}catch(l){return}if(g.item){var k=new dom.Range(c.document);k.selectNode(g.item(0)).select(true,true)}}})};UE.plugins.autoheight=function(){var g=this;g.autoHeightEnabled=g.options.autoHeightEnabled!==false;if(!g.autoHeightEnabled){return}var e,h,d,f=0,i=g.options,b,a;function c(){clearTimeout(a);a=setTimeout(function(){if(g.queryCommandState("source")!=1){if(!h){h=g.document.createElement("span");h.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;";h.innerHTML="."}d=h.cloneNode(true);g.body.appendChild(d);b=Math.max(domUtils.getXY(d).y+d.offsetHeight,Math.max(i.minFrameHeight,i.initialFrameHeight));if(b!=f){g.setHeight(b);f=b}domUtils.remove(d)}},50)}g.addListener("destroy",function(){g.removeListener("contentchange",c);g.removeListener("keyup",c);g.removeListener("mouseup",c)});g.enableAutoHeight=function(){if(!g.autoHeightEnabled){return}var j=g.document;g.autoHeightEnabled=true;e=j.body.style.overflowY;j.body.style.overflowY="hidden";g.addListener("contentchange",c);g.addListener("keyup",c);g.addListener("mouseup",c);setTimeout(function(){c()},browser.gecko?100:0);g.fireEvent("autoheightchanged",g.autoHeightEnabled)};g.disableAutoHeight=function(){g.body.style.overflowY=e||"";g.removeListener("contentchange",c);g.removeListener("keyup",c);g.removeListener("mouseup",c);g.autoHeightEnabled=false;g.fireEvent("autoheightchanged",g.autoHeightEnabled)};g.addListener("ready",function(){g.enableAutoHeight();var j;domUtils.on(browser.ie?g.body:g.document,browser.webkit?"dragover":"drop",function(){clearTimeout(j);j=setTimeout(function(){c()},100)})})};UE.plugins.autofloat=function(){var s=this,t=s.getLang();s.setOpt({topOffset:0});var m=s.options.autoFloatEnabled!==false,k=s.options.topOffset;if(!m){return}var f=UE.ui.uiUtils,g=browser.ie&&browser.version<=6,l=browser.quirks;function a(u){if(!u.ui){alert(t.autofloatMsg);return 0}return 1}function h(){var u=document.body.style;u.backgroundImage='url("about:blank")';u.backgroundAttachment="fixed"}var i,n=document.createElement("div"),d,c,r,o=true;function j(){var v=domUtils.getXY(d),u=domUtils.getComputedStyle(d,"position"),w=domUtils.getComputedStyle(d,"left");d.style.width=d.offsetWidth+"px";d.style.zIndex=s.options.zIndex*1+1;d.parentNode.insertBefore(n,d);if(g||(l&&browser.ie)){if(d.style.position!="absolute"){d.style.position="absolute"}d.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-c+k+"px"}else{if(browser.ie7Compat&&o){o=false;d.style.left=domUtils.getXY(d).x-document.documentElement.getBoundingClientRect().left+2+"px"}if(d.style.position!="fixed"){d.style.position="fixed";d.style.top=k+"px";((u=="absolute"||u=="relative")&&parseFloat(w))&&(d.style.left=v.x+"px")}}}function e(){o=true;if(n.parentNode){n.parentNode.removeChild(n)}d.style.cssText=i}function b(){var u=r(s.container);if(u.top<0&&u.bottom-d.offsetHeight>0){j()}else{e()}}var q=utils.defer(function(){b()},browser.ie?200:100,true);s.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],b);s.removeListener("keydown",q)});s.addListener("ready",function(){if(a(s)){r=f.getClientRect;d=s.ui.getDom("toolbarbox");c=r(d).top;i=d.style.cssText;n.style.height=d.offsetHeight+"px";if(g){h()}s.addListener("autoheightchanged",function(v,u){if(u){domUtils.on(window,["scroll","resize"],b);s.addListener("keydown",q)}else{domUtils.un(window,["scroll","resize"],b);s.removeListener("keydown",q)}});s.addListener("beforefullscreenchange",function(v,u){if(u){e()}});s.addListener("fullscreenchanged",function(v,u){if(!u){b()}});s.addListener("sourcemodechanged",function(v,u){setTimeout(function(){b()},0)})}})};UE.plugins.elementpath=function(){var c,a,b=this;b.setOpt("elementPathEnabled",true);if(!b.options.elementPathEnabled){return}b.commands.elementpath={execCommand:function(n,e){var g=a[e],l=b.selection.getRange();b.currentSelectedArr&&domUtils.clearSelectedArr(b.currentSelectedArr);c=e*1;if(dtd.$tableContent[g.tagName]){switch(g.tagName){case"TD":b.currentSelectedArr=[g];g.className=b.options.selectedTdClass;break;case"TR":var o=g.cells;for(var k=0,f;f=o[k++];){b.currentSelectedArr.push(f);f.className=b.options.selectedTdClass}break;case"TABLE":case"TBODY":var q=g.rows;for(var k=0,m;m=q[k++];){o=m.cells;for(var h=0,d;d=o[h++];){b.currentSelectedArr.push(d);d.className=b.options.selectedTdClass}}}g=b.currentSelectedArr[0];if(domUtils.isEmptyNode(g)){l.setStart(g,0).setCursor()}else{l.selectNodeContents(g).select()}}else{l.selectNode(g).select()}},queryCommandValue:function(){var e=[].concat(this.selection.getStartElementPath()).reverse(),h=[];a=e;for(var g=0,f;f=e[g];g++){if(f.nodeType==3){continue}var d=f.tagName.toLowerCase();if(d=="img"&&f.getAttribute("anchorname")){d="anchor"}h[g]=d;if(c==g){c=-1;break}}return h}}};UE.plugins.autolink=function(){var a=0;if(browser.ie){return}var b=this;b.addListener("reset",function(){a=0});b.addListener("keydown",function(j,l){var o=l.keyCode||l.which;if(o==32||o==13){var f=b.selection.getNative(),h=f.getRangeAt(0).cloneRange(),g,n;var d=h.startContainer;while(d.nodeType==1&&h.startOffset>0){d=h.startContainer.childNodes[h.startOffset-1];if(!d){break}h.setStart(d,d.nodeType==1?d.childNodes.length:d.nodeValue.length);h.collapse(true);d=h.startContainer}do{if(h.startOffset==0){d=h.startContainer.previousSibling;while(d&&d.nodeType==1){d=d.lastChild}if(!d||domUtils.isFillChar(d)){break}g=d.nodeValue.length}else{d=h.startContainer;g=h.startOffset}h.setStart(d,g-1);n=h.toString().charCodeAt(0)}while(n!=160&&n!=32);if(h.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(h.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(h.toString())){break}try{h.setStart(h.startContainer,h.startOffset+1)}catch(i){var d=h.startContainer;while(!(next=d.nextSibling)){if(domUtils.isBody(d)){return}d=d.parentNode}h.setStart(next,0)}}if(domUtils.findParentByTagName(h.startContainer,"a",true)){return}var k=b.document.createElement("a"),m=b.document.createTextNode(" "),c;b.undoManger&&b.undoManger.save();k.appendChild(h.extractContents());k.href=k.innerHTML=k.innerHTML.replace(/<[^>]+>/g,"");c=k.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),"");c=/^(?:https?:\/\/)/ig.test(c)?c:"http://"+c;k.setAttribute("data_ue_src",c);k.href=c;h.insertNode(k);k.parentNode.insertBefore(m,k.nextSibling);h.setStart(m,0);h.collapse(true);f.removeAllRanges();f.addRange(h);b.undoManger&&b.undoManger.save()}}})};UE.commands.autosubmit={execCommand:function(){var b=this,a=domUtils.findParentByTagName(b.iframe,"form",false);if(a){if(b.fireEvent("beforesubmit")===false){return}b.sync();a.submit()}}};UE.plugins.undo=function(){var j=this,n=j.options.maxUndoCount||20,i=j.options.maxInputCount||20,e=new RegExp(domUtils.fillChar+"|</hr>","gi"),a=/\b(?:href|src|name)="[^"]*?"/gi;function l(o){var q=this;q.collapsed=o.collapsed;q.startAddr=k(o.startContainer,o.startOffset);q.endAddr=o.collapsed?q.startAddr:k(o.endContainer,o.endOffset)}l.prototype={compare:function(q){var o=this;if(o.collapsed!==q.collapsed){return 0}if(!g(o.startAddr,q.startAddr)||!g(o.endAddr,q.endAddr)){return 0}return 1},transformRange:function(o){var q=this;o.collapsed=q.collapsed;d(o,"start",q.startAddr);o.collapsed?o.collapse(true):d(o,"end",q.endAddr)}};function k(v,r){for(var t=0,o=[r],s,q=domUtils.findParents(v,true,function(w){return !domUtils.isBody(w)},true);s=q[t++];){if(t==1&&s.nodeType==3){var u=s;while(u=u.previousSibling){if(u.nodeType==3){r+=u.nodeValue.replace(fillCharReg,"").length}else{break}}o[0]=r}o.push(domUtils.getNodeIndex(s,true))}return o.reverse()}function g(s,r){if(s.length!=r.length){return 0}for(var q=0,o=s.length;q<o;q++){if(s[q]!=r[q]){return 0}}return 1}function d(q,u,t){s=q.document.body;for(var r=0,s,o=t.length-1;r<o;r++){s=s.childNodes[t[r]]}q[u+"Container"]=s;q[u+"Offset"]=t[t.length-1]}function c(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var q=this.getScene(),o=this.list[this.index];if(o.content.replace(a,"")!=q.content.replace(a,"")){this.save()}if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var u=this.list[this.index];j.document.body.innerHTML=u.bookcontent.replace(e,"");if(browser.ie){for(var q=0,t,v=j.document.getElementsByTagName("p");t=v[q++];){if(t.innerHTML==""){domUtils.fillNode(j.document,t)}}}var o=new dom.Range(j.document);try{if(browser.opera||browser.safari){u.senceRange.transformRange(o)}else{o.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:true})}if(browser.ie&&browser.version==9&&o.collapsed&&domUtils.isBlockElm(o.startContainer)&&domUtils.isEmptyNode(o.startContainer)){domUtils.fillNode(o.document,o.startContainer)}o.select(!browser.gecko);if(!(browser.opera||browser.safari)){setTimeout(function(){o.scrollToView(j.autoHeightEnabled,j.autoHeightEnabled?domUtils.getXY(j.iframe).y:0)},200)}}catch(s){}this.update();if(j.currentSelectedArr){j.currentSelectedArr=[];var r=j.document.getElementsByTagName("td");for(var q=0,w;w=r[q++];){if(w.className==j.options.selectedTdClass){j.currentSelectedArr.push(w)}}}this.clearKey();j.fireEvent("reset",true)};this.getScene=function(){var q=j.selection.getRange(),o=j.body.innerHTML.replace(e,"");q.shrinkBoundary();browser.ie&&(o=o.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));if(browser.opera||browser.safari){return{senceRange:new l(q),content:o,bookcontent:o}}else{var s=q.createBookmark(true,true),r=j.body.innerHTML.replace(e,"");s&&q.moveToBookmark(s).select(true);return{bookcontent:r,content:o}}};this.save=function(r){var q=this.getScene(),o=this.list[this.index];if(o&&o.content==q.content&&(r?1:((browser.opera||browser.safari)?o.senceRange.compare(q.senceRange):o.bookcontent==q.bookcontent))){return}this.list=this.list.slice(0,this.index+1);this.list.push(q);if(this.list.length>n){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update()};this.update=function(){this.hasRedo=this.list[this.index+1]?true:false;this.hasUndo=this.list[this.index-1]||this.list.length==1?true:false};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){f=0;b=null;j.fireEvent("contentchange")}}j.undoManger=new c();function h(){this.undoManger.save()}j.addListener("beforeexeccommand",h);j.addListener("afterexeccommand",h);j.addListener("reset",function(q,o){if(!o){j.undoManger.reset()}});j.commands.redo=j.commands.undo={execCommand:function(o){j.undoManger[o]()},queryCommandState:function(o){return j.undoManger["has"+(o.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var m={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},f=0,b;j.addListener("keydown",function(q,o){var r=o.keyCode||o.which;if(!m[r]&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey){if(j.undoManger.list.length==0||((r==8||r==46)&&b!=r)){j.undoManger.save(true);b=r;return}if(j.undoManger.list.length==2&&j.undoManger.index==0&&f==0){j.undoManger.list.splice(1,1);j.undoManger.update()}b=r;f++;if(f>=i){if(j.selection.getRange().collapsed){j.undoManger.save()}}}})};UE.plugins.selectall=function(){var a=this;a.commands.selectall={execCommand:function(){var d=this,b=d.body,c=d.selection.getRange();c.selectNodeContents(b);if(domUtils.isEmptyBlock(b)){if(browser.opera&&b.firstChild&&b.firstChild.nodeType==1){c.setStartAtFirst(b.firstChild)}c.collapse(true)}c.select(true);this.selectAll=true},notNeedUndo:1};a.addListener("ready",function(){domUtils.on(a.document,"click",function(b){a.selectAll=false})})};UE.plugins.keystrokes=function(){var e=this,a=0,d=domUtils.keys,b={B:"strong",I:"em",FONT:"span"},c=[0,10,12,16,18,24,32,48],g={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};function f(i,h){if(i.tagName!==h.tagName||domUtils.getComputedStyle(i,"list-style-type")!==domUtils.getComputedStyle(h,"list-style-type")){return false}return true}e.addListener("keydown",function(k,z){var r=z.keyCode||z.which;if(this.selectAll){this.selectAll=false;if((r==8||r==46)){e.undoManger&&e.undoManger.save();e.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";new dom.Range(e.document).setStart(e.body.firstChild,0).setCursor(false,true);e.undoManger&&e.undoManger.save();browser.ie&&e._selectionChange();domUtils.preventDefault(z);return}}if(r==8){var w=e.selection.getRange(),I,m,l;if(w.collapsed){m=w.startContainer;if(domUtils.isWhitespace(m)){m=m.parentNode}if(domUtils.isEmptyNode(m)&&m===e.body.firstChild){if(m.tagName!="P"){p=e.document.createElement("p");e.body.insertBefore(p,m);domUtils.fillNode(e.document,p);w.setStart(p,0).setCursor(false,true);domUtils.remove(m)}domUtils.preventDefault(z);return}}if(w.collapsed&&w.startContainer.nodeType==3&&w.startContainer.nodeValue.replace(new RegExp(domUtils.fillChar,"g"),"").length==0){w.setStartBefore(w.startContainer).collapse(true)}if(m=w.getClosedNode()){e.undoManger&&e.undoManger.save();w.setStartBefore(m);domUtils.remove(m);w.setCursor();e.undoManger&&e.undoManger.save();domUtils.preventDefault(z);return}if(!browser.ie){m=domUtils.findParentByTagName(w.startContainer,"table",true);l=domUtils.findParentByTagName(w.endContainer,"table",true);if(m&&!l||!m&&l||m!==l){z.preventDefault();return}}if(e.undoManger){if(!w.collapsed){e.undoManger.save();a=1}}}if(r==9){w=e.selection.getRange();e.undoManger&&e.undoManger.save();for(var G=0,x="",A=e.options.tabSize||4,E=e.options.tabNode||"&nbsp;";G<A;G++){x+=E}var F=e.document.createElement("span");F.innerHTML=x;if(w.collapsed){var u=domUtils.findParentByTagName(w.startContainer,"li",true);if(u&&domUtils.isStartInblock(w)){h=w.createBookmark();var D=u.parentNode,H=e.document.createElement(D.tagName);var n=utils.indexOf(g[H.tagName],domUtils.getComputedStyle(D,"list-style-type"));n=n+1==g[H.tagName].length?0:n+1;domUtils.setStyle(H,"list-style-type",g[H.tagName][n]);D.insertBefore(H,u);H.appendChild(u);var j=H.previousSibling;if(j&&f(j,H)){domUtils.moveChild(H,j);domUtils.remove(H);H=j}var o=H.nextSibling;if(o&&f(o,H)){domUtils.moveChild(o,H);domUtils.remove(o)}w.moveToBookmark(h).select()}else{w.insertNode(F.cloneNode(true).firstChild).setCursor(true)}}else{m=domUtils.findParentByTagName(w.startContainer,"table",true);l=domUtils.findParentByTagName(w.endContainer,"table",true);if(m||l){z.preventDefault?z.preventDefault():(z.returnValue=false);return}m=domUtils.findParentByTagName(w.startContainer,["ol","ul"],true);l=domUtils.findParentByTagName(w.endContainer,["ol","ul"],true);if(m&&l&&m===l){var h=w.createBookmark();m=domUtils.findParentByTagName(w.startContainer,"li",true);l=domUtils.findParentByTagName(w.endContainer,"li",true);if(m===m.parentNode.firstChild){var v=e.document.createElement(m.parentNode.tagName);m.parentNode.parentNode.insertBefore(v,m.parentNode);v.appendChild(m.parentNode)}else{D=m.parentNode;H=e.document.createElement(D.tagName);n=utils.indexOf(g[H.tagName],domUtils.getComputedStyle(D,"list-style-type"));n=n+1==g[H.tagName].length?0:n+1;domUtils.setStyle(H,"list-style-type",g[H.tagName][n]);m.parentNode.insertBefore(H,m);var t;while(m!==l){t=m.nextSibling;H.appendChild(m);m=t}H.appendChild(l)}w.moveToBookmark(h).select()}else{if(m||l){z.preventDefault?z.preventDefault():(z.returnValue=false);return}m=domUtils.findParent(w.startContainer,y);l=domUtils.findParent(w.endContainer,y);if(m&&l&&m===l){w.deleteContents();w.insertNode(F.cloneNode(true).firstChild).setCursor(true)}else{var q=w.createBookmark(),y=function(i){return domUtils.isBlockElm(i)};w.enlarge(true);var C=w.createBookmark(),B=domUtils.getNextDomNode(C.start,false,y);while(B&&!(domUtils.getPosition(B,C.end)&domUtils.POSITION_FOLLOWING)){B.insertBefore(F.cloneNode(true).firstChild,B.firstChild);B=domUtils.getNextDomNode(B,false,y)}w.moveToBookmark(C).moveToBookmark(q).select()}}}e.undoManger&&e.undoManger.save();z.preventDefault?z.preventDefault():(z.returnValue=false)}if(browser.gecko&&r==46){w=e.selection.getRange();if(w.collapsed){m=w.startContainer;if(domUtils.isEmptyBlock(m)){var s=m.parentNode;while(domUtils.getChildCount(s)==1&&!domUtils.isBody(s)){m=s;s=s.parentNode}if(m===s.lastChild){z.preventDefault()}return}}}});e.addListener("keyup",function(s,v){var z=v.keyCode||v.which;if(!browser.gecko&&!d[z]&&!v.ctrlKey&&!v.metaKey&&!v.shiftKey&&!v.altKey){q=e.selection.getRange();if(q.collapsed){var j=q.startContainer,k=0;while(!domUtils.isBlockElm(j)){if(j.nodeType==1&&utils.indexOf(["FONT","B","I"],j.tagName)!=-1){var l=e.document.createElement(b[j.tagName]);if(j.tagName=="FONT"){l.style.cssText=(j.getAttribute("size")?"font-size:"+(c[j.getAttribute("size")]||12)+"px":"")+";"+(j.getAttribute("color")?"color:"+j.getAttribute("color"):"")+";"+(j.getAttribute("face")?"font-family:"+j.getAttribute("face"):"")+";"+j.style.cssText}while(j.firstChild){l.appendChild(j.firstChild)}j.parentNode.insertBefore(l,j);domUtils.remove(j);if(!k){q.setEnd(l,l.childNodes.length).collapse(true)}j=l;k=1}j=j.parentNode}k&&q.select()}}if(z==8){if(browser.gecko){for(var n=0,w,y=domUtils.getElementsByTagName(this.body,"li");w=y[n++];){if(domUtils.isEmptyNode(w)&&!w.previousSibling){var x=w.parentNode;domUtils.remove(w);if(domUtils.isEmptyNode(x)){domUtils.remove(x)}}}}var q,j,u,m=this.currentSelectedArr;if(m&&m.length>0){for(var n=0,h;h=m[n++];){h.innerHTML=browser.ie?(browser.version<9?"&#65279":""):"<br/>"}q=new dom.Range(this.document);q.setStart(m[0],0).setCursor();if(a){e.undoManger.save();a=0}if(browser.webkit){v.preventDefault()}return}q=e.selection.getRange();j=q.startContainer;if(domUtils.isWhitespace(j)){j=j.parentNode}var r=0;while(j.nodeType==1&&domUtils.isEmptyNode(j)&&dtd.$removeEmpty[j.tagName]){r=1;u=j.parentNode;domUtils.remove(j);j=u}if(r&&j.nodeType==1&&domUtils.isEmptyNode(j)){if(browser.ie){var t=q.document.createElement("span");j.appendChild(t);q.setStart(j,0).setCursor();w=domUtils.findParentByTagName(j,"li",true);if(w){var o=w.nextSibling;while(o){if(domUtils.isEmptyBlock(o)){w=o;o=o.nextSibling;domUtils.remove(w);continue}break}}}else{j.innerHTML="<br/>";q.setStart(j,0).setCursor(false,true)}setTimeout(function(){if(browser.ie){domUtils.remove(t)}if(a){e.undoManger.save();a=0}},0)}else{if(a){e.undoManger.save();a=0}}}})};UE.plugins.serialize=function(){var a=browser.ie,i=browser.version;function h(q){return/pt/.test(q)?q.replace(/([\d.]+)pt/g,function(r){return Math.round(parseFloat(r)*96/72)+"px"}):q}var k=this,b=k.options.autoClearEmptyNode,e=dtd.$empty,n=function(){var s=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,q=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,t={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},w={script:1,style:1},r={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},th:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1,colgroup:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup",colgroup:1}};var u={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function v(A,E){var B,C=0,y,J;s.exec("");while((B=s.exec(A))){var H=B.index;if(H>C){var K=A.slice(C,H);if(J){J.push(K)}else{E.onText(K)}}C=s.lastIndex;if((y=B[1])){y=y.toLowerCase();if(J&&y==J._tag_name){E.onCDATA(J.join(""));J=null}if(!J){E.onTagClose(y);continue}}if(J){J.push(B[0]);continue}if((y=B[3])){if(/="/.test(y)){continue}y=y.toLowerCase();var I=B[4],x,z={},G=I&&I.slice(-1)=="/";if(I){q.exec("");while((x=q.exec(I))){var F=x[1].toLowerCase(),D=x[2]||x[3]||x[4]||"";if(!D&&t[F]){D=F}if(F=="style"){if(a&&i<=6){D=D.replace(/(?!;)\s*([\w-]+):/g,function(L,M){return M.toLowerCase()+":"})}}if(D){z[F]=D.replace(/:\s*/g,":")}}}E.onTagOpen(y,z,G);if(!J&&w[y]){J=[];J._tag_name=y}continue}if((y=B[2])){E.onComment(y)}}if(A.length>C){E.onText(A.slice(C,A.length))}}return function(A,B){var y={type:"fragment",parent:null,children:[]};var z=y;function D(E){E.parent=z;z.children.push(E)}function C(F,E){var G=F;if(r[G.tag]){while(r[z.tag]&&r[z.tag][G.tag]){z=z.parent}if(z.tag==G.tag){z=z.parent}while(r[G.tag]){if(r[G.tag][z.tag]){break}G=G.parent={type:"element",tag:r[G.tag]["$"],attributes:{},children:[G]}}}if(B){while(dtd[G.tag]&&!(z.tag=="span"?utils.extend(dtd.strong,{a:1,A:1}):(dtd[z.tag]||dtd.div))[G.tag]){if(x(z)){continue}if(!z.parent){break}z=z.parent}}G.parent=z;z.children.push(G);if(E){z=F}if(F.attributes.style){F.attributes.style=F.attributes.style.toLowerCase()}return F}function x(E){var F;if(!E.children.length&&(F=u[E.tag])){C({type:"element",tag:F,attributes:{},children:[]},true);return true}return false}v(A,{onText:function(E){while(!(dtd[z.tag]||dtd.div)["#"]){if(x(z)){continue}z=z.parent}D({type:"text",data:E})},onComment:function(E){D({type:"comment",data:E})},onCDATA:function(E){while(!(dtd[z.tag]||dtd.div)["#"]){if(x(z)){continue}z=z.parent}D({type:"cdata",data:E})},onTagOpen:function(E,G,F){F=F||e[E];C({type:"element",tag:E,attributes:G,closed:F,children:[]},!F)},onTagClose:function(E){var F=z;while(F&&E!=F.tag){F=F.parent}if(F){for(var G=z;G!==F.parent;G=G.parent){x(G)}z=F.parent}else{if(!(dtd.$removeEmpty[E]||dtd.$removeEmptyBlock[E]||E=="embed")){F={type:"element",tag:E,attributes:{},children:[]};C(F,true);x(F);z=F.parent}}}});while(z!==y){x(z);z=z.parent}return y}}();var l=function(){var r={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function q(s){return r[s]}return function(s){s=s+"";return s?s.replace(/[<>"']/g,q):""}}();var f=function(){function r(z,y){var x=z.children;var A=[];for(var w=0,v;v=x[w];w++){A.push(f(v,y))}return A.join("")}function s(w){var y=[];for(var v in w){var x=w[v];if(v=="style"){x=h(x);if(/rgba?\s*\([^)]*\)/.test(x)){x=x.replace(/rgba?\s*\(([^)]*)\)/g,function(z){return utils.fixColor("color",z)})}w[v]=utils.optCss(x.replace(/windowtext/g,"#000")).replace(/white-space[^;]+;/g,"")}y.push(v+'="'+l(w[v])+'"')}return y.join(" ")}function q(w,v){return v?w.data.replace(/&nbsp;/g," "):l(w.data).replace(/ /g,"&nbsp;")}var u={div:"p",li:"p",tr:"p",br:"br",p:"p"};function t(z,y){if(z.type=="element"&&!z.children.length&&(dtd.$removeEmpty[z.tag])&&z.tag!="a"&&utils.isEmptyObject(z.attributes)&&b){return x}var v=z.tag;if(y&&v=="td"){if(!x){x=""}x+=r(z,y)+"&nbsp;&nbsp;&nbsp;"}else{var w=s(z.attributes);var x="<"+(y&&u[v]?u[v]:v)+(w?" "+w:"")+(e[v]?" />":">");if(!e[v]){if(v=="p"&&!z.children.length){x+=browser.ie?"&nbsp;":"<br/>"}x+=r(z,y);x+="</"+(y&&u[v]?u[v]:v)+">"}}return x}return function(w,v){if(w.type=="fragment"){return r(w,v)}else{if(w.type=="element"){return t(w,v)}else{if(w.type=="text"||w.type=="cdata"){return q(w,dtd.$notTransContent[w.parent.tag])}else{if(w.type=="comment"){return"<!--"+w.data+"-->"}}}}return""}}();var o={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function j(t,u){var w=[0,10,12,16,18,24,32,48],v,y=utils.indexOf;switch(t.tag){case"script":t.tag="div";t.attributes._ue_org_tagName="script";t.attributes._ue_div_script=1;t.attributes._ue_script_data=t.children[0]?encodeURIComponent(t.children[0].data):"";t.attributes._ue_custom_node_=1;t.children=[];break;case"style":t.tag="div";t.attributes._ue_div_style=1;t.attributes._ue_org_tagName="style";t.attributes._ue_style_data=t.children[0]?encodeURIComponent(t.children[0].data):"";t.attributes._ue_custom_node_=1;t.children=[];break;case"img":if(t.attributes.src&&/^data:/.test(t.attributes.src)){return{type:"fragment",children:[]}}if(t.attributes.src&&/^(?:file)/.test(t.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(t.attributes.src)){return{type:"fragment",children:[]}}t.attributes.word_img=t.attributes.src;t.attributes.src=k.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";var x=parseInt(t.attributes.width)<128||parseInt(t.attributes.height)<43;t.attributes.style="background:url("+(x?k.options.themePath+k.options.theme+"/images/word.gif":k.options.langPath+k.options.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd";u&&(u.flag=1)}if(browser.ie&&browser.version<7){t.attributes.orgSrc=t.attributes.src}t.attributes.data_ue_src=t.attributes.data_ue_src||t.attributes.src;break;case"li":var r=t.children[0];if(!r||r.type!="element"||r.tag!="p"&&dtd.p[r.tag]){var s={type:"element",tag:"p",attributes:{},parent:t};s.children=r?t.children:[browser.ie?{type:"text",data:domUtils.fillChar,parent:s}:{type:"element",tag:"br",attributes:{},closed:true,children:[],parent:s}];t.children=[s]}break;case"table":case"td":d(t);break;case"a":if(t.attributes.anchorname){t.tag="img";t.attributes={"class":"anchorclass",anchorname:t.attributes.name};t.closed=1}t.attributes.href&&(t.attributes.data_ue_src=t.attributes.href);break;case"b":t.tag=t.name="strong";break;case"i":t.tag=t.name="em";break;case"u":t.tag=t.name="span";t.attributes.style=(t.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":t.tag=t.name="span";t.attributes.style=(t.attributes.style||"")+";text-decoration:line-through;";if(t.children.length==1){r=t.children[0];if(r.tag==t.tag){t.attributes.style+=";"+r.attributes.style;t.children=r.children}}break;case"span":var q=t.attributes.style;if(q){if(!t.attributes.style||browser.webkit&&q=="white-space:nowrap;"){delete t.attributes.style}}if(browser.gecko&&browser.version<=10902&&t.parent){var z=t.parent;if(z.tag=="span"&&z.attributes&&z.attributes.style){t.attributes.style=z.attributes.style+";"+t.attributes.style}}if(utils.isEmptyObject(t.attributes)&&b){t.type="fragment"}break;case"font":t.tag=t.name="span";v=t.attributes;t.attributes={style:(v.size?"font-size:"+(w[v.size]||12)+"px":"")+";"+(v.color?"color:"+v.color:"")+";"+(v.face?"font-family:"+v.face:"")+";"+(v.style||"")};while(t.parent.tag==t.tag&&t.parent.children.length==1){t.attributes.style&&(t.parent.attributes.style?(t.parent.attributes.style+=";"+t.attributes.style):(t.parent.attributes.style=t.attributes.style));t.parent.children=t.children;t=t.parent}break;case"p":if(t.attributes.align){t.attributes.style=(t.attributes.style||"")+";text-align:"+t.attributes.align+";";delete t.attributes.align}}return t}function d(r){if(a&&r.attributes.style){var q=r.attributes.style;r.attributes.style=q.replace(/;\s*/g,";");r.attributes.style=r.attributes.style.replace(/^\s*|\s*$/,"")}}function m(q){switch(q.tag){case"div":if(q.attributes._ue_div_script){q.tag="script";q.children=[{type:"cdata",data:q.attributes._ue_script_data?decodeURIComponent(q.attributes._ue_script_data):"",parent:q}];delete q.attributes._ue_div_script;delete q.attributes._ue_script_data;delete q.attributes._ue_custom_node_;delete q.attributes._ue_org_tagName}if(q.attributes._ue_div_style){q.tag="style";q.children=[{type:"cdata",data:q.attributes._ue_style_data?decodeURIComponent(q.attributes._ue_style_data):"",parent:q}];delete q.attributes._ue_div_style;delete q.attributes._ue_style_data;delete q.attributes._ue_custom_node_;delete q.attributes._ue_org_tagName}break;case"table":!q.attributes.style&&delete q.attributes.style;if(a&&q.attributes.style){d(q)}if(q.attributes["class"]=="noBorderTable"){delete q.attributes["class"]}break;case"td":case"th":if(/display\s*:\s*none/i.test(q.attributes.style)){return{type:"fragment",children:[]}}if(a&&!q.children.length){var r={type:"text",data:domUtils.fillChar,parent:q};q.children[0]=r}if(a&&q.attributes.style){d(q)}if(q.attributes["class"]=="selectTdClass"){delete q.attributes["class"]}break;case"img":if(q.attributes.anchorname){q.tag="a";q.attributes={name:q.attributes.anchorname,anchorname:1};q.closed=null}else{if(q.attributes.data_ue_src){q.attributes.src=q.attributes.data_ue_src;delete q.attributes.data_ue_src}}break;case"a":if(q.attributes.data_ue_src){q.attributes.href=q.attributes.data_ue_src;delete q.attributes.data_ue_src}}return q}function g(w,v,q){if(!w.children||!w.children.length){return w}var u=w.children;for(var t=0;t<u.length;t++){var s=v(u[t],q);if(s.type=="fragment"){var r=[t,1];r.push.apply(r,s.children);u.splice.apply(u,r);if(!u.length){w={type:"fragment",children:[]}}t--}else{u[t]=s}}return w}function c(q){this.rules=q}c.prototype={rules:null,filter:function(s,v,u){v=v||this.rules;var r=v&&v.whiteList;var q=v&&v.blackList;function t(A,z){A.name=A.type=="element"?A.tag:o[A.type];if(z==null){return g(A,t,A)}if(q&&(q[A.name]||(A.attributes&&A.attributes._ue_org_tagName&&q[A.attributes._ue_org_tagName]))){u&&(u.flag=1);return{type:"fragment",children:[]}}if(r){if(A.type=="element"){if(z.type=="fragment"?r[A.name]:r[A.name]&&r[z.name][A.name]){var y;if((y=r[A.name].$)){var B=A.attributes;var x={};for(var w in y){if(B[w]){x[w]=B[w]}}A.attributes=x}}else{u&&(u.flag=1);A.type="fragment";A.name=z.name}}else{}}if(q||r){g(A,t,A)}return A}return t(s,null)},transformInput:function(r,q){function s(t){t=j(t,q);t=g(t,s,t);if(k.options.pageBreakTag&&t.type=="text"&&t.data.replace(/\s/g,"")==k.options.pageBreakTag){t.type="element";t.name=t.tag="hr";delete t.data;t.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"};t.children=[]}if(t.type=="text"&&!dtd.$notTransContent[t.parent.tag]){t.data=t.data.replace(/[\r\t\n]*/g,"")}return t}return s(r)},transformOutput:function(q){function r(s){if(s.tag=="hr"&&s.attributes["class"]=="pagebreak"){delete s.tag;s.type="text";s.data=k.options.pageBreakTag;delete s.children}s=m(s);s=g(s,r,s);return s}return r(q)},toHTML:f,parseHTML:n,word:UE.filterWord};k.serialize=new c(k.options.serialize||{});UE.serialize=new c({})};(function(){function a(f){var d=this.document;if(d.getElementById("baidu_pastebin")){return}var c=this.selection.getRange(),b=c.createBookmark(),e=d.createElement("div");e.id="baidu_pastebin";browser.webkit&&e.appendChild(d.createTextNode(domUtils.fillChar+domUtils.fillChar));d.body.appendChild(e);b.start.style.display="";e.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(b.start).y+"px";c.selectNodeContents(e).select(true);setTimeout(function(){if(browser.webkit){for(var g=0,h=d.querySelectorAll("#baidu_pastebin"),k;k=h[g++];){if(domUtils.isEmptyNode(k)){domUtils.remove(k)}else{e=k;break}}}try{e.parentNode.removeChild(e)}catch(j){}c.moveToBookmark(b).select(true);f(e)},0)}UE.plugins.paste=function(){var f=this;var e={flag:""};var d=f.options.pasteplain===true;var b={flag:""};f.commands.pasteplain={queryCommandState:function(){return d},execCommand:function(){d=!d|0},notNeedUndo:1};function c(r){var q;if(r.firstChild){var u=domUtils.getElementsByTagName(r,"span");for(var x=0,k;k=u[x++];){if(k.id=="_baidu_cut_start"||k.id=="_baidu_cut_end"){domUtils.remove(k)}}if(browser.webkit){var s=r.querySelectorAll("div br");for(var x=0,h;h=s[x++];){var o=h.parentNode;if(o.tagName=="DIV"&&o.childNodes.length==1){o.innerHTML="<p><br/></p>";domUtils.remove(o)}}var w=r.querySelectorAll("#baidu_pastebin");for(var x=0,y;y=w[x++];){var B=f.document.createElement("p");y.parentNode.insertBefore(B,y);while(y.firstChild){B.appendChild(y.firstChild)}domUtils.remove(y)}var g=r.querySelectorAll("meta");for(var x=0,n;n=g[x++];){domUtils.remove(n)}var s=r.querySelectorAll("br");for(x=0;n=s[x++];){if(/^apple-/.test(n)){domUtils.remove(n)}}}if(browser.gecko){var t=r.querySelectorAll("[_moz_dirty]");for(x=0;n=t[x++];){n.removeAttribute("_moz_dirty")}}if(!browser.ie){var m=r.querySelectorAll("span.Apple-style-span");for(var x=0,n;n=m[x++];){domUtils.remove(n,true)}}q=r.innerHTML;var z=f.serialize;if(z){try{var v=z.transformInput(z.parseHTML(z.word(q)),e);v=z.filter(v,d?{whiteList:{p:{br:1,BR:1,$:{}},br:{"$":{}},div:{br:1,BR:1,"$":{}},li:{"$":{}},tr:{td:1,"$":{}},td:{"$":{}}},blackList:{style:1,script:1,object:1}}:null,!d?b:null);if(browser.webkit){var j=v.children.length,l;while((l=v.children[j-1])&&l.tag=="br"){v.children.splice(j-1,1);j=v.children.length}}q=z.toHTML(v,d)}catch(A){}}q={html:q};f.fireEvent("beforepaste",q);f.execCommand("insertHtml",q.html,true);f.fireEvent("afterpaste")}}f.addListener("ready",function(){domUtils.on(f.body,"cut",function(){var g=f.selection.getRange();if(!g.collapsed&&f.undoManger){f.undoManger.save()}});domUtils.on(f.body,browser.ie||browser.opera?"keydown":"paste",function(g){if((browser.ie||browser.opera)&&(!g.ctrlKey||g.keyCode!="86")){return}a.call(f,function(h){c(h)})})})}})();UE.plugins.fiximgclick=function(){var a=this;if(browser.webkit){a.addListener("click",function(c,d){if(d.target.tagName=="IMG"){var b=new dom.Range(a.document);b.selectNode(d.target).select()}})}};UE.plugins.enterkey=function(){var b,c=this,a=c.options.enterTag;c.addListener("keyup",function(l,m){var n=m.keyCode||m.which;if(n==13){var k=c.selection.getRange(),g=k.startContainer,d;if(!browser.ie){if(/h\d/i.test(b)){if(browser.gecko){var j=domUtils.findParentByTagName(g,["h1","h2","h3","h4","h5","h6","blockquote"],true);if(!j){c.document.execCommand("formatBlock",false,"<p>");d=1}}else{if(g.nodeType==1){var i=c.document.createTextNode(""),e;k.insertNode(i);e=domUtils.findParentByTagName(i,"div",true);if(e){var f=c.document.createElement("p");while(e.firstChild){f.appendChild(e.firstChild)}e.parentNode.insertBefore(f,e);domUtils.remove(e);k.setStartBefore(i).setCursor();d=1}domUtils.remove(i)}}if(c.undoManger&&d){c.undoManger.save()}}browser.opera&&k.select()}setTimeout(function(){c.selection.getRange().scrollToView(c.autoHeightEnabled,c.autoHeightEnabled?domUtils.getXY(c.iframe).y:0)},50)}});c.addListener("keydown",function(i,k){var m=k.keyCode||k.which;if(m==13){if(c.undoManger){c.undoManger.save()}b="";var f=c.selection.getRange();if(!f.collapsed){var d=f.startContainer,e=f.endContainer,g=domUtils.findParentByTagName(d,"td",true),h=domUtils.findParentByTagName(e,"td",true);if(g&&h&&g!==h||!g&&h||g&&!h){k.preventDefault?k.preventDefault():(k.returnValue=false);return}}c.currentSelectedArr&&domUtils.clearSelectedArr(c.currentSelectedArr);if(a=="p"){if(!browser.ie){d=domUtils.findParentByTagName(f.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote"],true);if(!d&&!browser.opera){c.document.execCommand("formatBlock",false,"<p>");if(browser.gecko){f=c.selection.getRange();d=domUtils.findParentByTagName(f.startContainer,"p",true);d&&domUtils.removeDirtyAttr(d)}}else{b=d.tagName;d.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(d)}}}else{k.preventDefault?k.preventDefault():(k.returnValue=false);if(!f.collapsed){f.deleteContents();d=f.startContainer;if(d.nodeType==1&&(d=d.childNodes[f.startOffset])){while(d.nodeType==1){if(dtd.$empty[d.tagName]){f.setStartBefore(d).setCursor();if(c.undoManger){c.undoManger.save()}return false}if(!d.firstChild){var l=f.document.createElement("br");d.appendChild(l);f.setStart(d,0).setCursor();if(c.undoManger){c.undoManger.save()}return false}d=d.firstChild}if(d===f.startContainer.childNodes[f.startOffset]){l=f.document.createElement("br");f.insertNode(l).setCursor()}else{f.setStart(d,0).setCursor()}}else{l=f.document.createElement("br");f.insertNode(l).setStartAfter(l).setCursor()}}else{l=f.document.createElement("br");f.insertNode(l);var j=l.parentNode;if(j.lastChild===l){l.parentNode.insertBefore(l.cloneNode(true),l);f.setStartBefore(l)}else{f.setStartAfter(l)}f.setCursor()}}}})};UE.commands["delete"]={execCommand:function(){var f=this.selection.getRange(),d=0,j=0,h=this;if(this.selectAll){h.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>";f.setStart(h.body.firstChild,0).setCursor(false,true);h.selectAll=false;return}if(h.currentSelectedArr&&h.currentSelectedArr.length>0){for(var e=0,l;l=h.currentSelectedArr[e++];){if(l.style.display!="none"){l.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}}f.setStart(h.currentSelectedArr[0],0).setCursor();return}if(f.collapsed){return}f.txtToElmBoundary();while(!f.startOffset&&!domUtils.isBody(f.startContainer)&&!dtd.$tableContent[f.startContainer.tagName]){d=1;f.setStartBefore(f.startContainer)}while(f.endContainer.nodeType!=3&&!domUtils.isBody(f.endContainer)&&!dtd.$tableContent[f.endContainer.tagName]){var b,k=f.endContainer,g=f.endOffset;b=k.childNodes[g];if(!b||domUtils.isBr(b)&&k.lastChild===b){f.setEndAfter(k);continue}break}if(d){var a=h.document.createElement("span");a.innerHTML="start";a.id="_baidu_cut_start";f.insertNode(a).setStartBefore(a)}if(j){var c=h.document.createElement("span");c.innerHTML="end";c.id="_baidu_cut_end";f.cloneRange().collapse(false).insertNode(c);f.setEndAfter(c)}f.deleteContents();if(domUtils.isBody(f.startContainer)&&domUtils.isEmptyBlock(h.body)){h.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";f.setStart(h.body.firstChild,0).collapse(true)}else{if(!browser.ie&&domUtils.isEmptyBlock(f.startContainer)){f.startContainer.innerHTML="<br/>"}}f.select(true)},queryCommandState:function(){if(this.currentSelectedArr&&this.currentSelectedArr.length>0){return 0}return this.highlight||this.selection.getRange().collapsed?-1:0}};UE.commands.inserthtml={execCommand:function(a,g,t){var u=this,h,j,o=u.currentSelectedArr;h=u.selection.getRange();j=h.document.createElement("div");j.style.display="inline";var m=u.serialize;if(!t&&m){var n=m.parseHTML(g);n=m.transformInput(n);n=m.filter(n);g=m.toHTML(n)}j.innerHTML=utils.trim(g);try{u.adjustTable&&u.adjustTable(j)}catch(r){}if(o&&o.length){for(var q=0,c;c=o[q++];){c.className=""}o[0].innerHTML="";h.setStart(o[0],0).collapse(true);u.currentSelectedArr=[]}if(!h.collapsed){h.deleteContents();if(h.startContainer.nodeType==1){var d=h.startContainer.childNodes[h.startOffset],k;if(d&&domUtils.isBlockElm(d)&&(k=d.previousSibling)&&domUtils.isBlockElm(k)){h.setEnd(k,k.childNodes.length).collapse();while(d.firstChild){k.appendChild(d.firstChild)}domUtils.remove(d)}}}var d,f,k,s,b=0;while(d=j.firstChild){h.insertNode(d);if(!b&&d.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(d)){f=domUtils.findParent(d,function(e){return domUtils.isBlockElm(e)});if(f&&f.tagName.toLowerCase()!="body"&&!(dtd[f.tagName][d.nodeName]&&d.parentNode===f)){if(!dtd[f.tagName][d.nodeName]){k=f}else{s=d.parentNode;while(s!==f){k=s;s=s.parentNode}}domUtils.breakParent(d,k||s);var k=d.previousSibling;domUtils.trimWhiteTextNode(k);if(!k.childNodes.length){domUtils.remove(k)}if(!browser.ie&&(l=d.nextSibling)&&domUtils.isBlockElm(l)&&l.lastChild&&!domUtils.isBr(l.lastChild)){l.appendChild(u.document.createElement("br"))}b=1}}var l=d.nextSibling;if(!j.firstChild&&l&&domUtils.isBlockElm(l)){h.setStart(l,0).collapse(true);break}h.setEndAfter(d).collapse()}d=h.startContainer;if(domUtils.isBlockElm(d)&&domUtils.isEmptyNode(d)){d.innerHTML=browser.ie?"":"<br/>"}h.select(true);setTimeout(function(){h=u.selection.getRange();h.scrollToView(u.autoHeightEnabled,u.autoHeightEnabled?domUtils.getXY(u.iframe).y:0)},200)}};UE.plugins.shortcutkeys=function(){var b=this,a={"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll","ctrl+13":"autosubmit"};b.addListener("keydown",function(d,h){var g=h.keyCode||h.which,f;for(var c in a){if(/^(ctrl)(\+shift)?\+(\d+)$/.test(c.toLowerCase())||/^(\d+)$/.test(c)){if(((RegExp.$1=="ctrl"?(h.ctrlKey||h.metaKey||browser.opera&&g==17):0)&&(RegExp.$2!=""?h[RegExp.$2.slice(1)+"Key"]:1)&&g==RegExp.$3)||g==RegExp.$1){f=a[c].split(":");b.execCommand(f[0],f[1]);domUtils.preventDefault(h)}}}})};